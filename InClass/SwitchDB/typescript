Script started on Thu 29 Sep 2016 09:18:23 AM PDT
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ lswget http://web.engr.oregonstate.edu/~traylor/ece473/inclass_exercises/io_portss/Makefile.switch_example
--2016-09-29 09:18:28--  http://web.engr.oregonstate.edu/~traylor/ece473/inclass_exercises/io_ports/Makefile.switch_example
Resolving web.engr.oregonstate.edu (web.engr.oregonstate.edu)... 128.193.40.12
Connecting to web.engr.oregonstate.edu (web.engr.oregonstate.edu)|128.193.40.12|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2838 (2.8K) [text/plain]
Saving to: â€˜Makefile.switch_exampleâ€™

Makefile.switch_example               0%[                                                                   ]       0  --.-KB/s               Makefile.switch_example             100%[==================================================================>]   2.77K  --.-KB/s    in 0s      

2016-09-29 09:18:28 (453 MB/s) - â€˜Makefile.switch_exampleâ€™ saved [2838/2838]

]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ wget http://web.engr.oregonstate.edu/~traylor/ece473/inclass_exercises/io_portss/Makefile.switch_example[A]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ ls[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cwget http://web.engr.oregonstate.edu/~traylor/ece473/inclass_exercises/io_portss/Makefile.switch_example[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Kvim s[K[K[K[K[Kls
lcd_functions.c  lcd_functions.h  Makefile.switch_example  script  switch_example_skel.c  typescript
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ make
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL   -c -o switch_example.o switch_example.c
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL   -c -o lcd_functions.o lcd_functions.c
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL -Wl,-Map,switch_example.map -o switch_example.elf switch_example.o lcd_functions.o 
avr-objdump -h -S switch_example.elf > switch_example.lst
avr-objcopy -j .text -j .data -O ihex switch_example.elf switch_example.hex
avr-objcopy -j .text -j .data -O binary switch_example.elf switch_example.bin
avr-objcopy -j .text -j .data -O srec switch_example.elf switch_example.srec
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O ihex switch_example.elf switch_example_eeprom.hex \
|| { echo empty switch_example_eeprom.hex not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O binary switch_example.elf switch_example_eeprom.bin \
|| { echo empty switch_example_eeprom.bin not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O srec switch_example.elf switch_example_eeprom.srec \
|| { echo empty switch_example_eeprom.srec not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ make l[Kclear
make: *** No rule to make target 'clear'.  Stop.
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ make clean
rm -rf switch_example.o switch_example.elf switch_example.lst switch_example.map switch_example.srec switch_example*.bin
rm -rf switch_example_eeprom.srec switch_example_eeprom*.bin switch_example_eeprom.hex switch_example.hex 
rm -rf switch_example.d
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ make cleanr[K
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL   -c -o switch_example.o switch_example.c
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL -Wl,-Map,switch_example.map -o switch_example.elf switch_example.o lcd_functions.o 
avr-objdump -h -S switch_example.elf > switch_example.lst
avr-objcopy -j .text -j .data -O ihex switch_example.elf switch_example.hex
avr-objcopy -j .text -j .data -O binary switch_example.elf switch_example.bin
avr-objcopy -j .text -j .data -O srec switch_example.elf switch_example.srec
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O ihex switch_example.elf switch_example_eeprom.hex \
|| { echo empty switch_example_eeprom.hex not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O binary switch_example.elf switch_example_eeprom.bin \
|| { echo empty switch_example_eeprom.bin not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O srec switch_example.elf switch_example_eeprom.srec \
|| { echo empty switch_example_eeprom.srec not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ make clean
rm -rf switch_example.o switch_example.elf switch_example.lst switch_example.map switch_example.srec switch_example*.bin
rm -rf switch_example_eeprom.srec switch_example_eeprom*.bin switch_example_eeprom.hex switch_example.hex 
rm -rf switch_example.d
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ vim 
lcd_functions.c   lcd_functions.h   Makefile          script            switch_example.c  typescript        
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ vim 
lcd_functions.c   lcd_functions.h   Makefile          script            switch_example.c  typescript        
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ vim 
lcd_functions.c   lcd_functions.h   Makefile          script            switch_example.c  typescript        
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ vim 
lcd_functions.c   lcd_functions.h   Makefile          script            switch_example.c  typescript        
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ vim 
lcd_functions.c   lcd_functions.h   Makefile          script            switch_example.c  typescript        
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ vim 
lcd_functions.c   lcd_functions.h   Makefile          script            switch_example.c  typescript        
]0;johnm@johnm-HP-ENVY-15-Notebook-PC: /git/ECE473/InClass/SwitchDB[01;32mjohnm@johnm-HP-ENVY-15-Notebook-PC[00m:[01;34m/git/ECE473/InClass/SwitchDB[00m$ vim le[Kcd_functions.c[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Kswitch_example.c 
[?1049h[?1h=[2;1Hâ–½[6n[2;1H  [1;1H]11;?[1;42r[?12;25h[?12l[?25h[27m[23m[m[H[2J[?25l[42;1H"switch_example.c" 90L, 3000C[>c[1;1H[34m//This code shows how debouncing should and should not be done.
//TCNT0 is used with 16mhz clock to vary the sampling period.

//Vary the buttons and see which is worst. They can vary alot.
//Vary the sampling time and note any difference.
//Note the use of #ifdef statements

//R. Traylor 12.16.2013[m

[35m#include [m[31m<avr/io.h>[m
[35m#include [m[31m<avr/interrupt.h>[m
[35m#include [m[31m<util/delay.h>[m
[35m#include [m[31m<string.h>[m
[35m#include [m[31m<stdlib.h>[m
[35m#include [m[31m"lcd_functions.h"[m

[34m//#define DEBOUNCE[m

[32mchar[m lcd_str[[31m16[m];[20C[34m//holds string to send to lcd[m
[32mvolatile[m [32muint16_t[m switch_count = [31m0[m;  [34m//count switch closures[m
[32muint8_t[m i;[27C[34m//just a dumb counter

//******************************************************************************
//                            spi_init                               
//Initalizes the SPI port on the mega128. Does no further device specific inits
//******************************************************************************[m
[32mvoid[m spi_init([32mvoid[m){
    DDRB |=  [31m0x07[m;  [34m//Turn on SS, MOSI, SCLK
[m    [34m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m
    SPCR=([31m1[m<<SPE) | ([31m1[m<<MSTR); [34m//enable SPI, clk low initially, rising edge sample[m
    SPSR=([31m1[m<<SPI2X); [34m//SPI at 2x speed (8 MHz)  [m
}[34m//spi_init[m

ISR(TIMER0_COMP_vect){
[35m#ifdef DEBOUNCE [m
  [32mstatic[m [32muint16_t[m state = [31m0[m; [34m//holds present state[m
  state = (state << [31m1[m) | (! bit_is_clear(PIND, [31m1[m)) | [31m0xE000[m;
  [38;5;130mif[m (state == [31m0xF000[m) {switch_count++;}
[35m#else[m
  [34m//uses 3 state, state machne to make pushbutton code[m
  [32mstatic[m [32menum[m button_state_type{NOTSET, SET, WAIT} button_state;[42;126H1,1[11CTop]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c[1;1H[?12l[?25h[27m[23m[m[H[2J[?25l[1;1H[96m//This code shows how debouncing should and should not be done.
//TCNT0 is used with 16mhz clock to vary the sampling period.

//Vary the buttons and see which is worst. They can vary alot.
//Vary the sampling time and note any difference.
//Note the use of #ifdef statements

//R. Traylor 12.16.2013[m

[38;5;81m#include [m[95m<avr/io.h>[m
[38;5;81m#include [m[95m<avr/interrupt.h>[m
[38;5;81m#include [m[95m<util/delay.h>[m
[38;5;81m#include [m[95m<string.h>[m
[38;5;81m#include [m[95m<stdlib.h>[m
[38;5;81m#include [m[95m"lcd_functions.h"[m

[96m//#define DEBOUNCE[m

[38;5;121mchar[m lcd_str[[95m16[m];[20C[96m//holds string to send to lcd[m
[38;5;121mvolatile[m [38;5;121muint16_t[m switch_count = [95m0[m;  [96m//count switch closures[m
[38;5;121muint8_t[m i;[27C[96m//just a dumb counter

//******************************************************************************
//                            spi_init                               
//Initalizes the SPI port on the mega128. Does no further device specific inits
//******************************************************************************[m
[38;5;121mvoid[m spi_init([38;5;121mvoid[m){
    DDRB |=  [95m0x07[m;  [96m//Turn on SS, MOSI, SCLK
[m    [96m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m
    SPCR=([95m1[m<<SPE) | ([95m1[m<<MSTR); [96m//enable SPI, clk low initially, rising edge sample[m
    SPSR=([95m1[m<<SPI2X); [96m//SPI at 2x speed (8 MHz)  [m
}[96m//spi_init[m

ISR(TIMER0_COMP_vect){
[38;5;81m#ifdef DEBOUNCE [m
  [38;5;121mstatic[m [38;5;121muint16_t[m state = [95m0[m; [96m//holds present state[m
  state = (state << [95m1[m) | (! bit_is_clear(PIND, [95m1[m)) | [95m0xE000[m;
  [93mif[m (state == [95m0xF000[m) {switch_count++;}
[38;5;81m#else[m
  [96m//uses 3 state, state machne to make pushbutton code[m
  [38;5;121mstatic[m [38;5;121menum[m button_state_type{NOTSET, SET, WAIT} button_state;[42;126H1,1[11CTop"switch_example.c" 90L, 3000C[1;1HP+q436f\P+q6b75\P+q6b64\P+q6b72\P+q6b6c\P+q2332\P+q2334\P+q2569\P+q2a37\P+q6b31\[?12l[?25h[?25l[42;126H2[2;1H[?12l[?25h[?25l[42;126H3,0-1[3;1H[?12l[?25h[?25l[42;126H4,1  [4;1H[?12l[?25h[?25l[42;126H5[5;1H[?12l[?25h[?25l[42;126H6[6;1H[?12l[?25h[?25l[42;126H7,0-1[7;1H[?12l[?25h[?25l[42;126H8,1  [8;1H[?12l[?25h[?25l[42;126H9[9;1H[?12l[?25h[?25l[42;126H10,1[10;1H[?12l[?25h[?25l[42;127H1[11;1H[?12l[?25h[?25l[42;127H2[12;1H[?12l[?25h[?25l[42;127H3[13;1H[?12l[?25h[?25l[42;127H4[14;1H[?12l[?25h[?25l[42;127H5[15;1H[?12l[?25h[?25l[42;127H6,0-1[16;1H[?12l[?25h[?25l[42;127H7,1  [17;1H[?12l[?25h[?25l[42;127H8,0-1[18;1H[?12l[?25h[?25l[42;127H9,1  [19;1H[?12l[?25h[?25l[42;126H20[20;1H[?12l[?25h[?25l[42;127H1[21;1H[?12l[?25h[?25l[42;127H2,0-1[22;1H[?12l[?25h[?25l[42;127H3,1  [23;1H[?12l[?25h[?25l[42;127H4[24;1H[?12l[?25h[?25l[42;127H5[25;1H[?12l[?25h[?25l[42;127H6[26;1H[?12l[?25h[?25l[42;127H7[27;1H[?12l[?25h[?25l[42;127H8[28;1H[?12l[?25h[?25l[42;127H9[29;1H[?12l[?25h[?25l[42;126H30[30;1H[?12l[?25h[?25l[42;127H1[31;1H[?12l[?25h[?25l[27;20H[46m{[32;1H}[m[42;127H2[32;1H[?12l[?25h[?25l[27;20H{[32;1H}[42;127H3,0-1[33;1H[?12l[?25h[?25l[42;127H4,1  [34;1H[?12l[?25h[?25l[42;127H5[35;1H[?12l[?25h[?25l[42;127H6[36;1H[?12l[?25h[?25l[42;127H7[37;1H[?12l[?25h[?25l[42;127H8[38;1H[?12l[?25h[?25l[42;127H9[39;1H[?12l[?25h[?25l[42;126H40[40;1H[?12l[?25h[?25l[42;127H1[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mswitch[m(button_state){[42;1H[K[42;126H42,1[11C2%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,1[11C4%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,1[11C6%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=SET;[42;126H[K[42;126H45,1[11C8%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H} [93mbreak[m;[42;126H[K[42;126H46,1[10C10%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(SET):[42;126H[K[42;126H47,1[10C12%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hswitch_count++;[42;126H[K[42;126H48,1[10C14%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,1[10C16%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,1[10C18%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(WAIT):[42;126H[K[42;126H51,1[10C20%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[42;126H[K[42;126H52,1[10C22%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=NOTSET;[42;126H[K[42;126H53,1[10C24%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H}[42;126H[K[42;126H54,1[10C26%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H55,1[10C28%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mdefault[m: [93mbreak[m;[42;126H[K[42;126H56,1[10C30%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//switch                  [m[42;126H[K[42;126H57,1[10C32%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;81m#endif[m[42;126H[K[42;126H58,1[10C34%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[16;22H[46m{[41;1H}[m [96m//ISR[m[42;126H[K[42;126H59,1[10C36%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[15;22H{[40;1H}[42;126H[K[42;126H60,0-1[8C38%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;121mint[m main([38;5;121mvoid[m){[42;126H[K[42;126H61,1[10C40%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hspi_init();      [96m//initalize SPI [m[42;126H[K[42;126H62,1[10C42%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hlcd_init();      [96m//initalize LCD [m[42;126H[K[42;126H63,1[10C44%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hclear_display(); [96m//manually clear LCD display [m[42;126H[K[42;126H64,1[10C46%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hcursor_off();    [96m//keep LCD cursor off[m[42;126H[K[42;126H65,1[10C48%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H66,1[10C51%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[96m//TCNT0 running in CTC mode[m[42;126H[K[42;126H67,1[10C53%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m[42;126H[K[42;126H68,1[10C55%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m[42;126H[K[42;126H69,1[10C57%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HOCR0  |= [95m0x01[m;[8C[96m//sample really, really fast [m[42;126H[K[42;126H70,1[10C59%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0  |= 0xFF;        //compare register set at 256[m[42;126H[K[42;126H71,1[10C61%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H72,0-1[8C63%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1HTCCR0 |= ([95m1[m<<CS00);[21C[96m//no prescaling[m[42;126H[K[42;126H73,1[10C65%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32[m[42;126H[K[42;126H74,1[10C67%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m[42;126H[K[42;126H75,1[10C69%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS01)|(1<<CS00); //prescale by 1024[m[42;126H[K[42;126H76,1[10C71%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H77,0-1[8C73%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//interrupt period = 62.5ns * (0CR0+1) * prescale[m[42;126H[K[42;126H78,1[10C75%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//0CR0=0xFF, prescale=1024   => period=32.7ms[m[42;126H[K[42;126H79,1[10C77%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m[42;126H[K[42;126H80,1[10C79%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H81,0-1[8C81%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hsei(); [96m//enable global interrupts[m[42;126H[K[42;126H82,1[10C83%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H83,0-1[8C85%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m[42;126H[K[42;126H84,1[10C87%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m[42;126H[K[42;126H85,1[10C89%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hitoa(switch_count, lcd_str, [95m10[m);[42;126H[K[42;126H86,1[10C91%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hstring2lcd(lcd_str);[42;126H[K[42;126H87,1[10C93%[41;1H[?12l[?25h[?25l[42;126H[K[42;1H:[?12l[?25h1[?25l[?12l[?25h[?25l[42;2H[K[42;2H[?12l[?25h![?25l[?12l[?25hn[?25l[?12l[?25ha[?25l[?12l[?25hk[?25l[?12l[?25hj[?25l[?12l[?25he[?25l[?12l[?25h[?25l[42;7H[K[42;7H[?12l[?25h[?25l[42;6H[K[42;6H[?12l[?25h[?25l[42;5H[K[42;5H[?12l[?25h[?25l[42;4H[K[42;4H[?12l[?25h[?25l[42;3H[K[42;3H[?12l[?25hm[?25l[?12l[?25ha[?25l[?12l[?25hk[?25l[?12l[?25he[?25l[?12l[?25h[?25l:!make[?1l>[?12l[?25h[?1049l
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL   -c -o switch_example.o switch_example.c
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL -Wl,-Map,switch_example.map -o switch_example.elf switch_example.o lcd_functions.o 
avr-objdump -h -S switch_example.elf > switch_example.lst
avr-objcopy -j .text -j .data -O ihex switch_example.elf switch_example.hex
avr-objcopy -j .text -j .data -O binary switch_example.elf switch_example.bin
avr-objcopy -j .text -j .data -O srec switch_example.elf switch_example.srec
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O ihex switch_example.elf switch_example_eeprom.hex \
|| { echo empty switch_example_eeprom.hex not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O binary switch_example.elf switch_example_eeprom.bin \
|| { echo empty switch_example_eeprom.bin not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O srec switch_example.elf switch_example_eeprom.srec \
|| { echo empty switch_example_eeprom.srec not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c
Press ENTER or type command to continue[?1049h[?1h=[27m[23m[m[H[2J[?25l[1;5H[93mcase[m(SET):[2;7Hswitch_count++;[3;7Hbutton_state=WAIT;[4;7H[93mbreak[m;
    [93mcase[m(WAIT):[6;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[7;9Hbutton_state=NOTSET;[8;7H}[9;7H[93mbreak[m;
    [93mdefault[m: [93mbreak[m;
  } [96m//switch                  [m
[38;5;81m#endif[m
} [96m//ISR[m

[38;5;121mint[m main([38;5;121mvoid[m){
  spi_init();      [96m//initalize SPI [m
  lcd_init();      [96m//initalize LCD [m
  clear_display(); [96m//manually clear LCD display [m
  cursor_off();    [96m//keep LCD cursor off

[m  [96m//TCNT0 running in CTC mode[m
  TIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m
  TCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m
  OCR0  |= [95m0x01[m;[8C[96m//sample really, really fast 
//OCR0  |= 0xFF;        //compare register set at 256[m

TCCR0 |= ([95m1[m<<CS00);[21C[96m//no prescaling
//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32
//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128
//TCCR0 |= (1<<CS02)|(1<<CS01)|(1<<CS00); //prescale by 1024

//interrupt period = 62.5ns * (0CR0+1) * prescale
//0CR0=0xFF, prescale=1024   => period=32.7ms
//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m

  sei(); [96m//enable global interrupts[m

  [93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m
    [93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m
    itoa(switch_count, lcd_str, [95m10[m);
    string2lcd(lcd_str);[42;126H87,1[10C93%[41;1H[?12l[?25h[?25l[42;126H[K[42;1H:[?12l[?25h![?25l[?12l[?25hm[?25l[?12l[?25ha[?25l[?12l[?25hk[?25l[?12l[?25he[?25l[?12l[?25h[?25l [?12l[?25hp[?25l[?12l[?25hr[?25l[?12l[?25ho[?25l[?12l[?25h...[?25l[42;11H[K[42;11H[?12l[?25hg[?25l[?12l[?25hr[?25l[?12l[?25hs[?25l[?12l[?25h[?25l[42;13H[K[42;13H[?12l[?25ha[?25l[?12l[?25hm[?25l[?12l[?25h[?25l[14C[?1l>[?12l[?25h[?1049l
avrdude -p m128 -c usbasp -e -U flash:w:switch_example.hex \
                                                     -U eeprom:w:switch_example_eeprom.hex

avrdude: warning: cannot set sck period. please check for usbasp firmware update.
avrdude: AVR device initialized and ready to accept instructions

Reading |                                                    | 0% 0.00sReading | #################                                  | 33% 0.00sReading | #################################                  | 66% 0.00sReading | ################################################## | 100% 0.00s

avrdude: Device signature = 0x1e9702 (probably m128)
avrdude: erasing chip
avrdude: warning: cannot set sck period. please check for usbasp firmware update.
avrdude: reading input file "switch_example.hex"
avrdude: input file switch_example.hex auto detected as Intel Hex
avrdude: writing flash (1252 bytes):

Writing |                                                    | 0% 0.00sWriting | ##########                                         | 20% 0.14sWriting | ####################                               | 40% 0.29sWriting | ##############################                     | 60% 0.43sWriting | ########################################           | 80% 0.57sWriting | ################################################## | 100% 0.72s

avrdude: 1252 bytes of flash written
avrdude: verifying flash memory against switch_example.hex:
avrdude: load data flash data from input file switch_example.hex:
avrdude: input file switch_example.hex auto detected as Intel Hex
avrdude: input file switch_example.hex contains 1252 bytes
avrdude: reading on-chip flash data:

Reading |                                                    | 0% 0.00sReading | ##########                                         | 20% 0.13sReading | ####################                               | 40% 0.26sReading | ##############################                     | 60% 0.39sReading | ########################################           | 80% 0.52sReading | ################################################## | 100% 0.65s

avrdude: verifying ...
avrdude: 1252 bytes of flash verified
avrdude: reading input file "switch_example_eeprom.hex"
avrdude: input file switch_example_eeprom.hex auto detected as Intel Hex
avrdude: writing eeprom (0 bytes):

Writing |                                                    | 0% 0.00sWriting | ################################################## | 100% 0.00s

avrdude: 0 bytes of eeprom written
avrdude: verifying eeprom memory against switch_example_eeprom.hex:
avrdude: load data eeprom data from input file switch_example_eeprom.hex:
avrdude: input file switch_example_eeprom.hex auto detected as Intel Hex
avrdude: input file switch_example_eeprom.hex contains 0 bytes
avrdude: reading on-chip eeprom data:

Reading |                                                    | 0% 0.00sReading | ################################################## | 100% 0.00s

avrdude: verifying ...
avrdude: 0 bytes of eeprom verified

avrdude: safemode: Fuses OK (E:FF, H:CF, L:EF)

avrdude done.  Thank you.

]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c
Press ENTER or type command to continue[?1049h[?1h=[27m[23m[m[H[2J[?25l[1;5H[93mcase[m(SET):[2;7Hswitch_count++;[3;7Hbutton_state=WAIT;[4;7H[93mbreak[m;
    [93mcase[m(WAIT):[6;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[7;9Hbutton_state=NOTSET;[8;7H}[9;7H[93mbreak[m;
    [93mdefault[m: [93mbreak[m;
  } [96m//switch                  [m
[38;5;81m#endif[m
} [96m//ISR[m

[38;5;121mint[m main([38;5;121mvoid[m){
  spi_init();      [96m//initalize SPI [m
  lcd_init();      [96m//initalize LCD [m
  clear_display(); [96m//manually clear LCD display [m
  cursor_off();    [96m//keep LCD cursor off

[m  [96m//TCNT0 running in CTC mode[m
  TIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m
  TCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m
  OCR0  |= [95m0x01[m;[8C[96m//sample really, really fast 
//OCR0  |= 0xFF;        //compare register set at 256[m

TCCR0 |= ([95m1[m<<CS00);[21C[96m//no prescaling
//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32
//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128
//TCCR0 |= (1<<CS02)|(1<<CS01)|(1<<CS00); //prescale by 1024

//interrupt period = 62.5ns * (0CR0+1) * prescale
//0CR0=0xFF, prescale=1024   => period=32.7ms
//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m

  sei(); [96m//enable global interrupts[m

  [93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m
    [93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m
    itoa(switch_count, lcd_str, [95m10[m);
    string2lcd(lcd_str);[42;126H87,1[10C93%[41;1H[?12l[?25h[?25l[1;5H  switch_count++;[2;7Hbutton_state=WAIT;[3;7H[93mbreak[m;[3;13H[K[4;5H[93mcase[m(WAIT):
      [93mif[m(bit_is_set(PIND,[95m1[m)){[6;7H  button_state=NOTSET;[6;29H[K[7;7H}[7;9H[K[8;7H[93mbreak[m;
    [93mdefault[m: [93mbreak[m;
  } [96m//switch                  [m
[38;5;81m#endif[m[11;7H[K[12;1H} [96m//ISR[m[13;1H[K[14;1H[38;5;121mint[m main([38;5;121mvoid[m){
  spi_init();      [96m//initalize SPI [m
  lcd[26C[96mLCD[m
  clear_display();[3C[96mmanually clear LCD display [m
  cursor_off();   [3C[96mkeep LCD cursor off[m[18;41H[K[19;3H[K[20;3H[96m//TCNT0 running in CTC mode[m
  TIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m
  TCCR0[8CWGM01[6C[96mCTC mode, no prescale[m
  OCR0  |= [95m0x01[m;      [4C[96msample really, really fast 
//OCR0  |= 0xFF;        //compare register set at 256[m[25;1H[K[26;1HTCCR0 |= ([95m1[m<<CS00);[21C[96m//no prescaling
//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32[28;19H2[37C128[29;29H1)|(1<<CS00);[16C024[m[30;1H[K[31;1H[96m//interrupt period = 62.5ns * (0CR0+1) * prescale
//0CR0=0xFF, prescale=1024   => period=32.7m[m[32;46H[K[33;3H[96mOCR0=0x01[11Cnone,  => 8Mhz (125ns)[m[33;45H[K[34;1H[K[35;3Hsei(); [96m//enable global interrupts[m[36;3H[K[37;3H[93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m
    [93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m
    itoa(switch_count, lcd_str, [95m10[m);[39;37H[K[40;5Hstring2lcd(lcd_str);[40;25H[K[41;5Hcursor_home();[41;19H[K[42;127H8,5[11C5[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//while[m[42;126H[K[42;126H89,5[10C97%[41;5H[?12l[?25h[?25l[42;127H8[40;5H[?12l[?25h[?25l[42;127H7[39;5H[?12l[?25h[?25l[42;127H6[38;5H[?12l[?25h[?25l[42;127H5[37;5H[?12l[?25h[?25l[42;127H4[36;5H[?12l[?25h[?25l[42;127H3,0-1[35;1H[?12l[?25h[?25l[42;127H2,5  [34;5H[?12l[?25h[?25l[42;127H1,0-1[33;1H[?12l[?25h[?25l[42;127H0,5  [32;5H[?12l[?25h[?25l[42;126H79[31;5H[?12l[?25h[?25l[42;127H8[30;5H[?12l[?25h[?25l[42;127H7,0-1[29;1H[?12l[?25h[?25l[42;127H6,5  [28;5H[?12l[?25h[?25l[42;127H5[27;5H[?12l[?25h[?25l[42;127H4[26;5H[?12l[?25h[?25l[42;127H3[25;5H[?12l[?25h[?25l[42;127H2,0-1[24;1H[?12l[?25h[?25l[42;127H1,5  [23;5H[?12l[?25h[?25l[42;127H0[22;5H[?12l[?25h[?25l[42;126H69[21;5H[?12l[?25h[?25l[42;127H8[20;5H[?12l[?25h[?25l[42;127H7[19;5H[?12l[?25h[?25l[42;127H6,1[18;1H[?12l[?25h[?25l[42;127H5,5[17;5H[?12l[?25h[?25l[42;127H4[16;5H[?12l[?25h[?25l[42;127H3[15;5H[?12l[?25h[?25l[42;127H2[14;5H[?12l[?25h[?25l[42;127H1[13;5H[?12l[?25h[?25l[42;127H0,0-1[12;1H[?12l[?25h[?25l[42;126H59,5  [11;5H[?12l[?25h[?25l[42;127H8[10;5H[?12l[?25h[?25l[42;127H7[9;5H[?12l[?25h[?25l[42;127H6[8;5H[?12l[?25h[?25l[42;127H5[7;5H[?12l[?25h[?25l[42;127H4[6;5H[?12l[?25h[?25l[42;127H3[5;5H[?12l[?25h[?25l[42;127H2[4;5H[?12l[?25h[?25l[42;127H1[3;5H[?12l[?25h[?25l[42;127H0[2;5H[?12l[?25h[?25l[42;126H49[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hswitch_count++;[42;126H[K[42;126H48,5[10C95%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(SET):[42;126H[K[42;126H47,5[10C93%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H} [93mbreak[m;[42;126H[K[42;126H46,5[10C91%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;9Hbutton_state=SET;[42;126H[K[42;126H45,5[10C89%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,5[10C87%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,5[10C85%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,5[10C83%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121menum[m button_state_type{NOTSET, SET, WAIT} button_state;[42;126H[K[42;126H41,5[10C81%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[96m//uses 3 state, state machne to make pushbutton code[m[42;126H[K[42;126H40,5[10C79%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#else[m[42;126H[K[42;126H39,5[10C77%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mif[m (state == [95m0xF000[m) {switch_count++;}[42;126H[K[42;126H38,5[10C75%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3Hstate = (state << [95m1[m) | (! bit_is_clear(PIND, [95m1[m)) | [95m0xE000[m;[42;126H[K[42;126H37,5[10C73%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121muint16_t[m state = [95m0[m; [96m//holds present state[m[42;126H[K[42;126H36,5[10C71%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#ifdef DEBOUNCE [m[42;126H[K[42;126H35,5[10C69%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1HISR(TIMER0_COMP_vect){[42;126H[K[42;126H34,5[10C67%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H33,0-1[8C65%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H}[96m//spi_init[m[42;126H[K[42;126H32,5[10C63%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPSR=([95m1[m<<SPI2X); [96m//SPI at 2x speed (8 MHz)  [m[42;126H[K[42;126H31,5[10C61%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPCR=([95m1[m<<SPE) | ([95m1[m<<MSTR); [96m//enable SPI, clk low initially, rising edge sample[m[42;126H[K[42;126H30,5[10C59%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[96m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m[42;126H[K[42;126H29,5[10C57%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HDDRB |=  [95m0x07[m;  [96m//Turn on SS, MOSI, SCLK[m[42;126H[K[42;126H28,5[10C55%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvoid[m spi_init([38;5;121mvoid[m){[42;126H[K[42;126H27,5[10C53%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H26,5[10C51%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Initalizes the SPI port on the mega128. Does no further device specific inits[m[42;126H[K[42;126H25,5[10C48%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//                            spi_init                               [m[42;126H[K[42;126H24,5[10C46%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H23,5[10C44%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H22,0-1[8C42%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121muint8_t[m i;[27C[96m//just a dumb counter[m[42;126H[K[42;126H21,5[10C40%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvolatile[m [38;5;121muint16_t[m switch_count = [95m0[m;  [96m//count switch closures[m[42;126H[K[42;126H20,5[10C38%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mchar[m lcd_str[[95m16[m];[20C[96m//holds string to send to lcd[m[42;126H[K[42;126H19,5[10C36%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H18,0-1[8C34%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//#define DEBOUNCE[m[42;126H[K[42;126H17,5[10C32%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H16,0-1[8C30%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m"lcd_functions.h"[m[42;126H[K[42;126H15,5[10C28%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<stdlib.h>[m[42;126H[K[42;126H14,5[10C26%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<string.h>[m[42;126H[K[42;126H13,5[10C24%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<util/delay.h>[m[42;126H[K[42;126H12,5[10C22%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/interrupt.h>[m[42;126H[K[42;126H11,5[10C20%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/io.h>[m[42;126H[K[42;126H10,5[10C18%[1;5H[?12l[?25h[?25l[42;127H1[2;5H[?12l[?25h[?25l[42;127H0[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H9,5[11C16%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//R. Traylor 12.16.2013[m[42;126H[K[42;126H8,5[11C14%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H7,0-1[9C12%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Note the use of #ifdef statements[m[42;126H[K[42;126H6,5[11C10%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the sampling time and note any difference.[m[42;126H[K[42;126H5,5[12C8%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the buttons and see which is worst. They can vary alot.[m[42;126H[K[42;126H4,5[12C6%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H3,0-1[10C4%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//TCNT0 is used with 16mhz clock to vary the sampling period.[m[42;126H[K[42;126H2,5[12C2%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//This code shows how debouncing should and should not be done.[m[42;126H[K[42;126H1,5[11CTop[1;5H[?12l[?25h[?25l[42;126H2[2;5H[?12l[?25h[?25l[42;126H3,0-1[3;1H[?12l[?25h[?25l[42;126H4,5  [4;5H[?12l[?25h[?25l[42;126H5[5;5H[?12l[?25h[?25l[42;126H6[6;5H[?12l[?25h[?25l[42;126H7,0-1[7;1H[?12l[?25h[?25l[42;126H8,5  [8;5H[?12l[?25h[?25l[42;126H9[9;5H[?12l[?25h[?25l[42;126H10,5[10;5H[?12l[?25h[?25l[42;127H1[11;5H[?12l[?25h[?25l[42;127H2[12;5H[?12l[?25h[?25l[42;127H3[13;5H[?12l[?25h[?25l[42;127H4[14;5H[?12l[?25h[?25l[42;127H5[15;5H[?12l[?25h[?25l[42;127H6,0-1[16;1H[?12l[?25h[?25l[42;127H7,5  [17;5H[?12l[?25h[?25l[42;127H8,0-1[18;1H[?12l[?25h[?25l[42;127H9,5  [19;5H[?12l[?25h[?25l[42;126H20[20;5H[?12l[?25h[?25l[42;127H1[21;5H[?12l[?25h[?25l[42;127H2,0-1[22;1H[?12l[?25h[?25l[42;127H3,5  [23;5H[?12l[?25h[?25l[42;127H4[24;5H[?12l[?25h[?25l[42;127H5[25;5H[?12l[?25h[?25l[42;127H6[26;5H[?12l[?25h[?25l[42;127H7[27;5H[?12l[?25h[?25l[42;127H8[28;5H[?12l[?25h[?25l[42;127H9[29;5H[?12l[?25h[?25l[42;126H30[30;5H[?12l[?25h[?25l[42;127H1[31;5H[?12l[?25h[?25l[42;127H2[32;5H[?12l[?25h[?25l[42;127H3,0-1[33;1H[?12l[?25h[?25l[42;127H4,5  [34;5H[?12l[?25h[?25l[42;127H5[35;5H[?12l[?25h[?25l[42;127H6[36;5H[?12l[?25h[?25l[42;127H7[37;5H[?12l[?25h[?25l[42;127H8[38;5H[?12l[?25h[?25l[42;127H9[39;5H[?12l[?25h[?25l[42;126H40[40;5H[?12l[?25h[?25l[42;127H1[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,5[11C2%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,5[11C4%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,5[11C6%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=SET;[42;126H[K[42;126H45,5[11C8%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H} [93mbreak[m;[42;126H[K[42;126H46,5[10C10%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(SET):[42;126H[K[42;126H47,5[10C12%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hswitch_count++;[42;126H[K[42;126H48,5[10C14%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,5[10C16%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,5[10C18%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(WAIT):[42;126H[K[42;126H51,5[10C20%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[42;126H[K[42;126H52,5[10C22%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=NOTSET;[42;126H[K[42;126H53,5[10C24%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H}[42;126H[K[42;126H54,5[10C26%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H55,5[10C28%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mdefault[m: [93mbreak[m;[42;126H[K[42;126H56,5[10C30%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//switch                  [m[42;126H[K[42;126H57,5[10C32%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;81m#endif[m[42;126H[K[42;126H58,5[10C34%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//ISR[m[42;126H[K[42;126H59,5[10C36%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H60,0-1[8C38%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;121mint[m main([38;5;121mvoid[m){[42;126H[K[42;126H61,5[10C40%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hspi_init();      [96m//initalize SPI [m[42;126H[K[42;126H62,5[10C42%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hlcd_init();      [96m//initalize LCD [m[42;126H[K[42;126H63,5[10C44%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hclear_display(); [96m//manually clear LCD display [m[42;126H[K[42;126H64,5[10C46%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hcursor_off();    [96m//keep LCD cursor off[m[42;126H[K[42;126H65,5[10C48%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H66,1[10C51%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[96m//TCNT0 running in CTC mode[m[42;126H[K[42;126H67,5[10C53%[41;5H[?12l[?25h[?25l[42;127H6,1[40;1H[?12l[?25h[?25l[42;127H5,5[39;5H[?12l[?25h[?25l[42;127H4[38;5H[?12l[?25h[?25l[42;127H3[37;5H[?12l[?25h[?25l[42;127H2[36;5H[?12l[?25h[?25l[42;127H1[35;5H[?12l[?25h[?25l[42;127H0,0-1[34;1H[?12l[?25h[?25l[42;126H59,5  [33;5H[?12l[?25h[?25l[42;127H8[32;5H[?12l[?25h[?25l[42;127H7[31;5H[?12l[?25h[?25l[42;127H6[30;5H[?12l[?25h[?25l[42;127H5[29;5H[?12l[?25h[?25l[42;127H4[28;5H[?12l[?25h[?25l[42;127H3[27;5H[?12l[?25h[?25l[42;127H2[26;5H[?12l[?25h[?25l[42;127H1[25;5H[?12l[?25h[?25l[42;127H0[24;5H[?12l[?25h[?25l[42;126H49[23;5H[?12l[?25h[?25l[42;127H8[22;5H[?12l[?25h[?25l[42;127H9[23;5H[?12l[?25h[?25l[42;126H50[24;5H[?12l[?25h[?25l[42;127H1[25;5H[?12l[?25h[?25l[42;127H2[26;5H[?12l[?25h[?25l[42;127H3[27;5H[?12l[?25h[?25l[42;127H4[28;5H[?12l[?25h[?25l[42;127H5[29;5H[?12l[?25h[?25l[42;127H6[30;5H[?12l[?25h[?25l[42;127H7[31;5H[?12l[?25h[?25l[42;127H8[32;5H[?12l[?25h[?25l[42;127H9[33;5H[?12l[?25h[?25l[42;126H60,0-1[34;1H[?12l[?25h[?25l[42;127H1,5  [35;5H[?12l[?25h[?25l[42;127H2[36;5H[?12l[?25h[?25l[42;127H3[37;5H[?12l[?25h[?25l[42;127H4[38;5H[?12l[?25h[?25l[42;127H5[39;5H[?12l[?25h[?25l[42;127H6,1[40;1H[?12l[?25h[?25l[42;127H7,5[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m[42;126H[K[42;126H68,5[10C55%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m[42;126H[K[42;126H69,5[10C57%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HOCR0  |= [95m0x01[m;[8C[96m//sample really, really fast [m[42;126H[K[42;126H70,5[10C59%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0  |= 0xFF;        //compare register set at 256[m[42;126H[K[42;126H71,5[10C61%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H72,0-1[8C63%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1HTCCR0 |= ([95m1[m<<CS00);[21C[96m//no prescaling[m[42;126H[K[42;126H73,5[10C65%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32[m[42;126H[K[42;126H74,5[10C67%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m[42;126H[K[42;126H75,5[10C69%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS01)|(1<<CS00); //prescale by 1024[m[42;126H[K[42;126H76,5[10C71%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H77,0-1[8C73%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//interrupt period = 62.5ns * (0CR0+1) * prescale[m[42;126H[K[42;126H78,5[10C75%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//0CR0=0xFF, prescale=1024   => period=32.7ms[m[42;126H[K[42;126H79,5[10C77%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m[42;126H[K[42;126H80,5[10C79%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H81,0-1[8C81%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hsei(); [96m//enable global interrupts[m[42;126H[K[42;126H82,5[10C83%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H83,0-1[8C85%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m[42;126H[K[42;126H84,5[10C87%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m[42;126H[K[42;126H85,5[10C89%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hitoa(switch_count, lcd_str, [95m10[m);[42;126H[K[42;126H86,5[10C91%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hstring2lcd(lcd_str);[42;126H[K[42;126H87,5[10C93%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hcursor_home();[42;126H[K[42;126H88,5[10C95%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//while[m[42;126H[K[42;126H89,5[10C97%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//main[m[42;126H[K[42;126H90,5[10CBot[41;5H[?12l[?25h[?25l[42;126H89[40;5H[?12l[?25h[?25l[42;127H8[39;5H[?12l[?25h[?25l[42;127H7[38;5H[?12l[?25h[?25l[42;127H6[37;5H[?12l[?25h[?25l[42;127H5[36;5H[?12l[?25h[?25l[42;127H4[35;5H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H2,5  [33;5H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,5  [31;5H[?12l[?25h[?25l[42;126H79[30;5H[?12l[?25h[?25l[42;127H8[29;5H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,5  [27;5H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H8,5  [29;5H[?12l[?25h[?25l[42;127H9[30;5H[?12l[?25h[?25l[42;126H80[31;5H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H2,5  [33;5H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H4,5  [35;5H[?12l[?25h[?25l[42;127H5[36;5H[?12l[?25h[?25l[42;127H6[37;5H[?12l[?25h[?25l[42;127H7[38;5H[?12l[?25h[?25l[42;127H8[39;5H[?12l[?25h[?25l[42;127H9[40;5H[?12l[?25h[?25l[42;126H90[41;5H[?12l[?25h[?25l[42;126H89[40;5H[?12l[?25h[?25l[42;127H8[39;5H[?12l[?25h[?25l[42;127H7[38;5H[?12l[?25h[?25l[42;127H6[37;5H[?12l[?25h[?25l[42;127H5[36;5H[?12l[?25h[?25l[42;127H4[35;5H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H2,5  [33;5H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,5  [31;5H[?12l[?25h[?25l[42;126H79[30;5H[?12l[?25h[?25l[42;127H8[29;5H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,5  [27;5H[?12l[?25h[?25l[42;127H5[26;5H[?12l[?25h[?25l[42;127H4[25;5H[?12l[?25h[?25l[42;127H3[24;5H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,5  [22;5H[?12l[?25h[?25l[42;127H0[21;5H[?12l[?25h[?25l[42;126H69[20;5H[?12l[?25h[?25l[42;127H8[19;5H[?12l[?25h[?25l[42;127H7[18;5H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H5,5[16;5H[?12l[?25h[?25l[42;127H4[15;5H[?12l[?25h[?25l[42;127H3[14;5H[?12l[?25h[?25l[42;127H4[15;5H[?12l[?25h[?25l[42;127H5[16;5H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H7,5[18;5H[?12l[?25h[?25l[42;127H8[19;5H[?12l[?25h[?25l[42;127H9[20;5H[?12l[?25h[?25l[42;126H70[21;5H[?12l[?25h[?25l[42;127H1[22;5H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,5  [22;5H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H3,5  [24;5H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,5  [22;5H[?12l[?25h[?25l[42;127H0[21;5H[?12l[?25h[?25l[42;126H69[20;5H[?12l[?25h[?25l[42;127H8[19;5H[?12l[?25h[?25l[42;127H7[18;5H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H5,5[16;5H[?12l[?25h[?25l[42;127H4[15;5H[?12l[?25h[?25l[42;127H3[14;5H[?12l[?25h[?25l[42;127H2[13;5H[?12l[?25h[?25l[42;127H1[12;5H[?12l[?25h[?25l[42;127H0,0-1[11;1H[?12l[?25h[?25l[42;126H59,5  [10;5H[?12l[?25h[?25l[42;127H8[9;5H[?12l[?25h[?25l[42;127H7[8;5H[?12l[?25h[?25l[42;127H6[7;5H[?12l[?25h[?25l[42;127H7[8;5H[?12l[?25h[?25l[42;127H8[9;5H[?12l[?25h[?25l[42;127H9[10;5H[?12l[?25h[?25l[42;126H60,0-1[11;1H[?12l[?25h[?25l[42;127H1,5  [12;5H[?12l[?25h[?25l[42;127H2[13;5H[?12l[?25h[?25l[42;127H3[14;5H[?12l[?25h[?25l[42;127H4[15;5H[?12l[?25h[?25l[42;127H5[16;5H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H7,5[18;5H[?12l[?25h[?25l[42;127H8[19;5H[?12l[?25h[?25l[42;127H9[20;5H[?12l[?25h[?25l[42;127H8[19;5H[?12l[?25h[?25l[42;127H7[18;5H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H5,5[16;5H[?12l[?25h[?25l[42;127H4[15;5H[?12l[?25h[?25l[42;127H3[14;5H[?12l[?25h[?25l[42;127H2[13;5H[?12l[?25h[?25l[42;127H1[12;5H[?12l[?25h[?25l[42;127H0,0-1[11;1H[?12l[?25h[?25l[42;126H59,5  [10;5H[?12l[?25h[?25l[42;127H8[9;5H[?12l[?25h[?25l[42;127H7[8;5H[?12l[?25h[?25l[42;127H6[7;5H[?12l[?25h[?25l[42;127H5[6;5H[?12l[?25h[?25l[42;127H4[5;5H[?12l[?25h[?25l[42;127H3[4;5H[?12l[?25h[?25l[42;127H2[3;5H[?12l[?25h[?25l[42;127H1[2;5H[?12l[?25h[?25l[42;127H0[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hbutton_state=WAIT;[42;126H[K[42;126H49,5[10C97%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hswitch_count++;[42;126H[K[42;126H48,5[10C95%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(SET):[42;126H[K[42;126H47,5[10C93%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H} [93mbreak[m;[42;126H[K[42;126H46,5[10C91%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;9Hbutton_state=SET;[42;126H[K[42;126H45,5[10C89%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,5[10C87%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,5[10C85%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,5[10C83%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121menum[m button_state_type{NOTSET, SET, WAIT} button_state;[42;126H[K[42;126H41,5[10C81%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[96m//uses 3 state, state machne to make pushbutton code[m[42;126H[K[42;126H40,5[10C79%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#else[m[42;126H[K[42;126H39,5[10C77%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mif[m (state == [95m0xF000[m) {switch_count++;}[42;126H[K[42;126H38,5[10C75%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3Hstate = (state << [95m1[m) | (! bit_is_clear(PIND, [95m1[m)) | [95m0xE000[m;[42;126H[K[42;126H37,5[10C73%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121muint16_t[m state = [95m0[m; [96m//holds present state[m[42;126H[K[42;126H36,5[10C71%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#ifdef DEBOUNCE [m[42;126H[K[42;126H35,5[10C69%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1HISR(TIMER0_COMP_vect){[42;126H[K[42;126H34,5[10C67%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H33,0-1[8C65%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H}[96m//spi_init[m[42;126H[K[42;126H32,5[10C63%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPSR=([95m1[m<<SPI2X); [96m//SPI at 2x speed (8 MHz)  [m[42;126H[K[42;126H31,5[10C61%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPCR=([95m1[m<<SPE) | ([95m1[m<<MSTR); [96m//enable SPI, clk low initially, rising edge sample[m[42;126H[K[42;126H30,5[10C59%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[96m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m[42;126H[K[42;126H29,5[10C57%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HDDRB |=  [95m0x07[m;  [96m//Turn on SS, MOSI, SCLK[m[42;126H[K[42;126H28,5[10C55%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvoid[m spi_init([38;5;121mvoid[m){[42;126H[K[42;126H27,5[10C53%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H26,5[10C51%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Initalizes the SPI port on the mega128. Does no further device specific inits[m[42;126H[K[42;126H25,5[10C48%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//                            spi_init                               [m[42;126H[K[42;126H24,5[10C46%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H23,5[10C44%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H22,0-1[8C42%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121muint8_t[m i;[27C[96m//just a dumb counter[m[42;126H[K[42;126H21,5[10C40%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvolatile[m [38;5;121muint16_t[m switch_count = [95m0[m;  [96m//count switch closures[m[42;126H[K[42;126H20,5[10C38%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mchar[m lcd_str[[95m16[m];[20C[96m//holds string to send to lcd[m[42;126H[K[42;126H19,5[10C36%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H18,0-1[8C34%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//#define DEBOUNCE[m[42;126H[K[42;126H17,5[10C32%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H16,0-1[8C30%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m"lcd_functions.h"[m[42;126H[K[42;126H15,5[10C28%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<stdlib.h>[m[42;126H[K[42;126H14,5[10C26%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<string.h>[m[42;126H[K[42;126H13,5[10C24%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<util/delay.h>[m[42;126H[K[42;126H12,5[10C22%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/interrupt.h>[m[42;126H[K[42;126H11,5[10C20%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/io.h>[m[42;126H[K[42;126H10,5[10C18%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H9,5[11C16%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//R. Traylor 12.16.2013[m[42;126H[K[42;126H8,5[11C14%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H7,0-1[9C12%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Note the use of #ifdef statements[m[42;126H[K[42;126H6,5[11C10%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the sampling time and note any difference.[m[42;126H[K[42;126H5,5[12C8%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the buttons and see which is worst. They can vary alot.[m[42;126H[K[42;126H4,5[12C6%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H3,0-1[10C4%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//TCNT0 is used with 16mhz clock to vary the sampling period.[m[42;126H[K[42;126H2,5[12C2%[1;5H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//This code shows how debouncing should and should not be done.[m[42;126H[K[42;126H1,5[11CTop[1;5H[?12l[?25h[?25l[42;126H2[2;5H[?12l[?25h[?25l[42;126H3,0-1[3;1H[?12l[?25h[?25l[42;126H4,5  [4;5H[?12l[?25h[?25l[42;126H5[5;5H[?12l[?25h[?25l[42;126H6[6;5H[?12l[?25h[?25l[42;126H7,0-1[7;1H[?12l[?25h[?25l[42;126H8,5  [8;5H[?12l[?25h[?25l[42;126H9[9;5H[?12l[?25h[?25l[42;126H10,5[10;5H[?12l[?25h[?25l[42;127H1[11;5H[?12l[?25h[?25l[42;127H2[12;5H[?12l[?25h[?25l[42;127H3[13;5H[?12l[?25h[?25l[42;127H4[14;5H[?12l[?25h[?25l[42;127H5[15;5H[?12l[?25h[?25l[42;127H6,0-1[16;1H[?12l[?25h[?25l[42;127H7,5  [17;5H[?12l[?25h[?25l[42;127H8,0-1[18;1H[?12l[?25h[?25l[42;127H9,5  [19;5H[?12l[?25h[?25l[42;126H20[20;5H[?12l[?25h[?25l[42;127H1[21;5H[?12l[?25h[?25l[42;127H2,0-1[22;1H[?12l[?25h[?25l[42;127H3,5  [23;5H[?12l[?25h[?25l[42;127H4[24;5H[?12l[?25h[?25l[42;127H5[25;5H[?12l[?25h[?25l[42;127H6[26;5H[?12l[?25h[?25l[42;127H7[27;5H[?12l[?25h[?25l[42;127H8[28;5H[?12l[?25h[?25l[42;127H9[29;5H[?12l[?25h[?25l[42;126H30[30;5H[?12l[?25h[?25l[42;127H1[31;5H[?12l[?25h[?25l[42;127H2[32;5H[?12l[?25h[?25l[42;127H3,0-1[33;1H[?12l[?25h[?25l[42;127H4,5  [34;5H[?12l[?25h[?25l[42;127H5[35;5H[?12l[?25h[?25l[42;127H6[36;5H[?12l[?25h[?25l[42;127H7[37;5H[?12l[?25h[?25l[42;127H8[38;5H[?12l[?25h[?25l[42;127H9[39;5H[?12l[?25h[?25l[42;126H40[40;5H[?12l[?25h[?25l[42;127H1[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,5[11C2%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,5[11C4%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,5[11C6%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=SET;[42;126H[K[42;126H45,5[11C8%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H} [93mbreak[m;[42;126H[K[42;126H46,5[10C10%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(SET):[42;126H[K[42;126H47,5[10C12%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hswitch_count++;[42;126H[K[42;126H48,5[10C14%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,5[10C16%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,5[10C18%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(WAIT):[42;126H[K[42;126H51,5[10C20%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[42;126H[K[42;126H52,5[10C22%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=NOTSET;[42;126H[K[42;126H53,5[10C24%[41;5H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H}[42;126H[K[42;126H54,5[10C26%[41;5H[?12l[?25h[?25l[42;127H3[40;5H[?12l[?25h[?25l[42;127H2[39;5H[?12l[?25h[?25l[42;127H1[38;5H[?12l[?25h[?25l[42;127H0[37;5H[?12l[?25h[?25l[42;126H49[36;5H[?12l[?25h[?25l[42;127H8[35;5H[?12l[?25h[?25l[42;127H7[34;5H[?12l[?25h[?25l[42;127H6[33;5H[?12l[?25h[?25l[42;127H5[32;5H[?12l[?25h[?25l[42;127H4[31;5H[?12l[?25h[?25l[42;127H3[30;5H[?12l[?25h[?25l[42;127H2[29;5H[?12l[?25h[?25l[42;127H1[28;5H[?12l[?25h[?25l[42;127H0[27;5H[?12l[?25h[?25l[42;126H39[26;5H[?12l[?25h[?25l[42;127H8[25;5H[?12l[?25h[?25l[42;127H7[24;5H[?12l[?25h[?25l[42;127H6[23;5H[?12l[?25h[?25l[42;127H5[22;5H[?12l[?25h[?25l[42;127H4[21;5H[?12l[?25h[?25l[42;127H3,0-1[20;1H[?12l[?25h[?25l[42;127H2,5  [19;5H[?12l[?25h[?25l[42;127H3,0-1[20;1H[?12l[?25h[?25l[42;127H4,5  [21;5H[?12l[?25h[?25l[42;127H5[22;5H[?12l[?25h[?25l[42;127H4[21;5H[?12l[?25h[?25l[42;129H6[21;6H[?12l[?25h[?25l[42;129H7[21;7H[?12l[?25h[?25l[42;129H8[21;8H[?12l[?25h[?25l[42;129H9[21;9H[?12l[?25h[?25l[42;129H10[21;10H[?12l[?25h[?25l[42;130H1[21;11H[?12l[?25h[?25l[42;130H2[21;12H[?12l[?25h[?25l[42;130H3[21;13H[?12l[?25h[?25l[42;130H4[21;14H[?12l[?25h[?25l[42;130H5[21;15H[?12l[?25h[?25l[42;130H6[21;16H[?12l[?25h[?25l[42;130H7[21;17H[?12l[?25h[?25l[42;130H8[21;18H[?12l[?25h[?25l[42;130H9[21;19H[?12l[?25h[?25l[42;127H3,0-1[20;1H[?12l[?25h[?25l[42;127H2,11 [19;11H[?12l[?25h[?25l[18;10H[46m([8C)[m[42;127H1,19[18;19H[?12l[?25h[?25l[18;10H([8C)[42;127H0[17;19H[?12l[?25h[?25l[18;10H[46m([8C)[m[42;127H1[18;19H[?12l[?25h[?25l[18;10H([8C)[42;127H2,11[19;11H[?12l[?25h[?25l[42;127H3,0-1[20;1H[?12l[?25h[?25l[42;127H4,19 [21;19H[?12l[?25h[?25l[42;127H5,16[22;16H[?12l[?25h[?25l[42;127H6,19[23;19H[?12l[?25h[?25l[42;127H7[24;19H[?12l[?25h[?25l[42;127H8[25;19H[?12l[?25h[?25l[42;127H9,6 [26;6H[?12l[?25h[?25l[42;126H40,19[27;19H[?12l[?25h[?25l[42;127H1[28;19H[?12l[?25h[?25l[42;127H2[29;19H[?12l[?25h[?25l[42;127H3,18[30;18H[?12l[?25h[?25l[42;127H4,19[31;19H[?12l[?25h[?25l[42;127H5[32;19H[?12l[?25h[?25l[42;127H6,14[33;14H[?12l[?25h[?25l[42;127H7,15[34;15H[?12l[?25h[?25l[42;127H8,19[35;19H[?12l[?25h[?25l[42;127H9[36;19H[?12l[?25h[?25l[42;126H50,12[37;12H[?12l[?25h[?25l[42;127H1,16[38;16H[?12l[?25h[?25l[42;127H2,19[39;19H[?12l[?25h[?25l[42;127H3[40;19H[?12l[?25h[?25l[42;127H4,8 [41;8H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H55,12[9C28%[41;12H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mdefault[m: [93mbreak[m;[42;126H[K[42;126H56,19[9C30%[41;19H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//switch                  [m[42;126H[K[42;126H57,19[9C32%[41;19H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;81m#endif[m[42;126H[K[42;126H58,6[10C34%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//ISR[m[42;126H[K[42;126H59,7[10C36%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H60,0-1[8C38%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;121mint[m main([38;5;121mvoid[m){[42;126H[K[42;126H61,15[9C40%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hspi_init();      [96m//initalize SPI [m[42;126H[K[42;126H62,19[9C42%[41;19H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hlcd_init();      [96m//initalize LCD [m[42;126H[K[42;126H63,19[9C44%[41;19H[?12l[?25h[?25l[42;127H2[40;19H[?12l[?25h[?25l[42;127H1,15[39;15H[?12l[?25h[?25l[42;127H0,0-1[38;1H[?12l[?25h[?25l[42;126H59,7  [37;7H[?12l[?25h[?25l[42;127H8,6[36;6H[?12l[?25h[?25l[42;127H7,19[35;19H[?12l[?25h[?25l[42;127H6[34;19H[?12l[?25h[?25l[42;127H5,12[33;12H[?12l[?25h[?25l[42;127H4,8 [32;8H[?12l[?25h[?25l[42;127H3,19[31;19H[?12l[?25h[?25l[42;127H2[30;19H[?12l[?25h[?25l[42;127H1,16[29;16H[?12l[?25h[?25l[42;127H0,12[28;12H[?12l[?25h[?25l[42;126H49,19[27;19H[?12l[?25h[?25l[42;127H8[26;19H[?12l[?25h[?25l[42;127H7,15[25;15H[?12l[?25h[?25l[42;127H6,14[24;14H[?12l[?25h[?25l[42;127H5,19[23;19H[?12l[?25h[?25l[42;127H4[22;19H[?12l[?25h[?25l[42;127H3,18[21;18H[?12l[?25h[?25l[42;127H2,19[20;19H[?12l[?25h[?25l[42;127H1[19;19H[?12l[?25h[?25l[42;127H0[18;19H[?12l[?25h[?25l[42;126H39,6 [17;6H[?12l[?25h[?25l[42;127H8,19[16;19H[?12l[?25h[?25l[42;127H7[15;19H[?12l[?25h[?25l[42;127H6[14;19H[?12l[?25h[?25l[42;127H5,16[13;16H[?12l[?25h[?25l[42;127H4,19[12;19H[?12l[?25h[?25l[42;127H3,0-1[11;1H[?12l[?25h[?25l[42;127H2,11 [10;11H[?12l[?25h[?25l[9;10H[46m([8C)[m[42;127H1,19[9;19H[?12l[?25h[?25l[9;10H([8C)[42;130H8[9;18H[?12l[?25h[?25l[42;130H7[9;17H[?12l[?25h[?25l[42;130H6[9;16H[?12l[?25h[?25l[42;130H5[9;15H[?12l[?25h[?25l[42;130H4[9;14H[?12l[?25h[?25l[42;130H3[9;13H[?12l[?25h[?25l[42;130H2[9;12H[?12l[?25h[?25l[42;130H1[9;11H[?12l[?25h[?25l[46m([8C)[m[42;130H0[9;10H[?12l[?25h[?25l([8C)[42;129H9 [9;9H[?12l[?25h[?25l[42;129H8[9;8H[?12l[?25h[?25l[42;129H7[9;7H[?12l[?25h[?25l[42;129H6[9;6H[?12l[?25h[?25l[42;127H2[10;6H[?12l[?25h[?25l[42;127H3,0-1[11;1H[?12l[?25h[?25l[42;127H4,6  [12;6H[?12l[?25h[?25l[42;127H5[13;6H[?12l[?25h[?25l[42;127H6[14;6H[?12l[?25h[?25l[42;127H7[15;6H[?12l[?25h[?25l[16;6H[46m([15C)[m[42;127H8[16;6H[?12l[?25h[?25l([15C)[42;127H9[17;6H[?12l[?25h[?25l[42;126H40[18;6H[?12l[?25h[?25l[42;127H1[19;6H[?12l[?25h[?25l[42;127H2[20;6H[?12l[?25h[?25l[42;127H3[21;6H[?12l[?25h[?25l[42;127H4[22;6H[?12l[?25h[?25l[42;127H5[23;6H[?12l[?25h[?25l[42;127H6[24;6H[?12l[?25h[?25l[42;127H7[25;6H[?12l[?25h[?25l[42;127H8[26;6H[?12l[?25h[?25l[42;127H9[27;6H[?12l[?25h[?25l[42;126H50[28;6H[?12l[?25h[?25l[42;127H1[29;6H[?12l[?25h[?25l[42;127H2[30;6H[?12l[?25h[?25l[42;127H3[31;6H[?12l[?25h[?25l[42;127H4[32;6H[?12l[?25h[?25l[42;127H5[33;6H[?12l[?25h[?25l[42;127H6[34;6H[?12l[?25h[?25l[42;127H7[35;6H[?12l[?25h[?25l[42;127H8[36;6H[?12l[?25h[?25l[42;127H9[37;6H[?12l[?25h[?25l[42;126H60,0-1[38;1H[?12l[?25h[?25l[42;127H1,6  [39;6H[?12l[?25h[?25l[42;127H2[40;6H[?12l[?25h[?25l[42;127H3[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hclear_display(); [96m//manually clear LCD display [m[42;126H[K[42;126H64,6[10C46%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hcursor_off();    [96m//keep LCD cursor off[m[42;126H[K[42;126H65,6[10C48%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H66,1[10C51%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[96m//TCNT0 running in CTC mode[m[42;126H[K[42;126H67,6[10C53%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m[42;126H[K[42;126H68,6[10C55%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m[42;126H[K[42;126H69,6[10C57%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HOCR0  |= [95m0x01[m;[8C[96m//sample really, really fast [m[42;126H[K[42;126H70,6[10C59%[41;6H[?12l[?25h[?25l[42;126H69[40;6H[?12l[?25h[?25l[42;127H8[39;6H[?12l[?25h[?25l[42;127H7[38;6H[?12l[?25h[?25l[42;127H6,1[37;1H[?12l[?25h[?25l[42;127H5,6[36;6H[?12l[?25h[?25l[42;127H4[35;6H[?12l[?25h[?25l[42;127H3[34;6H[?12l[?25h[?25l[42;127H2[33;6H[?12l[?25h[?25l[42;127H1[32;6H[?12l[?25h[?25l[42;127H0,0-1[31;1H[?12l[?25h[?25l[42;126H59,6  [30;6H[?12l[?25h[?25l[42;127H8[29;6H[?12l[?25h[?25l[42;127H7[28;6H[?12l[?25h[?25l[42;127H6[27;6H[?12l[?25h[?25l[42;127H5[26;6H[?12l[?25h[?25l[42;127H4[25;6H[?12l[?25h[?25l[42;127H3[24;6H[?12l[?25h[?25l[42;127H2[23;6H[?12l[?25h[?25l[42;127H1[22;6H[?12l[?25h[?25l[42;127H0[21;6H[?12l[?25h[?25l[42;126H49[20;6H[?12l[?25h[?25l[42;127H8[19;6H[?12l[?25h[?25l[42;127H7[18;6H[?12l[?25h[?25l[42;127H6[17;6H[?12l[?25h[?25l[42;127H5[16;6H[?12l[?25h[?25l[42;127H4[15;6H[?12l[?25h[?25l[42;127H3[14;6H[?12l[?25h[?25l[42;127H4[15;6H[?12l[?25h[?25l[42;129H7[15;7H[?12l[?25h[?25l[42;127H5[16;7H[?12l[?25h[?25l[15;31H[46m{[17;7H}[m[42;127H6[17;7H[?12l[?25h[?25l[15;31H{[17;7H}[42;127H7[18;7H[?12l[?25h[?25l[42;127H8[19;7H[?12l[?25h[?25l[42;127H9[20;7H[?12l[?25h[?25l[42;126H50[21;7H[?12l[?25h[?25l[42;127H1[22;7H[?12l[?25h[?25l[42;127H2[23;7H[?12l[?25h[?25l[42;127H3[24;7H[?12l[?25h[?25l[23;29H[46m{[25;7H}[m[42;127H4[25;7H[?12l[?25h[?25l[23;29H{[25;7H}[42;127H5[26;7H[?12l[?25h[?25l[42;127H6[27;7H[?12l[?25h[?25l[42;127H7[28;7H[?12l[?25h[?25l[42;127H8,6[29;6H[?12l[?25h[?25l[42;127H9,7[30;7H[?12l[?25h[?25l[42;127H8,6[29;6H[?12l[?25h[?25l[42;127H7,7[28;7H[?12l[?25h[?25l[42;127H6[27;7H[?12l[?25h[?25l[42;127H5[26;7H[?12l[?25h[?25l[23;29H[46m{[25;7H}[m[42;127H4[25;7H[?12l[?25h[?25l[23;29H{[25;7H}[42;127H3[24;7H[?12l[?25h[?25l[42;127H2[23;7H[?12l[?25h[?25l[42;127H1[22;7H[?12l[?25h[?25l[42;127H0[21;7H[?12l[?25h[?25l[42;126H49[20;7H[?12l[?25h[?25l[42;127H8[19;7H[?12l[?25h[?25l[42;127H9[20;7H[?12l[?25h[?25l[42;126H50[21;7H[?12l[?25h[?25l[42;127H1[22;7H[?12l[?25h[?25l[42;127H2[23;7H[?12l[?25h[?25l[42;127H3[24;7H[?12l[?25h[?25l[23;29H[46m{[25;7H}[m[42;127H4[25;7H[?12l[?25h[?25l[23;29H{[25;7H}[42;127H5[26;7H[?12l[?25h[?25l[42;127H6[27;7H[?12l[?25h[?25l[42;127H7[28;7H[?12l[?25h[?25l[42;127H8,6[29;6H[?12l[?25h[?25l[42;127H9,7[30;7H[?12l[?25h[?25l[42;126H60,0-1[31;1H[?12l[?25h[?25l[42;127H1,7  [32;7H[?12l[?25h[?25l[42;127H2[33;7H[?12l[?25h[?25l[42;127H3[34;7H[?12l[?25h[?25l[42;127H4[35;7H[?12l[?25h[?25l[42;127H5[36;7H[?12l[?25h[?25l[42;127H6,1[37;1H[?12l[?25h[?25l[42;127H7,7[38;7H[?12l[?25h[?25l[42;127H8[39;7H[?12l[?25h[?25l[42;127H9[40;7H[?12l[?25h[?25l[42;126H70[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0  |= 0xFF;        //compare register set at 256[m[42;126H[K[42;126H71,7[10C61%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H72,0-1[8C63%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1HTCCR0 |= ([95m1[m<<CS00);[21C[96m//no prescaling[m[42;126H[K[42;126H73,7[10C65%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32[m[42;126H[K[42;126H74,7[10C67%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m[42;126H[K[42;126H75,7[10C69%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS01)|(1<<CS00); //prescale by 1024[m[42;126H[K[42;126H76,7[10C71%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H77,0-1[8C73%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//interrupt period = 62.5ns * (0CR0+1) * prescale[m[42;126H[K[42;126H78,7[10C75%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//0CR0=0xFF, prescale=1024   => period=32.7ms[m[42;126H[K[42;126H79,7[10C77%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m[42;126H[K[42;126H80,7[10C79%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H81,0-1[8C81%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hsei[46m()[m; [96m//enable global interrupts[m[42;126H[K[42;126H82,7[10C83%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[40;6H()[42;126H[K[42;126H83,0-1[8C85%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m[42;126H[K[42;126H84,7[10C87%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m[42;126H[K[42;126H85,7[10C89%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hitoa(switch_count, lcd_str, [95m10[m);[42;126H[K[42;126H86,7[10C91%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hstring2lcd(lcd_str);[42;126H[K[42;126H87,7[10C93%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hcursor_home();[42;126H[K[42;126H88,7[10C95%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//while[m[42;126H[K[42;126H89,7[10C97%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//main[m[42;126H[K[42;126H90,7[10CBot[41;7H[?12l[?25h[?25l[42;126H89[40;7H[?12l[?25h[?25l[42;127H8[39;7H[?12l[?25h[?25l[42;127H7[38;7H[?12l[?25h[?25l[42;127H6[37;7H[?12l[?25h[?25l[42;127H5[36;7H[?12l[?25h[?25l[42;127H4[35;7H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[33;6H[46m()[m[42;127H2,7  [33;7H[?12l[?25h[?25l()[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,7  [31;7H[?12l[?25h[?25l[42;126H79[30;7H[?12l[?25h[?25l[42;127H8[29;7H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,7  [27;7H[?12l[?25h[?25l[42;127H5[26;7H[?12l[?25h[?25l[42;127H4[25;7H[?12l[?25h[?25l[42;127H3[24;7H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,7  [22;7H[?12l[?25h[?25l[42;127H0[21;7H[?12l[?25h[?25l[42;126H69[20;7H[?12l[?25h[?25l[42;127H8[19;7H[?12l[?25h[?25l[42;127H7[18;7H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H5,7[16;7H[?12l[?25h[?25l[42;127H4[15;7H[?12l[?25h[?25l[42;127H3[14;7H[?12l[?25h[?25l[42;127H2[13;7H[?12l[?25h[?25l[42;127H1[12;7H[?12l[?25h[?25l[42;127H0,0-1[11;1H[?12l[?25h[?25l[42;126H59,7  [10;7H[?12l[?25h[?25l[42;127H8,6[9;6H[?12l[?25h[?25l[42;127H7,7[8;7H[?12l[?25h[?25l[42;127H6[7;7H[?12l[?25h[?25l[42;127H5[6;7H[?12l[?25h[?25l[3;29H[46m{[5;7H}[m[42;127H4[5;7H[?12l[?25h[?25l[3;29H{[5;7H}[42;127H3[4;7H[?12l[?25h[?25l[42;127H2[3;7H[?12l[?25h[?25l[42;127H1[2;7H[?12l[?25h[?25l[42;127H0[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hbutton_state=WAIT;[42;126H[K[42;126H49,7[10C97%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hswitch_count++;[42;126H[K[42;126H48,7[10C95%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(SET):[42;126H[K[42;126H47,7[10C93%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H} [93mbreak[m;[42;126H[K[42;126H46,7[10C91%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;9Hbutton_state=SET;[42;126H[K[42;126H45,7[10C89%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,7[10C87%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,7[10C85%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,7[10C83%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121menum[m button_state_type{NOTSET, SET, WAIT} button_state;[42;126H[K[42;126H41,7[10C81%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[96m//uses 3 state, state machne to make pushbutton code[m[42;126H[K[42;126H40,7[10C79%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#else[m[42;126H[K[42;126H39,6[10C77%[1;6H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mif[m (state == [95m0xF000[m) {switch_count++;}[42;126H[K[42;126H38,7[10C75%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3Hstate = (state << [95m1[m) | (! bit_is_clear(PIND, [95m1[m)) | [95m0xE000[m;[42;126H[K[42;126H37,7[10C73%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121muint16_t[m state = [95m0[m; [96m//holds present state[m[42;126H[K[42;126H36,7[10C71%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#ifdef DEBOUNCE [m[42;126H[K[42;126H35,7[10C69%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1HISR(TIMER0_COMP_vect){[42;126H[K[42;126H34,7[10C67%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H33,0-1[8C65%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H}[96m//spi_init[m[42;126H[K[42;126H32,7[10C63%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPSR=([95m1[m<<SPI2X); [96m//SPI at 2x speed (8 MHz)  [m[42;126H[K[42;126H31,7[10C61%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPCR=([95m1[m<<SPE) | ([95m1[m<<MSTR); [96m//enable SPI, clk low initially, rising edge sample[m[42;126H[K[42;126H30,7[10C59%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[96m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m[42;126H[K[42;126H29,7[10C57%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HDDRB |=  [95m0x07[m;  [96m//Turn on SS, MOSI, SCLK[m[42;126H[K[42;126H28,7[10C55%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvoid[m spi_init([38;5;121mvoid[m){[42;126H[K[42;126H27,7[10C53%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H26,7[10C51%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Initalizes the SPI port on the mega128. Does no further device specific inits[m[42;126H[K[42;126H25,7[10C48%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//                            spi_init                               [m[42;126H[K[42;126H24,7[10C46%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H23,7[10C44%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H22,0-1[8C42%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121muint8_t[m i;[27C[96m//just a dumb counter[m[42;126H[K[42;126H21,7[10C40%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvolatile[m [38;5;121muint16_t[m switch_count = [95m0[m;  [96m//count switch closures[m[42;126H[K[42;126H20,7[10C38%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mchar[m lcd_str[[95m16[m];[20C[96m//holds string to send to lcd[m[42;126H[K[42;126H19,7[10C36%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H18,0-1[8C34%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//#define DEBOUNCE[m[42;126H[K[42;126H17,7[10C32%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H16,0-1[8C30%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m"lcd_functions.h"[m[42;126H[K[42;126H15,7[10C28%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<stdlib.h>[m[42;126H[K[42;126H14,7[10C26%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<string.h>[m[42;126H[K[42;126H13,7[10C24%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<util/delay.h>[m[42;126H[K[42;126H12,7[10C22%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/interrupt.h>[m[42;126H[K[42;126H11,7[10C20%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/io.h>[m[42;126H[K[42;126H10,7[10C18%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H9,7[11C16%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//R. Traylor 12.16.2013[m[42;126H[K[42;126H8,7[11C14%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H7,0-1[9C12%[1;1H[?12l[?25h[?25l[42;126H8,7  [2;7H[?12l[?25h[?25l[42;126H9[3;7H[?12l[?25h[?25l[42;126H10,7[4;7H[?12l[?25h[?25l[42;127H1[5;7H[?12l[?25h[?25l[42;127H2[6;7H[?12l[?25h[?25l[42;127H3[7;7H[?12l[?25h[?25l[42;127H4[8;7H[?12l[?25h[?25l[42;127H5[9;7H[?12l[?25h[?25l[42;127H6,0-1[10;1H[?12l[?25h[?25l[42;127H7,7  [11;7H[?12l[?25h[?25l[42;127H8,0-1[12;1H[?12l[?25h[?25l[42;127H9,7  [13;7H[?12l[?25h[?25l[42;126H20[14;7H[?12l[?25h[?25l[42;127H1[15;7H[?12l[?25h[?25l[42;127H2,0-1[16;1H[?12l[?25h[?25l[42;127H3,7  [17;7H[?12l[?25h[?25l[42;127H4[18;7H[?12l[?25h[?25l[42;127H5[19;7H[?12l[?25h[?25l[42;127H6[20;7H[?12l[?25h[?25l[42;127H7[21;7H[?12l[?25h[?25l[42;127H8[22;7H[?12l[?25h[?25l[42;127H9[23;7H[?12l[?25h[?25l[42;126H30[24;7H[?12l[?25h[?25l[42;127H1[25;7H[?12l[?25h[?25l[42;127H2[26;7H[?12l[?25h[?25l[42;127H3,0-1[27;1H[?12l[?25h[?25l[42;127H4,7  [28;7H[?12l[?25h[?25l[42;127H5[29;7H[?12l[?25h[?25l[42;127H6[30;7H[?12l[?25h[?25l[42;127H7[31;7H[?12l[?25h[?25l[42;127H8[32;7H[?12l[?25h[?25l[42;127H9,6[33;6H[?12l[?25h[?25l[42;126H40,7[34;7H[?12l[?25h[?25l[42;127H1[35;7H[?12l[?25h[?25l[42;127H2[36;7H[?12l[?25h[?25l[42;127H3[37;7H[?12l[?25h[?25l[42;127H4[38;7H[?12l[?25h[?25l[42;127H5[39;7H[?12l[?25h[?25l[38;31H[46m{[40;7H}[m[42;127H6[40;7H[?12l[?25h[?25l[38;31H{[40;7H}[42;127H7[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hswitch_count++;[42;126H[K[42;126H48,7[10C14%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,7[10C16%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,7[10C18%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(WAIT):[42;126H[K[42;126H51,7[10C20%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[42;126H[K[42;126H52,7[10C22%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=NOTSET;[42;126H[K[42;126H53,7[10C24%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[39;29H[46m{[41;7H}[m[42;126H[K[42;126H54,7[10C26%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[38;29H{[40;7H}[41;7H[93mbreak[m;[42;126H[K[42;126H55,7[10C28%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mdefault[m: [93mbreak[m;[42;126H[K[42;126H56,7[10C30%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//switch                  [m[42;126H[K[42;126H57,7[10C32%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;81m#endif[m[42;126H[K[42;126H58,6[10C34%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//ISR[m[42;126H[K[42;126H59,7[10C36%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H60,0-1[8C38%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;121mint[m main([38;5;121mvoid[m){[42;126H[K[42;126H61,7[10C40%[41;7H[?12l[?25h[?25l[42;127H0,0-1[40;1H[?12l[?25h[?25l[42;126H59,7  [39;7H[?12l[?25h[?25l[42;127H8,6[38;6H[?12l[?25h[?25l[42;127H7,7[37;7H[?12l[?25h[?25l[42;127H6[36;7H[?12l[?25h[?25l[42;127H5[35;7H[?12l[?25h[?25l[32;29H[46m{[34;7H}[m[42;127H4[34;7H[?12l[?25h[?25l[32;29H{[34;7H}[42;127H3[33;7H[?12l[?25h[?25l[42;127H2[32;7H[?12l[?25h[?25l[42;127H1[31;7H[?12l[?25h[?25l[42;127H0[30;7H[?12l[?25h[?25l[42;126H49[29;7H[?12l[?25h[?25l[42;127H8[28;7H[?12l[?25h[?25l[42;127H7[27;7H[?12l[?25h[?25l[24;31H[46m{[26;7H}[m[42;127H6[26;7H[?12l[?25h[?25l[24;31H{[26;7H}[42;127H7[27;7H[?12l[?25h[?25l[42;127H8[28;7H[?12l[?25h[?25l[42;127H9[29;7H[?12l[?25h[?25l[42;126H50[30;7H[?12l[?25h[?25l[42;127H1[31;7H[?12l[?25h[?25l[42;127H2[32;7H[?12l[?25h[?25l[42;127H3[33;7H[?12l[?25h[?25l[32;29H[46m{[34;7H}[m[42;127H4[34;7H[?12l[?25h[?25l[32;29H{[34;7H}[42;127H5[35;7H[?12l[?25h[?25l[42;127H6[36;7H[?12l[?25h[?25l[42;127H7[37;7H[?12l[?25h[?25l[42;127H8,6[38;6H[?12l[?25h[?25l[42;127H9,7[39;7H[?12l[?25h[?25l[42;126H60,0-1[40;1H[?12l[?25h[?25l[42;127H1,7  [41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hspi_init();      [96m//initalize SPI [m[42;126H[K[42;126H62,7[10C42%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hlcd_init();      [96m//initalize LCD [m[42;126H[K[42;126H63,7[10C44%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hclear_display(); [96m//manually clear LCD display [m[42;126H[K[42;126H64,7[10C46%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hcursor_off();    [96m//keep LCD cursor off[m[42;126H[K[42;126H65,7[10C48%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H66,1[10C51%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[96m//TCNT0 running in CTC mode[m[42;126H[K[42;126H67,7[10C53%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m[42;126H[K[42;126H68,7[10C55%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m[42;126H[K[42;126H69,7[10C57%[41;7H[?12l[?25h[?25l[42;127H8[40;7H[?12l[?25h[?25l[42;127H7[39;7H[?12l[?25h[?25l[42;127H6,1[38;1H[?12l[?25h[?25l[42;127H5,7[37;7H[?12l[?25h[?25l[42;127H4[36;7H[?12l[?25h[?25l[42;127H3[35;7H[?12l[?25h[?25l[42;127H2[34;7H[?12l[?25h[?25l[42;127H1[33;7H[?12l[?25h[?25l[42;127H0,0-1[32;1H[?12l[?25h[?25l[42;126H59,7  [31;7H[?12l[?25h[?25l[42;127H8,6[30;6H[?12l[?25h[?25l[42;127H7,7[29;7H[?12l[?25h[?25l[42;127H6[28;7H[?12l[?25h[?25l[42;127H5[27;7H[?12l[?25h[?25l[24;29H[46m{[26;7H}[m[42;127H4[26;7H[?12l[?25h[?25l[24;29H{[26;7H}[42;127H3[25;7H[?12l[?25h[?25l[42;127H2[24;7H[?12l[?25h[?25l[42;127H1[23;7H[?12l[?25h[?25l[42;127H0[22;7H[?12l[?25h[?25l[42;126H49[21;7H[?12l[?25h[?25l[42;127H8[20;7H[?12l[?25h[?25l[42;127H7[19;7H[?12l[?25h[?25l[16;31H[46m{[18;7H}[m[42;127H6[18;7H[?12l[?25h[?25l[16;31H{[18;7H}[42;127H5[17;7H[?12l[?25h[?25l[42;127H4[16;7H[?12l[?25h[?25l[42;127H3[15;7H[?12l[?25h[?25l[42;127H2[14;7H[?12l[?25h[?25l[42;127H1[13;7H[?12l[?25h[?25l[42;127H0[12;7H[?12l[?25h[?25l[42;126H39,6[11;6H[?12l[?25h[?25l[42;127H8,7[10;7H[?12l[?25h[?25l[42;127H7[9;7H[?12l[?25h[?25l[42;127H6[8;7H[?12l[?25h[?25l[42;127H5[7;7H[?12l[?25h[?25l[42;127H4[6;7H[?12l[?25h[?25l[42;127H3,0-1[5;1H[?12l[?25h[?25l[42;127H2,7  [4;7H[?12l[?25h[?25l[42;127H1[3;7H[?12l[?25h[?25l[42;127H0[2;7H[?12l[?25h[?25l[42;126H29[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HDDRB |=  [95m0x07[m;  [96m//Turn on SS, MOSI, SCLK[m[42;126H[K[42;126H28,7[10C55%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvoid[m spi_init([38;5;121mvoid[m){[42;126H[K[42;126H27,7[10C53%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H26,7[10C51%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Initalizes the SPI port on the mega128. Does no further device specific inits[m[42;126H[K[42;126H25,7[10C48%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//                            spi_init                               [m[42;126H[K[42;126H24,7[10C46%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H23,7[10C44%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H22,0-1[8C42%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121muint8_t[m i;[27C[96m//just a dumb counter[m[42;126H[K[42;126H21,7[10C40%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvolatile[m [38;5;121muint16_t[m switch_count = [95m0[m;  [96m//count switch closures[m[42;126H[K[42;126H20,7[10C38%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mchar[m lcd_str[[95m16[m];[20C[96m//holds string to send to lcd[m[42;126H[K[42;126H19,7[10C36%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H18,0-1[8C34%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//#define DEBOUNCE[m[42;126H[K[42;126H17,7[10C32%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H16,0-1[8C30%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m"lcd_functions.h"[m[42;126H[K[42;126H15,7[10C28%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<stdlib.h>[m[42;126H[K[42;126H14,7[10C26%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<string.h>[m[42;126H[K[42;126H13,7[10C24%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<util/delay.h>[m[42;126H[K[42;126H12,7[10C22%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/interrupt.h>[m[42;126H[K[42;126H11,7[10C20%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/io.h>[m[42;126H[K[42;126H10,7[10C18%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H9,7[11C16%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//R. Traylor 12.16.2013[m[42;126H[K[42;126H8,7[11C14%[1;7H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H7,0-1[9C12%[1;1H[?12l[?25h[?25l[42;126H8,7  [2;7H[?12l[?25h[?25l[42;126H9[3;7H[?12l[?25h[?25l[42;126H10,7[4;7H[?12l[?25h[?25l[42;127H1[5;7H[?12l[?25h[?25l[42;127H2[6;7H[?12l[?25h[?25l[42;127H3[7;7H[?12l[?25h[?25l[42;127H4[8;7H[?12l[?25h[?25l[42;127H5[9;7H[?12l[?25h[?25l[42;127H6,0-1[10;1H[?12l[?25h[?25l[42;127H7,7  [11;7H[?12l[?25h[?25l[42;127H8,0-1[12;1H[?12l[?25h[?25l[42;127H9,7  [13;7H[?12l[?25h[?25l[42;126H20[14;7H[?12l[?25h[?25l[42;127H1[15;7H[?12l[?25h[?25l[42;127H2,0-1[16;1H[?12l[?25h[?25l[42;127H3,7  [17;7H[?12l[?25h[?25l[42;127H4[18;7H[?12l[?25h[?25l[42;127H5[19;7H[?12l[?25h[?25l[42;127H6[20;7H[?12l[?25h[?25l[42;127H7[21;7H[?12l[?25h[?25l[42;127H8[22;7H[?12l[?25h[?25l[42;127H9[23;7H[?12l[?25h[?25l[42;126H30[24;7H[?12l[?25h[?25l[42;127H1[25;7H[?12l[?25h[?25l[42;127H2[26;7H[?12l[?25h[?25l[42;127H3,0-1[27;1H[?12l[?25h[?25l[42;127H4,7  [28;7H[?12l[?25h[?25l[42;127H5[29;7H[?12l[?25h[?25l[42;127H6[30;7H[?12l[?25h[?25l[42;127H7[31;7H[?12l[?25h[?25l[42;127H8[32;7H[?12l[?25h[?25l[42;127H9,6[33;6H[?12l[?25h[?25l[42;126H40,7[34;7H[?12l[?25h[?25l[42;127H1[35;7H[?12l[?25h[?25l[42;127H2[36;7H[?12l[?25h[?25l[42;127H3[37;7H[?12l[?25h[?25l[42;127H4[38;7H[?12l[?25h[?25l[42;127H5[39;7H[?12l[?25h[?25l[38;31H[46m{[40;7H}[m[42;127H6[40;7H[?12l[?25h[?25l[38;31H{[40;7H}[42;127H7[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hswitch_count++;[42;126H[K[42;126H48,7[10C14%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,7[10C16%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,7[10C18%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(WAIT):[42;126H[K[42;126H51,7[10C20%[41;7H[?12l[?25h[?25l[42;127H0[40;7H[?12l[?25h[?25l[42;126H49[39;7H[?12l[?25h[?25l[42;127H8[38;7H[?12l[?25h[?25l[42;127H7[37;7H[?12l[?25h[?25l[34;31H[46m{[36;7H}[m[42;127H6[36;7H[?12l[?25h[?25l[34;31H{[36;7H}[42;127H5[35;7H[?12l[?25h[?25l[42;127H4[34;7H[?12l[?25h[?25l[42;127H3[33;7H[?12l[?25h[?25l[42;127H2[32;7H[?12l[?25h[?25l[42;127H3[33;7H[?12l[?25h[?25l[42;127H4[34;7H[?12l[?25h[?25l[42;127H5[35;7H[?12l[?25h[?25l[34;31H[46m{[36;7H}[m[42;127H6[36;7H[?12l[?25h[?25l[34;31H{[36;7H}[42;127H7[37;7H[?12l[?25h[?25l[42;127H8[38;7H[?12l[?25h[?25l[42;127H9[39;7H[?12l[?25h[?25l[42;126H50[40;7H[?12l[?25h[?25l[42;127H1[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[42;126H[K[42;126H52,7[10C22%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=NOTSET;[42;126H[K[42;126H53,7[10C24%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[39;29H[46m{[41;7H}[m[42;126H[K[42;126H54,7[10C26%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[38;29H{[40;7H}[41;7H[93mbreak[m;[42;126H[K[42;126H55,7[10C28%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mdefault[m: [93mbreak[m;[42;126H[K[42;126H56,7[10C30%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//switch                  [m[42;126H[K[42;126H57,7[10C32%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;81m#endif[m[42;126H[K[42;126H58,6[10C34%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//ISR[m[42;126H[K[42;126H59,7[10C36%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H60,0-1[8C38%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;121mint[m main([38;5;121mvoid[m){[42;126H[K[42;126H61,7[10C40%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hspi_init();      [96m//initalize SPI [m[42;126H[K[42;126H62,7[10C42%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hlcd_init();      [96m//initalize LCD [m[42;126H[K[42;126H63,7[10C44%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hclear_display(); [96m//manually clear LCD display [m[42;126H[K[42;126H64,7[10C46%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hcursor_off();    [96m//keep LCD cursor off[m[42;126H[K[42;126H65,7[10C48%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H66,1[10C51%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[96m//TCNT0 running in CTC mode[m[42;126H[K[42;126H67,7[10C53%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m[42;126H[K[42;126H68,7[10C55%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m[42;126H[K[42;126H69,7[10C57%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HOCR0  |= [95m0x01[m;[8C[96m//sample really, really fast [m[42;126H[K[42;126H70,7[10C59%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0  |= 0xFF;        //compare register set at 256[m[42;126H[K[42;126H71,7[10C61%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H72,0-1[8C63%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1HTCCR0 |= ([95m1[m<<CS00);[21C[96m//no prescaling[m[42;126H[K[42;126H73,7[10C65%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32[m[42;126H[K[42;126H74,7[10C67%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m[42;126H[K[42;126H75,7[10C69%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS01)|(1<<CS00); //prescale by 1024[m[42;126H[K[42;126H76,7[10C71%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H77,0-1[8C73%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//interrupt period = 62.5ns * (0CR0+1) * prescale[m[42;126H[K[42;126H78,7[10C75%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//0CR0=0xFF, prescale=1024   => period=32.7ms[m[42;126H[K[42;126H79,7[10C77%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m[42;126H[K[42;126H80,7[10C79%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H81,0-1[8C81%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hsei[46m()[m; [96m//enable global interrupts[m[42;126H[K[42;126H82,7[10C83%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[40;6H()[42;126H[K[42;126H83,0-1[8C85%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m[42;126H[K[42;126H84,7[10C87%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m[42;126H[K[42;126H85,7[10C89%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hitoa(switch_count, lcd_str, [95m10[m);[42;126H[K[42;126H86,7[10C91%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hstring2lcd(lcd_str);[42;126H[K[42;126H87,7[10C93%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hcursor_home();[42;126H[K[42;126H88,7[10C95%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//while[m[42;126H[K[42;126H89,7[10C97%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//main[m[42;126H[K[42;126H90,7[10CBot[41;7H[?12l[?25h[?25l[42;126H89[40;7H[?12l[?25h[?25l[42;127H8[39;7H[?12l[?25h[?25l[42;127H7[38;7H[?12l[?25h[?25l[42;127H6[37;7H[?12l[?25h[?25l[42;129H8[37;8H[?12l[?25h[?25la[46m([25C)[m[42;129H9[37;9H[?12l[?25h[?25l([25C)[42;129H10[37;10H[?12l[?25h[?25l[42;130H1[37;11H[?12l[?25h[?25l[42;130H2[37;12H[?12l[?25h[?25l[42;130H3[37;13H[?12l[?25h[?25l[42;130H4[37;14H[?12l[?25h[?25l[42;130H5[37;15H[?12l[?25h[?25l[42;130H6[37;16H[?12l[?25h[?25l[42;130H7[37;17H[?12l[?25h[?25l[42;130H8[37;18H[?12l[?25h[?25l[42;130H9[37;19H[?12l[?25h[?25l[42;129H20[37;20H[?12l[?25h[?25l[42;130H1[37;21H[?12l[?25h[?25l[42;130H2[37;22H[?12l[?25h[?25l[42;130H3[37;23H[?12l[?25h[?25l[42;130H4[37;24H[?12l[?25h[?25l[42;130H5[37;25H[?12l[?25h[?25l[42;130H6[37;26H[?12l[?25h[?25l[42;130H7[37;27H[?12l[?25h[?25l[42;130H8[37;28H[?12l[?25h[?25l[42;130H9[37;29H[?12l[?25h[?25l[42;129H30[37;30H[?12l[?25h[?25l[42;130H1[37;31H[?12l[?25h[?25l[42;130H2[37;32H[?12l[?25h[?25l[42;130H3[37;33H[?12l[?25h[?25l[42;130H4[37;34H[?12l[?25h[?25l[37;9H[46m([25C)[m[42;130H5[37;35H[?12l[?25h[?25l[37;9H([25C)[42;130H6[37;36H[?12l[?25h[?25l[42;127H7,24[38;24H[?12l[?25h[?25l[42;127H8,18[39;18H[?12l[?25h[?25l[42;127H9,11[40;11H[?12l[?25h[?25l[42;126H90,8 [41;8H[?12l[?25h[?25l[42;126H89,11[40;11H[?12l[?25h[?25l[42;127H8,18[39;18H[?12l[?25h[?25l[42;127H7,24[38;24H[?12l[?25h[?25l[42;127H6,36[37;36H[?12l[?25h[?25l[42;127H5[36;36H[?12l[?25h[?25l[42;127H4[35;36H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H2,35 [33;35H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,36 [31;36H[?12l[?25h[?25l[42;126H79[30;36H[?12l[?25h[?25l[42;127H8[29;36H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,36 [27;36H[?12l[?25h[?25l[42;127H5[26;36H[?12l[?25h[?25l[42;127H4[25;36H[?12l[?25h[?25l[42;127H5[26;36H[?12l[?25h[?25l[42;127H6[27;36H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H8,36 [29;36H[?12l[?25h[?25l[42;127H9[30;36H[?12l[?25h[?25l[42;126H80[31;36H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H2,35 [33;35H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,36 [31;36H[?12l[?25h[?25l[42;130H5[31;35H[?12l[?25h[?25l[42;130H4[31;34H[?12l[?25h[?25l[42;130H3[31;33H[?12l[?25h[?25l[42;130H2[31;32H[?12l[?25h[?25l[42;130H1[31;31H[?12l[?25h[?25l[42;130H0[31;30H[?12l[?25h[?25l[42;129H29[31;29H[?12l[?25h[?25l[42;130H8[31;28H[?12l[?25h[?25l[42;130H7[31;27H[?12l[?25h[?25l[42;130H6[31;26H[?12l[?25h[?25l[42;130H5[31;25H[?12l[?25h[?25l[42;130H4[31;24H[?12l[?25h[?25l[42;130H3[31;23H[?12l[?25h[?25l[42;130H2[31;22H[?12l[?25h[?25l[42;130H1[31;21H[?12l[?25h[?25l[42;130H0[31;20H[?12l[?25h[?25l[42;129H19[31;19H[?12l[?25h[?25l[42;130H8[31;18H[?12l[?25h[?25l[42;130H7[31;17H[?12l[?25h[?25l[42;130H6[31;16H[?12l[?25h[?25l[42;130H5[31;15H[?12l[?25h[?25l[42;130H4[31;14H[?12l[?25h[?25l[42;130H3[31;13H[?12l[?25h[?25l[42;130H2[31;12H[?12l[?25h[?25l[42;130H1[31;11H[?12l[?25h[?25l[42;130H0[31;10H[?12l[?25h[?25l[42;129H9 [31;9H[?12l[?25h[?25l[42;129H8[31;8H[?12l[?25h[?25l[42;129H7[31;7H[?12l[?25h[?25l[42;129H6[31;6H[?12l[?25h[?25l[42;129H5[31;5H[?12l[?25h[?25l[42;129H4[31;4H[?12l[?25h[?25l[42;129H3[31;3H[?12l[?25h[?25l[42;129H2[31;2H[?12l[?25h[?25l[42;129H1[31;1H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H2,1  [33;1H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,1  [31;1H[?12l[?25h[?25l[42;126H79[30;1H[?12l[?25h[?25l[42;126H80[31;1H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,1  [31;1H[?12l[?25h[?25l[42;126H79[30;1H[?12l[?25h[?25l[42;127H8[29;1H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,1  [27;1H[?12l[?25h[?25l[42;127H5[26;1H[?12l[?25h[?25l[42;127H4[25;1H[?12l[?25h[?25l[42;127H3[24;1H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,1  [22;1H[?12l[?25h[?25l[42;127H0[21;1H[?12l[?25h[?25l[42;126H69[20;1H[?12l[?25h[?25l[42;127H8[19;1H[?12l[?25h[?25l[42;127H7[18;1H[?12l[?25h[?25l[42;127H6[17;1H[?12l[?25h[?25l[42;127H5[16;1H[?12l[?25h[?25l[42;127H4[15;1H[?12l[?25h[?25l[42;127H3[14;1H[?12l[?25h[?25l[42;127H2[13;1H[?12l[?25h[?25l[42;127H1[12;1H[?12l[?25h[?25l[42;127H0,0-1[11;1H[?12l[?25h[?25l[42;126H59,1  [10;1H[?12l[?25h[?25l[42;127H8[9;1H[?12l[?25h[?25l[42;127H7[8;1H[?12l[?25h[?25l[42;127H6[7;1H[?12l[?25h[?25l[42;127H5[6;1H[?12l[?25h[?25l[42;127H4[5;1H[?12l[?25h[?25l[42;127H3[4;1H[?12l[?25h[?25l[42;127H2[3;1H[?12l[?25h[?25l[42;127H1[2;1H[?12l[?25h[?25l[42;127H0[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hbutton_state=WAIT;[42;126H[K[42;126H49,1[10C97%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hswitch_count++;[42;126H[K[42;126H48,1[10C95%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(SET):[42;126H[K[42;126H47,1[10C93%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H} [93mbreak[m;[42;126H[K[42;126H46,1[10C91%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;9Hbutton_state=SET;[42;126H[K[42;126H45,1[10C89%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,1[10C87%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,1[10C85%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,1[10C83%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121menum[m button_state_type{NOTSET, SET, WAIT} button_state;[42;126H[K[42;126H41,1[10C81%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[96m//uses 3 state, state machne to make pushbutton code[m[42;126H[K[42;126H40,1[10C79%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#else[m[42;126H[K[42;126H39,1[10C77%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mif[m (state == [95m0xF000[m) {switch_count++;}[42;126H[K[42;126H38,1[10C75%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3Hstate = (state << [95m1[m) | (! bit_is_clear(PIND, [95m1[m)) | [95m0xE000[m;[42;126H[K[42;126H37,1[10C73%[1;1H[?12l[?25h[?25l[42;127H8[2;1H[?12l[?25h[?25l[42;127H9[3;1H[?12l[?25h[?25l[42;126H40[4;1H[?12l[?25h[?25l[42;127H1[5;1H[?12l[?25h[?25l[42;127H2[6;1H[?12l[?25h[?25l[42;127H3[7;1H[?12l[?25h[?25l[42;129H2[7;2H[?12l[?25h[?25l[42;127H2[6;2H[?12l[?25h[?25l[42;129H3[6;3H[?12l[?25h[?25l[42;129H4[6;4H[?12l[?25h[?25l[42;129H5[6;5H[?12l[?25h[?25l[42;129H6[6;6H[?12l[?25h[?25l[42;129H7[6;7H[?12l[?25h[?25l[42;129H8[6;8H[?12l[?25h[?25l[1C[46m([12C)[m[42;129H9[6;9H[?12l[?25h[?25l([12C)[42;129H10[6;10H[?12l[?25h[?25l[42;130H1[6;11H[?12l[?25h[?25l[42;130H2[6;12H[?12l[?25h[?25l[42;130H3[6;13H[?12l[?25h[?25l[42;130H4[6;14H[?12l[?25h[?25l[42;130H5[6;15H[?12l[?25h[?25l[42;127H1[5;15H[?12l[?25h[?25l[42;127H0[4;15H[?12l[?25h[?25l[42;126H39,6 [3;6H[?12l[?25h[?25l[42;127H8,15[2;15H[?12l[?25h[?25l[42;127H7[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121muint16_t[m state = [95m0[m; [96m//holds present state[m[42;126H[K[42;126H36,15[9C71%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#ifdef DEBOUNCE [m[42;126H[K[42;126H35,15[9C69%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1HISR(TIMER0_COMP_vect){[42;126H[K[42;126H34,15[9C67%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H33,0-1[8C65%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H}[96m//spi_init[m[42;126H[K[42;126H32,11[9C63%[1;11H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPSR=([95m1[m<<SPI2X); [96m//SPI at 2x speed (8 MHz)  [m[42;126H[K[42;126H31,15[9C61%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPCR=([95m1[m<<SPE) | ([95m1[m<<MSTR); [96m//enable SPI, clk low initially, rising edge sample[m[42;126H[K[42;126H30,15[9C59%[1;15H[?12l[?25h[?25l[42;127H1[2;15H[?12l[?25h[?25l[42;127H2,11[3;11H[?12l[?25h[?25l[42;127H3,0-1[4;1H[?12l[?25h[?25l[42;127H4,15 [5;15H[?12l[?25h[?25l[42;127H5[6;15H[?12l[?25h[?25l[42;127H6[7;15H[?12l[?25h[?25l[42;127H7[8;15H[?12l[?25h[?25l[42;127H8[9;15H[?12l[?25h[?25l[42;127H9,6 [10;6H[?12l[?25h[?25l[42;126H40,15[11;15H[?12l[?25h[?25l[42;127H1[12;15H[?12l[?25h[?25l[42;127H0[11;15H[?12l[?25h[?25l[42;126H39,6 [10;6H[?12l[?25h[?25l[42;127H8,15[9;15H[?12l[?25h[?25l[42;127H7[8;15H[?12l[?25h[?25l[42;127H6[7;15H[?12l[?25h[?25l[42;127H5[6;15H[?12l[?25h[?25l[42;127H4[5;15H[?12l[?25h[?25l[42;127H3,0-1[4;1H[?12l[?25h[?25l[42;127H2,11 [3;11H[?12l[?25h[?25l[42;127H1,15[2;15H[?12l[?25h[?25l[42;127H0[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[96m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m[42;126H[K[42;126H29,15[9C57%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HDDRB |=  [95m0x07[m;  [96m//Turn on SS, MOSI, SCLK[m[42;126H[K[42;126H28,15[9C55%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvoid[m spi_init([38;5;121mvoid[m){[42;126H[K[42;126H27,15[9C53%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H26,15[9C51%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Initalizes the SPI port on the mega128. Does no further device specific inits[m[42;126H[K[42;126H25,15[9C48%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//                            spi_init                               [m[42;126H[K[42;126H24,15[9C46%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H23,15[9C44%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H22,0-1[8C42%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121muint8_t[m i;[27C[96m//just a dumb counter[m[42;126H[K[42;126H21,15[9C40%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvolatile[m [38;5;121muint16_t[m switch_count = [95m0[m;  [96m//count switch closures[m[42;126H[K[42;126H20,15[9C38%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mchar[m lcd_str[[95m16[m];[20C[96m//holds string to send to lcd[m[42;126H[K[42;126H19,15[9C36%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H18,0-1[8C34%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//#define DEBOUNCE[m[42;126H[K[42;126H17,15[9C32%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H16,0-1[8C30%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m"lcd_functions.h"[m[42;126H[K[42;126H15,15[9C28%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<stdlib.h>[m[42;126H[K[42;126H14,15[9C26%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<string.h>[m[42;126H[K[42;126H13,15[9C24%[1;15H[?12l[?25h[?25l[42;127H4[2;15H[?12l[?25h[?25l[42;127H5[3;15H[?12l[?25h[?25l[42;127H6,0-1[4;1H[?12l[?25h[?25l[42;127H7,15 [5;15H[?12l[?25h[?25l[42;127H8,0-1[6;1H[?12l[?25h[?25l[42;127H9,15 [7;15H[?12l[?25h[?25l[42;127H8,0-1[6;1H[?12l[?25h[?25l[42;127H7,15 [5;15H[?12l[?25h[?25l[42;127H6,0-1[4;1H[?12l[?25h[?25l[42;127H5,15 [3;15H[?12l[?25h[?25l[42;127H4[2;15H[?12l[?25h[?25l[42;127H3[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<util/delay.h>[m[42;126H[K[42;126H12,15[9C22%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/interrupt.h>[m[42;126H[K[42;126H11,15[9C20%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/io.h>[m[42;126H[K[42;126H10,15[9C18%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H9,15[10C16%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//R. Traylor 12.16.2013[m[42;126H[K[42;126H8,15[10C14%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H7,0-1[9C12%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Note the use of #ifdef statements[m[42;126H[K[42;126H6,15[10C10%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the sampling time and note any difference.[m[42;126H[K[42;126H5,15[11C8%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the buttons and see which is worst. They can vary alot.[m[42;126H[K[42;126H4,15[11C6%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H3,0-1[10C4%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//TCNT0 is used with 16mhz clock to vary the sampling period.[m[42;126H[K[42;126H2,15[11C2%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//This code shows how debouncing should and should not be done.[m[42;126H[K[42;126H1,15[10CTop[1;15H[?12l[?25h[?25l[42;126H2[2;15H[?12l[?25h[?25l[42;126H3,0-1[3;1H[?12l[?25h[?25l[42;126H4,15 [4;15H[?12l[?25h[?25l[42;126H5[5;15H[?12l[?25h[?25l[42;126H6[6;15H[?12l[?25h[?25l[42;126H7,0-1[7;1H[?12l[?25h[?25l[42;126H8,15 [8;15H[?12l[?25h[?25l[42;126H9[9;15H[?12l[?25h[?25l[42;126H10,15[10;15H[?12l[?25h[?25l[42;127H1[11;15H[?12l[?25h[?25l[42;127H2[12;15H[?12l[?25h[?25l[42;127H3[13;15H[?12l[?25h[?25l[42;127H4[14;15H[?12l[?25h[?25l[42;127H5[15;15H[?12l[?25h[?25l[42;127H6,0-1[16;1H[?12l[?25h[?25l[42;127H7,15 [17;15H[?12l[?25h[?25l[42;127H8,0-1[18;1H[?12l[?25h[?25l[42;127H9,15 [19;15H[?12l[?25h[?25l[42;126H20[20;15H[?12l[?25h[?25l[42;127H1[21;15H[?12l[?25h[?25l[42;127H2,0-1[22;1H[?12l[?25h[?25l[42;127H3,15 [23;15H[?12l[?25h[?25l[42;127H4[24;15H[?12l[?25h[?25l[42;127H5[25;15H[?12l[?25h[?25l[42;127H6[26;15H[?12l[?25h[?25l[42;127H7[27;15H[?12l[?25h[?25l[42;127H8[28;15H[?12l[?25h[?25l[42;127H9[29;15H[?12l[?25h[?25l[42;126H30[30;15H[?12l[?25h[?25l[42;127H1[31;15H[?12l[?25h[?25l[42;127H2,11[32;11H[?12l[?25h[?25l[42;127H3,0-1[33;1H[?12l[?25h[?25l[42;127H4,15 [34;15H[?12l[?25h[?25l[42;127H5[35;15H[?12l[?25h[?25l[42;127H6[36;15H[?12l[?25h[?25l[42;127H7[37;15H[?12l[?25h[?25l[42;127H8[38;15H[?12l[?25h[?25l[42;127H9,6 [39;6H[?12l[?25h[?25l[42;126H40,15[40;15H[?12l[?25h[?25l[42;127H1[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,15[10C2%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,15[10C4%[41;15H[?12l[?25h[?25l[42;127H2[40;15H[?12l[?25h[?25l[42;127H1[39;15H[?12l[?25h[?25l[42;127H2[40;15H[?12l[?25h[?25l[42;127H3[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,15[10C6%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=SET;[42;126H[K[42;126H45,15[10C8%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H} [93mbreak[m;[42;126H[K[42;126H46,14[9C10%[41;14H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(SET):[42;126H[K[42;126H47,15[9C12%[41;15H[?12l[?25h[?25l[42;127H6,14[40;14H[?12l[?25h[?25l[42;127H5,15[39;15H[?12l[?25h[?25l[42;127H4[38;15H[?12l[?25h[?25l[42;127H3[37;15H[?12l[?25h[?25l[42;127H2[36;15H[?12l[?25h[?25l[42;127H1[35;15H[?12l[?25h[?25l[42;127H0[34;15H[?12l[?25h[?25l[42;126H39,6 [33;6H[?12l[?25h[?25l[42;127H8,15[32;15H[?12l[?25h[?25l[42;127H7[31;15H[?12l[?25h[?25l[42;127H6[30;15H[?12l[?25h[?25l[42;127H7[31;15H[?12l[?25h[?25l[42;127H8[32;15H[?12l[?25h[?25l[42;127H9,6 [33;6H[?12l[?25h[?25l[42;126H40,15[34;15H[?12l[?25h[?25l[42;127H1[35;15H[?12l[?25h[?25l[42;127H2[36;15H[?12l[?25h[?25l[42;127H3[37;15H[?12l[?25h[?25l[42;127H4[38;15H[?12l[?25h[?25l[42;127H5[39;15H[?12l[?25h[?25l[42;127H6,14[40;14H[?12l[?25h[?25l[42;127H7,15[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hswitch_count++;[42;126H[K[42;126H48,15[9C14%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,15[9C16%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,12[9C18%[41;12H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(WAIT):[42;126H[K[42;126H51,15[9C20%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[42;126H[K[42;126H52,15[9C22%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=NOTSET;[42;126H[K[42;126H53,15[9C24%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H}[42;126H[K[42;126H54,8[10C26%[41;8H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H55,12[9C28%[41;12H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mdefault[m: [93mbreak[m;[42;126H[K[42;126H56,15[9C30%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//switch                  [m[42;126H[K[42;126H57,15[9C32%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;81m#endif[m[42;126H[K[42;126H58,6[10C34%[41;6H[?12l[?25h[?25l[42;127H7,15[40;15H[?12l[?25h[?25l[42;127H6[39;15H[?12l[?25h[?25l[42;127H5,12[38;12H[?12l[?25h[?25l[42;127H4,8 [37;8H[?12l[?25h[?25l[42;127H3,15[36;15H[?12l[?25h[?25l[42;127H2[35;15H[?12l[?25h[?25l[42;127H1[34;15H[?12l[?25h[?25l[42;127H0,12[33;12H[?12l[?25h[?25l[42;126H49,15[32;15H[?12l[?25h[?25l[42;127H8[31;15H[?12l[?25h[?25l[42;127H7[30;15H[?12l[?25h[?25l[42;127H6,14[29;14H[?12l[?25h[?25l[42;127H5,15[28;15H[?12l[?25h[?25l[42;127H4[27;15H[?12l[?25h[?25l[42;127H3[26;15H[?12l[?25h[?25l[42;127H2[25;15H[?12l[?25h[?25l[42;127H1[24;15H[?12l[?25h[?25l[42;127H0[23;15H[?12l[?25h[?25l[42;126H39,6 [22;6H[?12l[?25h[?25l[42;127H8,15[21;15H[?12l[?25h[?25l[42;127H7[20;15H[?12l[?25h[?25l[42;127H6[19;15H[?12l[?25h[?25l[42;127H5[18;15H[?12l[?25h[?25l[42;127H4[17;15H[?12l[?25h[?25l[42;127H3,0-1[16;1H[?12l[?25h[?25l[42;127H2,11 [15;11H[?12l[?25h[?25l[42;127H1,15[14;15H[?12l[?25h[?25l[42;127H0[13;15H[?12l[?25h[?25l[42;126H29[12;15H[?12l[?25h[?25l[42;127H8[11;15H[?12l[?25h[?25l[42;127H7[10;15H[?12l[?25h[?25l[42;127H6[9;15H[?12l[?25h[?25l[42;127H5[8;15H[?12l[?25h[?25l[42;127H4[7;15H[?12l[?25h[?25l[42;127H3[6;15H[?12l[?25h[?25l[42;127H2,0-1[5;1H[?12l[?25h[?25l[42;127H1,15 [4;15H[?12l[?25h[?25l[42;127H0[3;15H[?12l[?25h[?25l[42;126H19[2;15H[?12l[?25h[?25l[42;127H8,0-1[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//#define DEBOUNCE[m[42;126H[K[42;126H17,15[9C32%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H16,0-1[8C30%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m"lcd_functions.h"[m[42;126H[K[42;126H15,15[9C28%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<stdlib.h>[m[42;126H[K[42;126H14,15[9C26%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<string.h>[m[42;126H[K[42;126H13,15[9C24%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<util/delay.h>[m[42;126H[K[42;126H12,15[9C22%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/interrupt.h>[m[42;126H[K[42;126H11,15[9C20%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/io.h>[m[42;126H[K[42;126H10,15[9C18%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H9,15[10C16%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//R. Traylor 12.16.2013[m[42;126H[K[42;126H8,15[10C14%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H7,0-1[9C12%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Note the use of #ifdef statements[m[42;126H[K[42;126H6,15[10C10%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the sampling time and note any difference.[m[42;126H[K[42;126H5,15[11C8%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the buttons and see which is worst. They can vary alot.[m[42;126H[K[42;126H4,15[11C6%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H3,0-1[10C4%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//TCNT0 is used with 16mhz clock to vary the sampling period.[m[42;126H[K[42;126H2,15[11C2%[1;15H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//This code shows how debouncing should and should not be done.[m[42;126H[K[42;126H1,15[10CTop[1;15H[?12l[?25h[?25l[42;126H2[2;15H[?12l[?25h[?25l[42;126H3,0-1[3;1H[?12l[?25h[?25l[42;126H4,15 [4;15H[?12l[?25h[?25l[42;126H5[5;15H[?12l[?25h[?25l[42;126H6[6;15H[?12l[?25h[?25l[42;126H7,0-1[7;1H[?12l[?25h[?25l[42;126H8,15 [8;15H[?12l[?25h[?25l[42;126H9[9;15H[?12l[?25h[?25l[42;126H10,15[10;15H[?12l[?25h[?25l[42;127H1[11;15H[?12l[?25h[?25l[42;127H2[12;15H[?12l[?25h[?25l[42;127H3[13;15H[?12l[?25h[?25l[42;127H4[14;15H[?12l[?25h[?25l[42;127H5[15;15H[?12l[?25h[?25l[42;127H6,0-1[16;1H[?12l[?25h[?25l[42;127H7,15 [17;15H[?12l[?25h[?25l[42;127H8,0-1[18;1H[?12l[?25h[?25l[42;127H9,15 [19;15H[?12l[?25h[?25l[42;126H20[20;15H[?12l[?25h[?25l[42;127H1[21;15H[?12l[?25h[?25l[42;127H2,0-1[22;1H[?12l[?25h[?25l[42;127H3,15 [23;15H[?12l[?25h[?25l[42;127H4[24;15H[?12l[?25h[?25l[42;127H5[25;15H[?12l[?25h[?25l[42;127H6[26;15H[?12l[?25h[?25l[42;127H7[27;15H[?12l[?25h[?25l[42;127H8[28;15H[?12l[?25h[?25l[42;127H9[29;15H[?12l[?25h[?25l[42;126H30[30;15H[?12l[?25h[?25l[42;127H1[31;15H[?12l[?25h[?25l[42;127H2,11[32;11H[?12l[?25h[?25l[42;127H3,0-1[33;1H[?12l[?25h[?25l[42;127H4,15 [34;15H[?12l[?25h[?25l[42;127H5[35;15H[?12l[?25h[?25l[42;127H6[36;15H[?12l[?25h[?25l[42;127H7[37;15H[?12l[?25h[?25l[42;127H8[38;15H[?12l[?25h[?25l[42;127H9,6 [39;6H[?12l[?25h[?25l[42;126H40,15[40;15H[?12l[?25h[?25l[42;127H1[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,15[10C2%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,15[10C4%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,15[10C6%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=SET;[42;126H[K[42;126H45,15[10C8%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H} [93mbreak[m;[42;126H[K[42;126H46,14[9C10%[41;14H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(SET):[42;126H[K[42;126H47,15[9C12%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hswitch_count++;[42;126H[K[42;126H48,15[9C14%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,15[9C16%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,12[9C18%[41;12H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(WAIT):[42;126H[K[42;126H51,15[9C20%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[42;126H[K[42;126H52,15[9C22%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=NOTSET;[42;126H[K[42;126H53,15[9C24%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H}[42;126H[K[42;126H54,8[10C26%[41;8H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H55,12[9C28%[41;12H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mdefault[m: [93mbreak[m;[42;126H[K[42;126H56,15[9C30%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//switch                  [m[42;126H[K[42;126H57,15[9C32%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;81m#endif[m[42;126H[K[42;126H58,6[10C34%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//ISR[m[42;126H[K[42;126H59,7[10C36%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H60,0-1[8C38%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;121mint[m main([38;5;121mvoid[m){[42;126H[K[42;126H61,15[9C40%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hspi_init();      [96m//initalize SPI [m[42;126H[K[42;126H62,15[9C42%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hlcd_init();      [96m//initalize LCD [m[42;126H[K[42;126H63,15[9C44%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hclear_display(); [96m//manually clear LCD display [m[42;126H[K[42;126H64,15[9C46%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hcursor_off();    [96m//keep LCD cursor off[m[42;126H[K[42;126H65,15[9C48%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H66,1[10C51%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[96m//TCNT0 running in CTC mode[m[42;126H[K[42;126H67,15[9C53%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m[42;126H[K[42;126H68,15[9C55%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m[42;126H[K[42;126H69,15[9C57%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HOCR0  |= [95m0x01[m;[8C[96m//sample really, really fast [m[42;126H[K[42;126H70,15[9C59%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0  |= 0xFF;        //compare register set at 256[m[42;126H[K[42;126H71,15[9C61%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H72,0-1[8C63%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1HTCCR0 |= ([95m1[m<<CS00);[21C[96m//no prescaling[m[42;126H[K[42;126H73,15[9C65%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32[m[42;126H[K[42;126H74,15[9C67%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m[42;126H[K[42;126H75,15[9C69%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS01)|(1<<CS00); //prescale by 1024[m[42;126H[K[42;126H76,15[9C71%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H77,0-1[8C73%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//interrupt period = 62.5ns * (0CR0+1) * prescale[m[42;126H[K[42;126H78,15[9C75%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//0CR0=0xFF, prescale=1024   => period=32.7ms[m[42;126H[K[42;126H79,15[9C77%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m[42;126H[K[42;126H80,15[9C79%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H81,0-1[8C81%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hsei(); [96m//enable global interrupts[m[42;126H[K[42;126H82,15[9C83%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H83,0-1[8C85%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m[42;126H[K[42;126H84,15[9C87%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m[42;126H[K[42;126H85,15[9C89%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hitoa(switch_count, lcd_str, [95m10[m);[42;126H[K[42;126H86,15[9C91%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hstring2lcd[46m([mlcd_str[46m)[m;[42;126H[K[42;126H87,15[9C93%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[40;15H([7C)
    cursor_home();[42;126H[K[42;126H88,15[9C95%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//while[m[42;126H[K[42;126H89,11[9C97%[41;11H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//main[m[42;126H[K[42;126H90,8[10CBot[41;8H[?12l[?25h[?25l[42;126H89,11[40;11H[?12l[?25h[?25l[42;127H8,15[39;15H[?12l[?25h[?25l[38;15H[46m([7C)[m[42;127H7[38;15H[?12l[?25h[?25l([7C)[42;127H6[37;15H[?12l[?25h[?25l[42;127H5[36;15H[?12l[?25h[?25l[42;127H4[35;15H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H2,15 [33;15H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,15 [31;15H[?12l[?25h[?25l[42;126H79[30;15H[?12l[?25h[?25l[42;127H8[29;15H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,15 [27;15H[?12l[?25h[?25l[42;127H5[26;15H[?12l[?25h[?25l[42;127H4[25;15H[?12l[?25h[?25l[42;127H3[24;15H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,15 [22;15H[?12l[?25h[?25l[42;127H0[21;15H[?12l[?25h[?25l[42;126H69[20;15H[?12l[?25h[?25l[42;127H8[19;15H[?12l[?25h[?25l[42;127H7[18;15H[?12l[?25h[?25l[42;127H8[19;15H[?12l[?25h[?25l[42;127H9[20;15H[?12l[?25h[?25l[42;126H70[21;15H[?12l[?25h[?25l[42;126H69[20;15H[?12l[?25h[?25l[42;130H4[20;14H[?12l[?25h[?25l[42;130H3[20;13H[?12l[?25h[?25l[46m([8C)[m[42;130H2[20;12H[?12l[?25h[?25l([8C)[42;130H1[20;11H[?12l[?25h[?25l[42;130H0[20;10H[?12l[?25h[?25l[42;130H1[20;11H[?12l[?25h[?25l [46m([8C)[m[42;130H2[20;12H[?12l[?25h[?25l([8C)[42;130H3[20;13H[?12l[?25h[?25l[42;126H70[21;13H[?12l[?25h[?25l[42;127H1[22;13H[?12l[?25h[?25l[42;130H2[22;12H[?12l[?25h[?25l[42;130H1[22;11H[?12l[?25h[?25l[42;130H0[22;10H[?12l[?25h[?25l[42;129H9 [22;9H[?12l[?25h[?25l[42;129H8[22;8H[?12l[?25h[?25l[42;129H7[22;7H[?12l[?25h[?25l[42;129H6[22;6H[?12l[?25h[?25l[42;129H5[22;5H[?12l[?25h[?25l[42;129H4[22;4H[?12l[?25h[?25l[42;129H3[22;3H[?12l[?25h[?25l[42;129H2[22;2H[?12l[?25h[?25l[42;129H1[22;1H[?12l[?25h[?25l[42;127H0[21;1H[?12l[?25h[?25l[42;126H[K[42;1H/[?12l[?25h/[?25l[?12l[?25h[?25l[42;2H[K[42;2H[?12l[?25h [?25l[124C70,1[10CBot[21;1H[?12l[?25h[?25l[42;126H69,47[20;47H[?12l[?25h[?25l[42;130H6[20;46H[?12l[?25h[?25l[42;130H5[20;45H[?12l[?25h[?25l[42;130H4[20;44H[?12l[?25h[?25l[42;130H3[20;43H[?12l[?25h[?25l[42;130H2[20;42H[?12l[?25h[?25l[42;130H1[20;41H[?12l[?25h[?25l[42;130H0[20;40H[?12l[?25h[?25l[42;129H39[20;39H[?12l[?25h[?25l[42;130H8[20;38H[?12l[?25h[?25l[42;130H7[20;37H[?12l[?25h[?25l[42;130H6[20;36H[?12l[?25h[?25l[42;130H5[20;35H[?12l[?25h[?25l[42;130H4[20;34H[?12l[?25h[?25l[42;130H3[20;33H[?12l[?25h[?25l[42;130H2[20;32H[?12l[?25h[?25l[42;130H1[20;31H[?12l[?25h[?25l[42;130H0[20;30H[?12l[?25h[?25l[42;129H29[20;29H[?12l[?25h[?25l[42;130H8[20;28H[?12l[?25h[?25l[42;130H7[20;27H[?12l[?25h[?25l[42;130H6[20;26H[?12l[?25h[?25l[42;130H5[20;25H[?12l[?25h[?25l[42;130H4[20;24H[?12l[?25h[?25l[42;130H3[20;23H[?12l[?25h[?25l[42;130H2[20;22H[?12l[?25h[?25l[20;12H[46m([8C)[m[42;130H1[20;21H[?12l[?25h[?25l[20;12H([8C)[42;130H0[20;20H[?12l[?25h[?25l[42;129H19[20;19H[?12l[?25h[?25l[42;130H8[20;18H[?12l[?25h[?25l[42;130H7[20;17H[?12l[?25h[?25l[42;130H6[20;16H[?12l[?25h[?25l[42;130H5[20;15H[?12l[?25h[?25l[42;130H4[20;14H[?12l[?25h[?25l[42;130H3[20;13H[?12l[?25h[?25l[46m([8C)[m[42;130H2[20;12H[?12l[?25h[?25l([8C)[42;130H1[20;11H[?12l[?25h[?25l[42;130H0[20;10H[?12l[?25h[?25l[42;129H9 [20;9H[?12l[?25h[?25l[42;129H8[20;8H[?12l[?25h[?25l[42;129H7[20;7H[?12l[?25h[?25l[42;129H6[20;6H[?12l[?25h[?25l[42;129H5[20;5H[?12l[?25h[?25l[42;129H4[20;4H[?12l[?25h[?25l[42;129H3[20;3H[?12l[?25h[?25l[42;129H2[20;2H[?12l[?25h[?25l[42;129H1[20;1H[?12l[?25h[?25l[42;126H70[21;1H[?12l[?25h[?25l[42;1H[1m-- INSERT --[m[42;126H[K[42;126H70,1[10CBot[21;1H[?12l[?25h[?25l/  OCR0  |= [95m0x01[m;[7C [1C[96m/sample really, really fast [m[42;129H2]2;switch_example.c + (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c[21;2H[?12l[?25h[?25l[96m//  OCR0  |= 0x01;        //sample really, really fast [m[42;129H3[21;3H[?12l[?25h[?25l[42;129H2[21;2H[?12l[?25h[?25l[42;127H1[22;2H[?12l[?25h[?25l/OCR0  |= [95m0xFF[m;        [96m//compare register set at 256[m[22;53H[K[42;129H1[22;1H[?12l[?25h[?25l[21;41r[41;1H
[1;42r[21;1H[96m//  OCR0  |= 0x01;        //sample really, really fast /OCR0  |= 0xFF;        //compare register set at 256[m[41;1H[94m~                                                                                                                                              [m[42;126H[K[42;126H70,56[9CBot[21;56H[?12l[?25h[?25l[22;41r[22;1H[L[1;42r[21;56H[K[22;1H/OCR0  |= [95m0xFF[m;[8C[96m//compare register set at 256[m[42;126H[K[42;126H71,1[10CBot[22;1H[?12l[?25h[?25lOCR0  |= [95m0xF[m[1C; [7C[96m//compare register set at 256[m[22;52H[K[22;1H[?12l[?25h[?25l        OCR0  |= [95m0xFF[m;        [96m//compare register set at 256[m[42;129H2-9[22;9H[?12l[?25h[?25lOCR0  |= [95m0xFF[m;        [96m//compare register set at 256[m[22;52H[K[42;129H1  [22;1H[?12l[?25h[?25l OCR0  |= [95m0xFF[m;[7C [1C[96m/compare register set at 256[m[42;129H2[22;2H[?12l[?25h[?25l OCR0  |= [95m0xFF[m;[7C [1C[96m/compare register set at 256[m[42;129H3[22;3H[?12l[?25h[?25l[42;127H2,1[23;1H[?12l[?25h[?25l[42;127H3,3[24;3H[?12l[?25h[?25l[42;127H4[25;3H[?12l[?25h[?25l[42;127H5[26;3H[?12l[?25h[?25l[42;127H6[27;3H[?12l[?25h[?25l[42;127H7,1[28;1H[?12l[?25h[?25l[42;127H6,3[27;3H[?12l[?25h[?25l[42;129H2[27;2H[?12l[?25h[?25l[42;129H1[27;1H[?12l[?25h[?25li[1C[96m/TCCR0 |= (1<<CS02)|(1<<CS01)|(1<<CS00); //prescale by 1024[m[42;129H2[27;2H[?12l[?25h[?25l/TCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [96m//prescale by 1024[m[27;61H[K[27;2H[?12l[?25h[?25lTCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [96m//prescale by 1024[m[27;60H[K[27;2H[?12l[?25h[?25lTCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [96m//prescale by 1024[m[27;59H[K[42;129H1[27;1H[?12l[?25h[?25l TCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [1C[96m/prescale by 1024[m[42;129H2[27;2H[?12l[?25h[?25l TCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [1C[96m/prescale by 1024[m[42;129H3[27;3H[?12l[?25h[?25l[42;129H2[27;2H[?12l[?25h[?25l[42;127H5[26;2H[?12l[?25h[?25l[42;127H4[25;2H[?12l[?25h[?25l[42;129H1[25;1H[?12l[?25h[?25l[42;127H3[24;1H[?12l[?25h[?25l/TCCR0 |= ([95m1[m<<CS00);[20C [1C[96m/no prescaling[m[42;129H2[24;2H[?12l[?25h[?25l[96m//TCCR0 |= (1<<CS00);                     //no prescaling[m[42;129H3[24;3H[?12l[?25h[42;1H[K[24;2H[?25l[42;126H73,2[10CBot[24;2H[?12l[?25h[?25l[42;126H[K[42;1H:[?12l[?25hw[?25l[?12l[?25h[?25l"switch_example.c" 90L, 3004C written[88C73,2[10CBot]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c[42;126H[K[42;126H73,2[10CBot[24;2H[?12l[?25h[?25l[42;1H[K[42;1H:[?12l[?25h![?25l[?12l[?25hm[?25l[?12l[?25ha[?25l[?12l[?25hk[?25l[?12l[?25he[?25l[?12l[?25h[?25l:!make[?1l>[?12l[?25h[?1049l
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL   -c -o switch_example.o switch_example.c
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL -Wl,-Map,switch_example.map -o switch_example.elf switch_example.o lcd_functions.o 
avr-objdump -h -S switch_example.elf > switch_example.lst
avr-objcopy -j .text -j .data -O ihex switch_example.elf switch_example.hex
avr-objcopy -j .text -j .data -O binary switch_example.elf switch_example.bin
avr-objcopy -j .text -j .data -O srec switch_example.elf switch_example.srec
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O ihex switch_example.elf switch_example_eeprom.hex \
|| { echo empty switch_example_eeprom.hex not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O binary switch_example.elf switch_example_eeprom.bin \
|| { echo empty switch_example_eeprom.bin not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O srec switch_example.elf switch_example_eeprom.srec \
|| { echo empty switch_example_eeprom.srec not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c
Press ENTER or type command to continue[?1049h[?1h=[27m[23m[m[H[2J[?25l[1;7H[93mbreak[m;
    [93mcase[m(WAIT):[3;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[4;9Hbutton_state=NOTSET;[5;7H}[6;7H[93mbreak[m;
    [93mdefault[m: [93mbreak[m;
  } [96m//switch                  [m
[38;5;81m#endif[m
} [96m//ISR[m

[38;5;121mint[m main([38;5;121mvoid[m){
  spi_init();      [96m//initalize SPI [m
  lcd_init();      [96m//initalize LCD [m
  clear_display(); [96m//manually clear LCD display [m
  cursor_off();    [96m//keep LCD cursor off

[m  [96m//TCNT0 running in CTC mode[m
  TIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m
  TCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale
//  OCR0  |= 0x01;        //sample really, really fast [m
  OCR0  |= [95m0xFF[m;[8C[96m//compare register set at 256

//TCCR0 |= (1<<CS00);                     //no prescaling
//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32
//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m
  TCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [96m//prescale by 1024

//interrupt period = 62.5ns * (0CR0+1) * prescale
//0CR0=0xFF, prescale=1024   => period=32.7ms
//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m

  sei(); [96m//enable global interrupts[m

  [93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m
    [93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m
    itoa(switch_count, lcd_str, [95m10[m);
    string2lcd(lcd_str);
    cursor_home();
  } [96m//while[m
} [96m//main[m[42;126H73,2[10CBot[24;2H[?12l[?25h[?25l[42;126H[K[42;1H:[?12l[?25h![?25l[?12l[?25hm[?25l[?12l[?25ha[?25l[?12l[?25hk[?25l[?12l[?25he[?25l[?12l[?25h[?25l [?12l[?25hp[?25l[?12l[?25hr[?25l[?12l[?25ho[?25l[?12l[?25hg[?25l[?12l[?25hr[?25l[?12l[?25ha[?25l[?12l[?25hm[?25l[?12l[?25h[?25l[14C[?1l>[?12l[?25h[?1049l
avrdude -p m128 -c usbasp -e -U flash:w:switch_example.hex \
                                                     -U eeprom:w:switch_example_eeprom.hex

avrdude: warning: cannot set sck period. please check for usbasp firmware update.
avrdude: AVR device initialized and ready to accept instructions

Reading |                                                    | 0% 0.00sReading | #################                                  | 33% 0.00sReading | #################################                  | 66% 0.00sReading | ################################################## | 100% 0.00s

avrdude: Device signature = 0x1e9702 (probably m128)
avrdude: erasing chip
avrdude: warning: cannot set sck period. please check for usbasp firmware update.
avrdude: reading input file "switch_example.hex"
avrdude: input file switch_example.hex auto detected as Intel Hex
avrdude: writing flash (1252 bytes):

Writing |                                                    | 0% 0.00sWriting | ##########                                         | 20% 0.14sWriting | ####################                               | 40% 0.29sWriting | ##############################                     | 60% 0.43sWriting | ########################################           | 80% 0.57sWriting | ################################################## | 100% 0.72s

avrdude: 1252 bytes of flash written
avrdude: verifying flash memory against switch_example.hex:
avrdude: load data flash data from input file switch_example.hex:
avrdude: input file switch_example.hex auto detected as Intel Hex
avrdude: input file switch_example.hex contains 1252 bytes
avrdude: reading on-chip flash data:

Reading |                                                    | 0% 0.00sReading | ##########                                         | 20% 0.13sReading | ####################                               | 40% 0.26sReading | ##############################                     | 60% 0.39sReading | ########################################           | 80% 0.52sReading | ################################################## | 100% 0.65s

avrdude: verifying ...
avrdude: 1252 bytes of flash verified
avrdude: reading input file "switch_example_eeprom.hex"
avrdude: input file switch_example_eeprom.hex auto detected as Intel Hex
avrdude: writing eeprom (0 bytes):

Writing |                                                    | 0% 0.00sWriting | ################################################## | 100% 0.00s

avrdude: 0 bytes of eeprom written
avrdude: verifying eeprom memory against switch_example_eeprom.hex:
avrdude: load data eeprom data from input file switch_example_eeprom.hex:
avrdude: input file switch_example_eeprom.hex auto detected as Intel Hex
avrdude: input file switch_example_eeprom.hex contains 0 bytes
avrdude: reading on-chip eeprom data:

Reading |                                                    | 0% 0.00sReading | ################################################## | 100% 0.00s

avrdude: verifying ...
avrdude: 0 bytes of eeprom verified

avrdude: safemode: Fuses OK (E:FF, H:CF, L:EF)

avrdude done.  Thank you.

]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c
Press ENTER or type command to continue[?1049h[?1h=[27m[23m[m[H[2J[?25l[1;7H[93mbreak[m;
    [93mcase[m(WAIT):[3;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[4;9Hbutton_state=NOTSET;[5;7H}[6;7H[93mbreak[m;
    [93mdefault[m: [93mbreak[m;
  } [96m//switch                  [m
[38;5;81m#endif[m
} [96m//ISR[m

[38;5;121mint[m main([38;5;121mvoid[m){
  spi_init();      [96m//initalize SPI [m
  lcd_init();      [96m//initalize LCD [m
  clear_display(); [96m//manually clear LCD display [m
  cursor_off();    [96m//keep LCD cursor off

[m  [96m//TCNT0 running in CTC mode[m
  TIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m
  TCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale
//  OCR0  |= 0x01;        //sample really, really fast [m
  OCR0  |= [95m0xFF[m;[8C[96m//compare register set at 256

//TCCR0 |= (1<<CS00);                     //no prescaling
//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32
//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m
  TCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [96m//prescale by 1024

//interrupt period = 62.5ns * (0CR0+1) * prescale
//0CR0=0xFF, prescale=1024   => period=32.7ms
//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m

  sei(); [96m//enable global interrupts[m

  [93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m
    [93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m
    itoa(switch_count, lcd_str, [95m10[m);
    string2lcd(lcd_str);
    cursor_home();
  } [96m//while[m
} [96m//main[m[42;126H73,2[10CBot[24;2H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,2  [22;2H[?12l[?25h[?25l[42;127H0[21;2H[?12l[?25h[?25l[42;126H69[20;2H[?12l[?25h[?25l[42;127H8[19;2H[?12l[?25h[?25l[42;127H7[18;2H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H5,2[16;2H[?12l[?25h[?25l[42;127H4[15;2H[?12l[?25h[?25l[42;127H3[14;2H[?12l[?25h[?25l[42;127H2[13;2H[?12l[?25h[?25l[42;127H1[12;2H[?12l[?25h[?25l[42;127H2[13;2H[?12l[?25h[?25l[42;127H3[14;2H[?12l[?25h[?25l[42;127H4[15;2H[?12l[?25h[?25l[42;127H5[16;2H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H7,2[18;2H[?12l[?25h[?25l[42;127H8[19;2H[?12l[?25h[?25l[42;127H9[20;2H[?12l[?25h[?25l[42;126H70[21;2H[?12l[?25h[?25l[42;127H1[22;2H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H3,2  [24;2H[?12l[?25h[?25l[42;127H4[25;2H[?12l[?25h[?25l[42;127H5[26;2H[?12l[?25h[?25l[42;127H6[27;2H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H8,2  [29;2H[?12l[?25h[?25l[42;127H9[30;2H[?12l[?25h[?25l[42;126H80[31;2H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H2,2  [33;2H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H4,2  [35;2H[?12l[?25h[?25l[42;127H5[36;2H[?12l[?25h[?25l[42;127H6[37;2H[?12l[?25h[?25l[42;127H7[38;2H[?12l[?25h[?25l[42;127H8[39;2H[?12l[?25h[?25l[42;127H9[40;2H[?12l[?25h[?25l[42;126H90[41;2H[?12l[?25h[?25l[42;126H89[40;2H[?12l[?25h[?25l[42;127H8[39;2H[?12l[?25h[?25l[42;127H7[38;2H[?12l[?25h[?25l[42;127H6[37;2H[?12l[?25h[?25l[42;127H5[36;2H[?12l[?25h[?25l[42;127H4[35;2H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H2,2  [33;2H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,2  [31;2H[?12l[?25h[?25l[42;126H79[30;2H[?12l[?25h[?25l[42;127H8[29;2H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,2  [27;2H[?12l[?25h[?25l[42;127H5[26;2H[?12l[?25h[?25l[42;127H4[25;2H[?12l[?25h[?25l[42;127H3[24;2H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,2  [22;2H[?12l[?25h[?25l[42;127H0[21;2H[?12l[?25h[?25l[42;126H69[20;2H[?12l[?25h[?25l[42;127H8[19;2H[?12l[?25h[?25l[42;127H7[18;2H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H5,2[16;2H[?12l[?25h[?25l[42;127H4[15;2H[?12l[?25h[?25l[42;127H3[14;2H[?12l[?25h[?25l[42;127H2[13;2H[?12l[?25h[?25l[42;127H1[12;2H[?12l[?25h[?25l[42;127H0,0-1[11;1H[?12l[?25h[?25l[42;126H59,2  [10;2H[?12l[?25h[?25l[42;127H8[9;2H[?12l[?25h[?25l[42;127H7[8;2H[?12l[?25h[?25l[42;127H6[7;2H[?12l[?25h[?25l[42;127H5[6;2H[?12l[?25h[?25l[42;127H4[5;2H[?12l[?25h[?25l[42;127H3[4;2H[?12l[?25h[?25l[42;127H2[3;2H[?12l[?25h[?25l[42;127H1[2;2H[?12l[?25h[?25l[42;127H0[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hbutton_state=WAIT;[42;126H[K[42;126H49,2[10C97%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hswitch_count++;[42;126H[K[42;126H48,2[10C95%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(SET):[42;126H[K[42;126H47,2[10C93%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H} [93mbreak[m;[42;126H[K[42;126H46,2[10C91%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;9Hbutton_state=SET;[42;126H[K[42;126H45,2[10C89%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,2[10C87%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,2[10C85%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,2[10C83%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121menum[m button_state_type{NOTSET, SET, WAIT} button_state;[42;126H[K[42;126H41,2[10C81%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[96m//uses 3 state, state machne to make pushbutton code[m[42;126H[K[42;126H40,2[10C79%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#else[m[42;126H[K[42;126H39,2[10C77%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mif[m (state == [95m0xF000[m) {switch_count++;}[42;126H[K[42;126H38,2[10C75%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3Hstate = (state << [95m1[m) | (! bit_is_clear(PIND, [95m1[m)) | [95m0xE000[m;[42;126H[K[42;126H37,2[10C73%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121muint16_t[m state = [95m0[m; [96m//holds present state[m[42;126H[K[42;126H36,2[10C71%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#ifdef DEBOUNCE [m[42;126H[K[42;126H35,2[10C69%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1HISR(TIMER0_COMP_vect){[42;126H[K[42;126H34,2[10C67%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H33,0-1[8C65%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H}[96m//spi_init[m[42;126H[K[42;126H32,2[10C63%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPSR=([95m1[m<<SPI2X); [96m//SPI at 2x speed (8 MHz)  [m[42;126H[K[42;126H31,2[10C61%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPCR=([95m1[m<<SPE) | ([95m1[m<<MSTR); [96m//enable SPI, clk low initially, rising edge sample[m[42;126H[K[42;126H30,2[10C59%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[96m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m[42;126H[K[42;126H29,2[10C57%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HDDRB |=  [95m0x07[m;  [96m//Turn on SS, MOSI, SCLK[m[42;126H[K[42;126H28,2[10C55%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvoid[m spi_init([38;5;121mvoid[m){[42;126H[K[42;126H27,2[10C53%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H26,2[10C51%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Initalizes the SPI port on the mega128. Does no further device specific inits[m[42;126H[K[42;126H25,2[10C48%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//                            spi_init                               [m[42;126H[K[42;126H24,2[10C46%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H23,2[10C44%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H22,0-1[8C42%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121muint8_t[m i;[27C[96m//just a dumb counter[m[42;126H[K[42;126H21,2[10C40%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvolatile[m [38;5;121muint16_t[m switch_count = [95m0[m;  [96m//count switch closures[m[42;126H[K[42;126H20,2[10C38%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mchar[m lcd_str[[95m16[m];[20C[96m//holds string to send to lcd[m[42;126H[K[42;126H19,2[10C36%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H18,0-1[8C34%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//#define DEBOUNCE[m[42;126H[K[42;126H17,2[10C32%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H16,0-1[8C30%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m"lcd_functions.h"[m[42;126H[K[42;126H15,2[10C28%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<stdlib.h>[m[42;126H[K[42;126H14,2[10C26%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<string.h>[m[42;126H[K[42;126H13,2[10C24%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<util/delay.h>[m[42;126H[K[42;126H12,2[10C22%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/interrupt.h>[m[42;126H[K[42;126H11,2[10C20%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/io.h>[m[42;126H[K[42;126H10,2[10C18%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H9,2[11C16%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//R. Traylor 12.16.2013[m[42;126H[K[42;126H8,2[11C14%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H7,0-1[9C12%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Note the use of #ifdef statements[m[42;126H[K[42;126H6,2[11C10%[1;2H[?12l[?25h[?25l[42;126H7,0-1[2;1H[?12l[?25h[?25l[42;126H8,2  [3;2H[?12l[?25h[?25l[42;126H9[4;2H[?12l[?25h[?25l[42;126H10,2[5;2H[?12l[?25h[?25l[42;127H1[6;2H[?12l[?25h[?25l[42;127H2[7;2H[?12l[?25h[?25l[42;127H3[8;2H[?12l[?25h[?25l[42;127H4[9;2H[?12l[?25h[?25l[42;127H5[10;2H[?12l[?25h[?25l[42;127H6,0-1[11;1H[?12l[?25h[?25l[42;127H7,2  [12;2H[?12l[?25h[?25l[42;127H8,0-1[13;1H[?12l[?25h[?25l[42;127H9,2  [14;2H[?12l[?25h[?25l[42;126H20[15;2H[?12l[?25h[?25l[42;127H1[16;2H[?12l[?25h[?25l[42;127H2,0-1[17;1H[?12l[?25h[?25l[42;127H3,2  [18;2H[?12l[?25h[?25l[42;127H4[19;2H[?12l[?25h[?25l[42;127H5[20;2H[?12l[?25h[?25l[42;127H6[21;2H[?12l[?25h[?25l[42;127H7[22;2H[?12l[?25h[?25l[42;127H8[23;2H[?12l[?25h[?25l[42;127H9[24;2H[?12l[?25h[?25l[42;126H30[25;2H[?12l[?25h[?25l[42;127H1[26;2H[?12l[?25h[?25l[42;127H2[27;2H[?12l[?25h[?25l[42;127H3,0-1[28;1H[?12l[?25h[?25l[42;127H4,2  [29;2H[?12l[?25h[?25l[42;127H5[30;2H[?12l[?25h[?25l[42;127H6[31;2H[?12l[?25h[?25l[42;127H7[32;2H[?12l[?25h[?25l[42;127H8[33;2H[?12l[?25h[?25l[42;127H9[34;2H[?12l[?25h[?25l[42;126H40[35;2H[?12l[?25h[?25l[42;127H1[36;2H[?12l[?25h[?25l[42;127H2[37;2H[?12l[?25h[?25l[42;127H3[38;2H[?12l[?25h[?25l[42;127H4[39;2H[?12l[?25h[?25l[42;127H5[40;2H[?12l[?25h[?25l[42;127H6[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(SET):[42;126H[K[42;126H47,2[10C12%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hswitch_count++;[42;126H[K[42;126H48,2[10C14%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,2[10C16%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,2[10C18%[41;2H[?12l[?25h[?25l[42;126H49[40;2H[?12l[?25h[?25l[42;127H8[39;2H[?12l[?25h[?25l[42;127H7[38;2H[?12l[?25h[?25l[42;127H6[37;2H[?12l[?25h[?25l[42;127H5[36;2H[?12l[?25h[?25l[42;127H4[35;2H[?12l[?25h[?25l[42;127H3[34;2H[?12l[?25h[?25l[42;127H2[33;2H[?12l[?25h[?25l[42;127H1[32;2H[?12l[?25h[?25l[42;127H0[31;2H[?12l[?25h[?25l[42;126H39[30;2H[?12l[?25h[?25l[42;127H8[29;2H[?12l[?25h[?25l[42;127H7[28;2H[?12l[?25h[?25l[42;127H6[27;2H[?12l[?25h[?25l[42;127H5[26;2H[?12l[?25h[?25l[42;127H4[25;2H[?12l[?25h[?25l[42;127H3,0-1[24;1H[?12l[?25h[?25l[42;127H2,2  [23;2H[?12l[?25h[?25l[42;127H1[22;2H[?12l[?25h[?25l[42;127H0[21;2H[?12l[?25h[?25l[42;126H29[20;2H[?12l[?25h[?25l[42;127H8[19;2H[?12l[?25h[?25l[42;127H7[18;2H[?12l[?25h[?25l[42;127H6[17;2H[?12l[?25h[?25l[42;127H5[16;2H[?12l[?25h[?25l[42;127H4[15;2H[?12l[?25h[?25l[42;127H3[14;2H[?12l[?25h[?25l[42;127H2,0-1[13;1H[?12l[?25h[?25l[42;127H1,2  [12;2H[?12l[?25h[?25l[42;127H0[11;2H[?12l[?25h[?25l[42;126H19[10;2H[?12l[?25h[?25l[42;127H8,0-1[9;1H[?12l[?25h[?25l[42;127H7,2  [8;2H[?12l[?25h[?25l[42;127H6,0-1[7;1H[?12l[?25h[?25l[42;127H5,2  [6;2H[?12l[?25h[?25l[42;127H4[5;2H[?12l[?25h[?25l[42;127H3[4;2H[?12l[?25h[?25l[42;127H2[3;2H[?12l[?25h[?25l[42;127H1[2;2H[?12l[?25h[?25l[42;127H0[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H9,2[11C16%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//R. Traylor 12.16.2013[m[42;126H[K[42;126H8,2[11C14%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H7,0-1[9C12%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Note the use of #ifdef statements[m[42;126H[K[42;126H6,2[11C10%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the sampling time and note any difference.[m[42;126H[K[42;126H5,2[12C8%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Vary the buttons and see which is worst. They can vary alot.[m[42;126H[K[42;126H4,2[12C6%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H3,0-1[10C4%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//TCNT0 is used with 16mhz clock to vary the sampling period.[m[42;126H[K[42;126H2,2[12C2%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//This code shows how debouncing should and should not be done.[m[42;126H[K[42;126H1,2[11CTop[1;2H[?12l[?25h[?25l[42;126H2[2;2H[?12l[?25h[?25l[42;126H3,0-1[3;1H[?12l[?25h[?25l[42;126H4,2  [4;2H[?12l[?25h[?25l[42;126H5[5;2H[?12l[?25h[?25l[42;126H6[6;2H[?12l[?25h[?25l[42;126H7,0-1[7;1H[?12l[?25h[?25l[42;126H8,2  [8;2H[?12l[?25h[?25l[42;126H9[9;2H[?12l[?25h[?25l[42;126H10,2[10;2H[?12l[?25h[?25l[42;127H1[11;2H[?12l[?25h[?25l[42;127H2[12;2H[?12l[?25h[?25l[42;127H3[13;2H[?12l[?25h[?25l[42;127H4[14;2H[?12l[?25h[?25l[42;127H5[15;2H[?12l[?25h[?25l[42;127H6,0-1[16;1H[?12l[?25h[?25l[42;127H7,2  [17;2H[?12l[?25h[?25l[42;127H8,0-1[18;1H[?12l[?25h[?25l[42;127H9,2  [19;2H[?12l[?25h[?25l[42;126H20[20;2H[?12l[?25h[?25l[42;127H1[21;2H[?12l[?25h[?25l[42;127H2,0-1[22;1H[?12l[?25h[?25l[42;127H3,2  [23;2H[?12l[?25h[?25l[42;127H4[24;2H[?12l[?25h[?25l[42;127H5[25;2H[?12l[?25h[?25l[42;127H6[26;2H[?12l[?25h[?25l[42;127H7[27;2H[?12l[?25h[?25l[42;127H8[28;2H[?12l[?25h[?25l[42;127H9[29;2H[?12l[?25h[?25l[42;126H30[30;2H[?12l[?25h[?25l[42;127H1[31;2H[?12l[?25h[?25l[42;127H2[32;2H[?12l[?25h[?25l[42;127H3,0-1[33;1H[?12l[?25h[?25l[42;127H4,2  [34;2H[?12l[?25h[?25l[42;127H5[35;2H[?12l[?25h[?25l[42;127H6[36;2H[?12l[?25h[?25l[42;127H7[37;2H[?12l[?25h[?25l[42;127H8[38;2H[?12l[?25h[?25l[42;127H9[39;2H[?12l[?25h[?25l[42;127H8[38;2H[?12l[?25h[?25l[42;127H7[37;2H[?12l[?25h[?25l[42;127H6[36;2H[?12l[?25h[?25l[42;127H5[35;2H[?12l[?25h[?25l[42;127H4[34;2H[?12l[?25h[?25l[42;127H3,0-1[33;1H[?12l[?25h[?25l[42;127H2,2  [32;2H[?12l[?25h[?25l[42;127H1[31;2H[?12l[?25h[?25l[42;127H0[30;2H[?12l[?25h[?25l[42;126H29[29;2H[?12l[?25h[?25l[42;127H8[28;2H[?12l[?25h[?25l[42;127H7[27;2H[?12l[?25h[?25l[42;127H6[26;2H[?12l[?25h[?25l[42;127H5[25;2H[?12l[?25h[?25l[42;127H4[24;2H[?12l[?25h[?25l[42;127H3[23;2H[?12l[?25h[?25l[42;127H2,0-1[22;1H[?12l[?25h[?25l[42;127H1,2  [21;2H[?12l[?25h[?25l[42;127H0[20;2H[?12l[?25h[?25l[42;126H19[19;2H[?12l[?25h[?25l[42;127H8,0-1[18;1H[?12l[?25h[?25l[42;127H7,2  [17;2H[?12l[?25h[?25l[42;127H6,0-1[16;1H[?12l[?25h[?25l[42;127H5,2  [15;2H[?12l[?25h[?25l[42;126H[K[42;1H/[?12l[?25h/[?25l[?12l[?25h[?25l[42;2H[K[42;2H[?12l[?25h [?25l[124C15,2[10CTop[15;2H[?12l[?25h[?25l# [95m"lcd_functions.h"[m[15;20H[K]2;switch_example.c + (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c[15;2H[?12l[?25h[?25l[42;129H1[15;1H[?12l[?25h[?25l[42;127H4[14;1H[?12l[?25h[?25l[42;129H2[14;2H[?12l[?25h[?25l[42;127H5[15;2H[?12l[?25h[?25l[42;1H[1m-- INSERT --[m[42;126H[K[42;126H15,2[10CTop[15;2H[?12l[?25h[?25ln [95m"lcd_functions.h"[m[42;129H3[15;3H[?12l[?25h[?25lc [95m"lcd_functions.h"[m[42;129H4[15;4H[?12l[?25h[?25ll [95m"lcd_functions.h"[m[42;129H5[15;5H[?12l[?25h[?25lu [95m"lcd_functions.h"[m[42;129H6[15;6H[?12l[?25h[?25ld [95m"lcd_functions.h"[m[42;129H7[15;7H[?12l[?25h[?25le [95m"lcd_functions.h"[m[42;129H8[15;8H[?12l[?25h[?25l[42;129H7[15;7H[?12l[?25h[?25l[42;129H6[15;6H[?12l[?25h[?25l[42;129H5[15;5H[?12l[?25h[?25l[42;129H4[15;4H[?12l[?25h[?25l[42;129H3[15;3H[?12l[?25h[?25l[42;129H2[15;2H[?12l[?25h[?25l[38;5;81m#include [m[95m"lcd_function127H1[31;2H[?12l[?25h[?25l[42;127H0[30;2H[?12l[?25h[?25l[42;126H29[29;2H[?12l[?25h[?25l[42;127H8[28;2H[?12l[?25h[?25l[42;127H7[27;2H[?12l[?25h[?25l[42;127H6[26;2H[?12l[?25h[?25l[42;127H5[25;2H[?12l[?25h[?25l[42;127H4[24;2H[?12l[?25h[?25l[42;127H3[23;2H[?12l[?25h[?25l[42;127H2,0-1[22;1H[?12l[?25h[?25l[42;127H1,2  [21;2H[?12l[?25h[?25l[42;127H0[20;2H[?12l[?25h[?25l[42;126H19[19;2H[?12l[?25h[?25l[42;127H8,0-1[18;1H[?12l[?25h[?25l[42;127H7,2  [17;2H[?12l[?25h[?25l[42;127H6,0-1[16;1H[?12l[?25h[?25l[42;127H5,2  [15;2H[?12l[?25h[?25l[42;126H[K[42;1H/[?12l[?25h/[?25l[?12l[?25h[?25l[42;2H[K[42;2H[?12l[?25h [?25l[124C15,2[10CTop[15;2H[?12l[?25h[?25l# [95m"lcd_functions.h"[m[15;20H[K]2;switch_example.c + (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c[15;2H[?12l[?25h[?25l[42;129H1[15;1H[?12l[?25h[?25l[42;127H4[14;1H[?12l[?25h[?25l[42;129H2[14;2H[?12l[?25h[?25l[42;127H5[15;2H[?12l[?25h[?25l[42;1H[1m-- INSERT --[m[42;126H[K[42;126H15,2[10CTop[15;2H[?12l[?25h[?25ln [95m"lcd_functions.h"[m[42;129H3[15;3H[?12l[?25h[?25lc [95m"lcd_functions.h"[m[42;129H4[15;4H[?12l[?25h[?25ll [95m"lcd_functions.h"[m[42;129H5[15;5H[?12l[?25h[?25lu [95m"lcd_functions.h"[m[42;129H6[15;6H[?12l[?25h[?25ld [95m"lcd_functions.h"[m[42;129H7[15;7H[?12l[?25h[?25le [95m"lcd_functions.h"[m[42;129H8[15;8H[?12l[?25h[?25l[42;129H7[15;7H[?12l[?25h[?25l[42;129H6[15;6H[?12l[?25h[?25l[42;129H5[15;5H[?12l[?25h[?25l[42;129H4[15;4H[?12l[?25h[?25l[42;129H3[15;3H[?12l[?25h[?25l[42;129H2[15;2H[?12l[?25h[?25l[38;5;81m#include [m[95m"lcd_functions.h"[m[42;129H3[15;3H[?12l[?25h[42;1H[K[15;2H[?25l[42;126H15,2[10CTop[15;2H[?12l[?25h[?25l[42;126H[K[42;1H:[?12l[?25hw[?25l[?12l[?25h[?25l"switch_example.c" 90L, 3004C written[88C15,2[10CTop]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c[42;126H[K[42;126H15,2[10CTop[15;2H[?12l[?25h[?25l[42;1H[K[42;1H:[?12l[?25h1[?25l[?12l[?25h[?25l[42;2H[K[42;2H[?12l[?25h![?25l[?12l[?25hm[?25l[?12l[?25ha[?25l[?12l[?25hk[?25l[?12l[?25he[?25l[?12l[?25h[?25l:!make[?1l>[?12l[?25h[?1049l
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL   -c -o switch_example.o switch_example.c
avr-gcc -g -Wall -O2     -mmcu=atmega128  -DF_CPU=16000000UL -Wl,-Map,switch_example.map -o switch_example.elf switch_example.o lcd_functions.o 
avr-objdump -h -S switch_example.elf > switch_example.lst
avr-objcopy -j .text -j .data -O ihex switch_example.elf switch_example.hex
avr-objcopy -j .text -j .data -O binary switch_example.elf switch_example.bin
avr-objcopy -j .text -j .data -O srec switch_example.elf switch_example.srec
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O ihex switch_example.elf switch_example_eeprom.hex \
|| { echo empty switch_example_eeprom.hex not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O binary switch_example.elf switch_example_eeprom.bin \
|| { echo empty switch_example_eeprom.bin not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
avr-objcopy -j .eeprom --change-section-lma .eeprom=0 -O srec switch_example.elf switch_example_eeprom.srec \
|| { echo empty switch_example_eeprom.srec not generated; exit 0; }
avr-objcopy: --change-section-lma .eeprom=0x0000000000000000 never used
]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c
Press ENTER or type command to continue[?1049h[?1h=[27m[23m[m[H[2J[?25l[1;1H[96m//This code shows how debouncing should and should not be done.
//TCNT0 is used with 16mhz clock to vary the sampling period.

//Vary the buttons and see which is worst. They can vary alot.
//Vary the sampling time and note any difference.
//Note the use of #ifdef statements

//R. Traylor state;[42;126H15,2[10CTop[15;2H[?12l[?25h[?25l[42;126H[K[42;1H:[?12l[?25h![?25l[?12l[?25hm[?25l[?12l[?25ha[?25l[?12l[?25hk[?25l[?12l[?25he[?25l[?12l[?25h[?25l [?12l[?25hp[?25l[?12l[?25hr[?25l[?12l[?25ho[?25l[?12l[?25hg[?25l[?12l[?25hr[?25l[?12l[?25ha[?25l[?12l[?25hm[?25l[?12l[?25h[?25l[14C[?1l>[?12l[?25h[?1049l
avrdude -p m128 -c usbasp -e -U flash:w:switch_example.hex \
                                                     -U eeprom:w:switch_example_eeprom.hex

avrdude: warning: cannot set sck period. please check for usbasp firmware update.
avrdude: AVR device initialized and ready to accept instructions

Reading |                                                    | 0% 0.00sReading | #################                                  | 33% 0.00sReading | #################################                  | 66% 0.00sReading | ################################################## | 100% 0.00s

avrdude: Device signature = 0x1e9702 (probably m128)
avrdude: erasing chip
avrdude: warning: cannot set sck period. please check for usbasp firmware update.
avrdude: reading input file "switch_example.hex"
avrdude: input file switch_example.hex auto detected as Intel Hex
avrdude: writing flash (1252 bytes):

Writing |                                                    | 0% 0.00sWriting | ##########                                         | 20% 0.14sWriting | ####################                               | 40% 0.29sWriting | ##############################                     | 60% 0.43sWriting | ########################################           | 80% 0.57sWriting | ################################################## | 100% 0.72s

avrdude: 1252 bytes of flash written
avrdude: verifying flash memory against switch_example.hex:
avrdude: load data flash data from input file switch_example.hex:
avrdude: input file switch_example.hex auto detected as Intel Hex
avrdude: input file switch_example.hex contains 1252 bytes
avrdude: reading on-chip flash data:

Reading |                                                    | 0% 0.00sReading | ##########                                         | 20% 0.13sReading | ####################                               | 40% 0.26sReading | ##############################                     | 60% 0.39sReading | ########################################           | 80% 0.52sReading | ################################################## | 100% 0.65s

avrdude: verifying ...
avrdude: 1252 bytes of flash verified
avrdude: reading input file "switch_example_eeprom.hex"
avrdude: input file switch_example_eeprom.hex auto detected as Intel Hex
avrdude: writing eeprom (0 bytes):

Writing |                                                    | 0% 0.00sWriting | ################################################## | 100% 0.00s

avrdude: 0 bytes of eeprom written
avrdude: verifying eeprom memory against switch_example_eeprom.hex:
avrdude: load data eeprom data from input file switch_example_eeprom.hex:
avrdude: input file switch_example_eeprom.hex auto detected as Intel Hex
avrdude: input file switch_example_eeprom.hex contains 0 bytes
avrdude: reading on-chip eeprom data:

Reading |                                                    | 0% 0.00sReading | ################################################## | 100% 0.00s

avrdude: verifying ...
avrdude: 0 bytes of eeprom verified

avrdude: safemode: Fuses OK (E:FF, H:CF, L:EF)

avrdude done.  Thank you.

]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c
Press ENTER or type command to continue[?1049h[?1h=[27m[23m[m[H[2J[?25l[1;1H[96m//This code shows how debouncing should and should not be done.
//TCNT0 is used with 16mhz clock to vary the sampling period.

//Vary the buttons and see which is worst. They can vary alot.
//Vary the sampling time and note any difference.
//Note the use of #ifdef statements

//R. Traylor 12.16.2013[m

[38;5;81m#include [m[95m<avr/io.h>[m
[38;5;81m#include [m[95m<avr/interrupt.h>[m
[38;5;81m#include [m[95m<util/delay.h>[m
[38;5;81m#include [m[95m<string.h>[m
[38;5;81m#include [m[95m<stdlib.h>[m
[38;5;81m#include [m[95m"lcd_functions.h"[m

[96m//#define DEBOUNCE[m

[38;5;121mchar[m lcd_str[[95m16[m];[20C[96m//holds string to send to lcd[m
[38;5;121mvolatile[m [38;5;121muint16_t[m switch_count = [95m0[m;  [96m//count switch closures[m
[38;5;121muint8_t[m i;[27C[96m//just a dumb counter

//******************************************************************************
//                            spi_init                               
//Initalizes the SPI port on the mega128. Does no further device specific inits
//******************************************************************************[m
[38;5;121mvoid[m spi_init([38;5;121mvoid[m){
    DDRB |=  [95m0x07[m;  [96m//Turn on SS, MOSI, SCLK
[m    [96m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m
    SPCR=([95m1[m<<SPE) | ([95m1[m<<MSTR); [96m//enable SPI, clk low initially, rising edge sample[m
    SPSR=([95m1[m<<SPI2X); [96m//SPI at 2x speed (8 MHz)  [m
}[96m//spi_init[m

ISR(TIMER0_COMP_vect){
[38;5;81m#ifdef DEBOUNCE [m
  [38;5;121mstatic[m [38;5;121muint16_t[m state = [95m0[m; [96m//holds present state[m
  state = (state << [95m1[m) | (! bit_is_clear(PIND, [95m1[m)) | [95m0xE000[m;
  [93mif[m (state == [95m0xF000[m) {switch_count++;}
[38;5;81m#else[m
  [96m//uses 3 state, state machne to make pushbutton code[m
  [38;5;121mstatic[m [38;5;121menum[m button_state_type{NOTSET, SET, WAIT} button_state;[42;126H15,2[10CTop[15;2H[?12l[?25h[?25l[42;127H6,0-1[16;1H[?12l[?25h[?25l[42;127H7,2  [17;2H[?12l[?25h[?25l[42;127H8,0-1[18;1H[?12l[?25h[?25l[42;127H9,2  [19;2H[?12l[?25h[?25l[42;126H20[20;2H[?12l[?25h[?25l[42;127H1[21;2H[?12l[?25h[?25l[42;127H2,0-1[22;1H[?12l[?25h[?25l[42;127H3,2  [23;2H[?12l[?25h[?25l[42;127H4[24;2H[?12l[?25h[?25l[42;127H5[25;2H[?12l[?25h[?25l[42;127H6[26;2H[?12l[?25h[?25l[42;127H7[27;2H[?12l[?25h[?25l[42;127H8[28;2H[?12l[?25h[?25l[42;127H9[29;2H[?12l[?25h[?25l[42;126H30[30;2H[?12l[?25h[?25l[42;127H1[31;2H[?12l[?25h[?25l[42;127H2[32;2H[?12l[?25h[?25l[42;127H3,0-1[33;1H[?12l[?25h[?25l[42;127H4,2  [34;2H[?12l[?25h[?25l[42;127H5[35;2H[?12l[?25h[?25l[42;127H6[36;2H[?12l[?25h[?25l[42;127H7[37;2H[?12l[?25h[?25l[42;127H8[38;2H[?12l[?25h[?25l[42;127H9[39;2H[?12l[?25h[?25l[42;126H40[40;2H[?12l[?25h[?25l[42;127H1[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,2[11C2%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,2[11C4%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,2[11C6%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=SET;[42;126H[K[42;126H45,2[11C8%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H} [93mbreak[m;[42;126H[K[42;126H46,2[10C10%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(SET):[42;126H[K[42;126H47,2[10C12%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hswitch_count++;[42;126H[K[42;126H48,2[10C14%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,2[10C16%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,2[10C18%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(WAIT):[42;126H[K[42;126H51,2[10C20%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[42;126H[K[42;126H52,2[10C22%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=NOTSET;[42;126H[K[42;126H53,2[10C24%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H}[42;126H[K[42;126H54,2[10C26%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H55,2[10C28%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mdefault[m: [93mbreak[m;[42;126H[K[42;126H56,2[10C30%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//switch                  [m[42;126H[K[42;126H57,2[10C32%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;81m#endif[m[42;126H[K[42;126H58,2[10C34%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//ISR[m[42;126H[K[42;126H59,2[10C36%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H60,0-1[8C38%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;121mint[m main([38;5;121mvoid[m){[42;126H[K[42;126H61,2[10C40%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hspi_init();      [96m//initalize SPI [m[42;126H[K[42;126H62,2[10C42%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hlcd_init();      [96m//initalize LCD [m[42;126H[K[42;126H63,2[10C44%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hclear_display(); [96m//manually clear LCD display [m[42;126H[K[42;126H64,2[10C46%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hcursor_off();    [96m//keep LCD cursor off[m[42;126H[K[42;126H65,2[10C48%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H66,1[10C51%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[96m//TCNT0 running in CTC mode[m[42;126H[K[42;126H67,2[10C53%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m[42;126H[K[42;126H68,2[10C55%[41;2H[?12l[?25h[?25l[42;127H7[40;2H[?12l[?25h[?25l[42;127H6,1[39;1H[?12l[?25h[?25l[42;127H5,2[38;2H[?12l[?25h[?25l[42;127H4[37;2H[?12l[?25h[?25l[42;127H3[36;2H[?12l[?25h[?25l[42;127H2[35;2H[?12l[?25h[?25l[42;127H1[34;2H[?12l[?25h[?25l[42;127H0,0-1[33;1H[?12l[?25h[?25l[42;126H59,2  [32;2H[?12l[?25h[?25l[42;127H8[31;2H[?12l[?25h[?25l[42;127H7[30;2H[?12l[?25h[?25l[42;127H6[29;2H[?12l[?25h[?25l[42;127H5[28;2H[?12l[?25h[?25l[42;127H4[27;2H[?12l[?25h[?25l[42;127H3[26;2H[?12l[?25h[?25l[42;127H2[25;2H[?12l[?25h[?25l[42;127H1[24;2H[?12l[?25h[?25l[42;127H0[23;2H[?12l[?25h[?25l[42;126H49[22;2H[?12l[?25h[?25l[42;127H8[21;2H[?12l[?25h[?25l[42;127H7[20;2H[?12l[?25h[?25l[42;127H6[19;2H[?12l[?25h[?25l[42;127H5[18;2H[?12l[?25h[?25l[42;127H4[17;2H[?12l[?25h[?25l[42;127H3[16;2H[?12l[?25h[?25l[42;127H2[15;2H[?12l[?25h[?25l[42;127H1[14;2H[?12l[?25h[?25l[42;127H0[13;2H[?12l[?25h[?25l[42;126H39[12;2H[?12l[?25h[?25l[42;126H40[13;2H[?12l[?25h[?25l[42;127H1[14;2H[?12l[?25h[?25l[42;127H2[15;2H[?12l[?25h[?25l[42;127H3[16;2H[?12l[?25h[?25l[42;127H4[17;2H[?12l[?25h[?25l[42;127H5[18;2H[?12l[?25h[?25l[42;127H6[19;2H[?12l[?25h[?25l[42;127H7[20;2H[?12l[?25h[?25l[42;127H8[21;2H[?12l[?25h[?25l[42;127H9[22;2H[?12l[?25h[?25l[42;126H50[23;2H[?12l[?25h[?25l[42;127H1[24;2H[?12l[?25h[?25l[42;127H2[25;2H[?12l[?25h[?25l[42;127H3[26;2H[?12l[?25h[?25l[42;127H4[27;2H[?12l[?25h[?25l[42;127H5[28;2H[?12l[?25h[?25l[42;127H6[29;2H[?12l[?25h[?25l[42;127H7[30;2H[?12l[?25h[?25l[42;127H8[31;2H[?12l[?25h[?25l[42;127H9[32;2H[?12l[?25h[?25l[42;126H60,0-1[33;1H[?12l[?25h[?25l[42;127H1,2  [34;2H[?12l[?25h[?25l[42;127H2[35;2H[?12l[?25h[?25l[42;127H3[36;2H[?12l[?25h[?25l[42;127H4[37;2H[?12l[?25h[?25l[42;127H5[38;2H[?12l[?25h[?25l[42;127H6,1[39;1H[?12l[?25h[?25l[42;127H7,2[40;2H[?12l[?25h[?25l[42;127H8[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m[42;126H[K[42;126H69,2[10C57%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//  OCR0  |= 0x01;        //sample really, really fast [m[42;126H[K[42;126H70,2[10C59%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HOCR0  |= [95m0xFF[m;[8C[96m//compare register set at 256[m[42;126H[K[42;126H71,2[10C61%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H72,0-1[8C63%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS00);                     //no prescaling[m[42;126H[K[42;126H73,2[10C65%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32[m[42;126H[K[42;126H74,2[10C67%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m[42;126H[K[42;126H75,2[10C69%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [96m//prescale by 1024[m[42;126H[K[42;126H76,2[10C71%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H77,0-1[8C73%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//interrupt period = 62.5ns * (0CR0+1) * prescale[m[42;126H[K[42;126H78,2[10C75%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//0CR0=0xFF, prescale=1024   => period=32.7ms[m[42;126H[K[42;126H79,2[10C77%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m[42;126H[K[42;126H80,2[10C79%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H81,0-1[8C81%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hsei(); [96m//enable global interrupts[m[42;126H[K[42;126H82,2[10C83%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H83,0-1[8C85%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m[42;126H[K[42;126H84,2[10C87%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m[42;126H[K[42;126H85,2[10C89%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hitoa(switch_count, lcd_str, [95m10[m);[42;126H[K[42;126H86,2[10C91%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hstring2lcd(lcd_str);[42;126H[K[42;126H87,2[10C93%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hcursor_home();[42;126H[K[42;126H88,2[10C95%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//while[m[42;126H[K[42;126H89,2[10C97%[41;2H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//main[m[42;126H[K[42;126H90,2[10CBot[41;2H[?12l[?25h[?25l[42;126H89[40;2H[?12l[?25h[?25l[42;127H8[39;2H[?12l[?25h[?25l[42;127H7[38;2H[?12l[?25h[?25l[42;127H6[37;2H[?12l[?25h[?25l[42;127H5[36;2H[?12l[?25h[?25l[42;127H4[35;2H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H2,2  [33;2H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,2  [31;2H[?12l[?25h[?25l[42;126H79[30;2H[?12l[?25h[?25l[42;127H8[29;2H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,2  [27;2H[?12l[?25h[?25l[42;127H5[26;2H[?12l[?25h[?25l[42;127H4[25;2H[?12l[?25h[?25l[42;127H3[24;2H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,2  [22;2H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H3,2  [24;2H[?12l[?25h[?25l[42;127H4[25;2H[?12l[?25h[?25l[42;127H5[26;2H[?12l[?25h[?25l[42;127H6[27;2H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H8,2  [29;2H[?12l[?25h[?25l[42;127H9[30;2H[?12l[?25h[?25l[42;126H80[31;2H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H2,2  [33;2H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H4,2  [35;2H[?12l[?25h[?25l[42;127H5[36;2H[?12l[?25h[?25l[42;127H6[37;2H[?12l[?25h[?25l[42;127H7[38;2H[?12l[?25h[?25l[42;127H8[39;2H[?12l[?25h[?25l[42;127H9[40;2H[?12l[?25h[?25l[42;126H90[41;2H[?12l[?25h[?25l[42;126H89[40;2H[?12l[?25h[?25l[42;127H8[39;2H[?12l[?25h[?25l[42;127H7[38;2H[?12l[?25h[?25l[42;127H6[37;2H[?12l[?25h[?25l[42;127H5[36;2H[?12l[?25h[?25l[42;127H4[35;2H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H2,2  [33;2H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,2  [31;2H[?12l[?25h[?25l[42;126H79[30;2H[?12l[?25h[?25l[42;127H8[29;2H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,2  [27;2H[?12l[?25h[?25l[42;127H5[26;2H[?12l[?25h[?25l[42;127H4[25;2H[?12l[?25h[?25l[42;127H3[24;2H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,2  [22;2H[?12l[?25h[?25l[42;127H0[21;2H[?12l[?25h[?25l[42;126H69[20;2H[?12l[?25h[?25l[42;127H8[19;2H[?12l[?25h[?25l[42;127H7[18;2H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H5,2[16;2H[?12l[?25h[?25l[42;127H4[15;2H[?12l[?25h[?25l[42;127H5[16;2H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H7,2[18;2H[?12l[?25h[?25l[42;127H8[19;2H[?12l[?25h[?25l[42;127H9[20;2H[?12l[?25h[?25l[42;126H70[21;2H[?12l[?25h[?25l[42;127H1[22;2H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H3,2  [24;2H[?12l[?25h[?25l[42;127H4[25;2H[?12l[?25h[?25l[42;127H5[26;2H[?12l[?25h[?25l[42;127H6[27;2H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H8,2  [29;2H[?12l[?25h[?25l[42;127H9[30;2H[?12l[?25h[?25l[42;126H80[31;2H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H2,2  [33;2H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H4,2  [35;2H[?12l[?25h[?25l[42;127H5[36;2H[?12l[?25h[?25l[42;127H6[37;2H[?12l[?25h[?25l[42;127H7[38;2H[?12l[?25h[?25l[42;127H8[39;2H[?12l[?25h[?25l[42;127H9[40;2H[?12l[?25h[?25l[42;126H90[41;2H[?12l[?25h[?25l[42;126H89[40;2H[?12l[?25h[?25l[42;127H8[39;2H[?12l[?25h[?25l[42;127H7[38;2H[?12l[?25h[?25l[42;127H6[37;2H[?12l[?25h[?25l[42;127H5[36;2H[?12l[?25h[?25l[42;127H4[35;2H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H2,2  [33;2H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,2  [31;2H[?12l[?25h[?25l[42;126H79[30;2H[?12l[?25h[?25l[42;127H8[29;2H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,2  [27;2H[?12l[?25h[?25l[42;127H5[26;2H[?12l[?25h[?25l[42;127H4[25;2H[?12l[?25h[?25l[42;127H3[24;2H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,2  [22;2H[?12l[?25h[?25l[42;127H0[21;2H[?12l[?25h[?25l[42;126H69[20;2H[?12l[?25h[?25l[42;127H8[19;2H[?12l[?25h[?25l[42;127H7[18;2H[?12l[?25h[?25l[42;127H6,1[17;1H[?12l[?25h[?25l[42;127H5,2[16;2H[?12l[?25h[?25l[42;127H4[15;2H[?12l[?25h[?25l[42;127H3[14;2H[?12l[?25h[?25l[42;127H2[13;2H[?12l[?25h[?25l[42;127H1[12;2H[?12l[?25h[?25l[42;127H0,0-1[11;1H[?12l[?25h[?25l[42;126H59,2  [10;2H[?12l[?25h[?25l[42;127H8[9;2H[?12l[?25h[?25l[42;127H7[8;2H[?12l[?25h[?25l[42;127H6[7;2H[?12l[?25h[?25l[42;127H5[6;2H[?12l[?25h[?25l[42;127H4[5;2H[?12l[?25h[?25l[42;127H3[4;2H[?12l[?25h[?25l[42;127H2[3;2H[?12l[?25h[?25l[42;127H1[2;2H[?12l[?25h[?25l[42;127H0[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hbutton_state=WAIT;[42;126H[K[42;126H49,2[10C97%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7Hswitch_count++;[42;126H[K[42;126H48,2[10C95%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(SET):[42;126H[K[42;126H47,2[10C93%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H} [93mbreak[m;[42;126H[K[42;126H46,2[10C91%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;9Hbutton_state=SET;[42;126H[K[42;126H45,2[10C89%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;7H[93mif[m(bit_is_clear(PIND,[95m1[m)){[42;126H[K[42;126H44,2[10C87%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[93mcase[m(NOTSET):[42;126H[K[42;126H43,2[10C85%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mswitch[m(button_state){[42;126H[K[42;126H42,2[10C83%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121menum[m button_state_type{NOTSET, SET, WAIT} button_state;[42;126H[K[42;126H41,2[10C81%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[96m//uses 3 state, state machne to make pushbutton code[m[42;126H[K[42;126H40,2[10C79%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#else[m[42;126H[K[42;126H39,2[10C77%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[93mif[m (state == [95m0xF000[m) {switch_count++;}[42;126H[K[42;126H38,2[10C75%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3Hstate = (state << [95m1[m) | (! bit_is_clear(PIND, [95m1[m)) | [95m0xE000[m;[42;126H[K[42;126H37,2[10C73%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;3H[38;5;121mstatic[m [38;5;121muint16_t[m state = [95m0[m; [96m//holds present state[m[42;126H[K[42;126H36,2[10C71%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#ifdef DEBOUNCE [m[42;126H[K[42;126H35,2[10C69%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1HISR(TIMER0_COMP_vect){[42;126H[K[42;126H34,2[10C67%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H33,0-1[8C65%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H}[96m//spi_init[m[42;126H[K[42;126H32,2[10C63%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPSR=([95m1[m<<SPI2X); [96m//SPI at 2x speed (8 MHz)  [m[42;126H[K[42;126H31,2[10C61%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPCR=([95m1[m<<SPE) | ([95m1[m<<MSTR); [96m//enable SPI, clk low initially, rising edge sample[m[42;126H[K[42;126H30,2[10C59%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[96m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m[42;126H[K[42;126H29,2[10C57%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HDDRB |=  [95m0x07[m;  [96m//Turn on SS, MOSI, SCLK[m[42;126H[K[42;126H28,2[10C55%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvoid[m spi_init([38;5;121mvoid[m){[42;126H[K[42;126H27,2[10C53%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H26,2[10C51%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//Initalizes the SPI port on the mega128. Does no further device specific inits[m[42;126H[K[42;126H25,2[10C48%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//                            spi_init                               [m[42;126H[K[42;126H24,2[10C46%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//******************************************************************************[m[42;126H[K[42;126H23,2[10C44%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H22,0-1[8C42%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121muint8_t[m i;[27C[96m//just a dumb counter[m[42;126H[K[42;126H21,2[10C40%[1;2H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mvolatile[m [38;5;121muint16_t[m switch_count = [95m0[m;  [96m//count switch closures[m[42;126H[K[42;126H20,2[10C38%[1;2H[?12l[?25h[?25l[42;127H1[2;2H[?12l[?25h[?25l[42;127H2,0-1[3;1H[?12l[?25h[?25l[42;127H3,2  [4;2H[?12l[?25h[?25l[42;127H4[5;2H[?12l[?25h[?25l[42;127H5[6;2H[?12l[?25h[?25l[42;127H6[7;2H[?12l[?25h[?25l[42;127H7[8;2H[?12l[?25h[?25l[42;127H8[9;2H[?12l[?25h[?25l[42;127H9[10;2H[?12l[?25h[?25l[42;126H30[11;2H[?12l[?25h[?25l[42;127H1[12;2H[?12l[?25h[?25l[42;127H2[13;2H[?12l[?25h[?25l[42;127H3,0-1[14;1H[?12l[?25h[?25l[42;127H4,2  [15;2H[?12l[?25h[?25l[42;127H5[16;2H[?12l[?25h[?25l[42;127H6[17;2H[?12l[?25h[?25l[42;127H7[18;2H[?12l[?25h[?25l[42;127H8[19;2H[?12l[?25h[?25l[42;127H7[18;2H[?12l[?25h[?25l[42;129H3[18;3H[?12l[?25h[?25l[42;129H9[18;9H[?12l[?25h[?25l= [46m([10C)[m[42;129H11[18;11H[?12l[?25h[?25l([10C)[42;130H2[18;12H[?12l[?25h[?25l[42;130H8[18;18H[?12l[?25h[?25l[42;129H21[18;21H[?12l[?25h[?25l[18;11H[46m([10C)[m[42;130H2[18;22H[?12l[?25h[?25l[18;11H([10C)[42;130H4[18;24H[?12l[?25h[?25l| [46m([23C)[m[42;130H6[18;26H[?12l[?25h[?25l([23C)[42;130H9[18;29H[?12l[?25h[?25l[12C[46m([7C)[m[42;129H41[18;41H[?12l[?25h[?25l([7C)[42;130H2[18;42H[?12l[?25h[?25l[42;130H6[18;46H[?12l[?25h[?25l[42;130H8[18;48H[?12l[?25h[?25l[18;41H[46m([7C)[m[42;130H9[18;49H[?12l[?25h[?25l[18;41H([7C)[42;129H52[18;52H[?12l[?25h[?25l[42;130H4[18;54H[?12l[?25h[?25l[42;129H60[18;60H[?12l[?25h[?25l[42;127H8,3 [19;3H[?12l[?25h[?25l[42;129H2[19;2H[?12l[?25h[?25l[42;129H1[19;1H[?12l[?25h[?25l[42;127H7[18;1H[?12l[?25h[?25l[42;129H3[18;3H[?12l[?25h[?25l[42;129H9[18;9H[?12l[?25h[?25l= [46m([10C)[m[42;129H11[18;11H[?12l[?25h[?25l([10C)[42;130H2[18;12H[?12l[?25h[?25l[42;130H8[18;18H[?12l[?25h[?25l[42;129H21[18;21H[?12l[?25h[?25l[18;11H[46m([10C)[m[42;130H2[18;22H[?12l[?25h[?25l[18;11H([10C)[42;130H4[18;24H[?12l[?25h[?25l| [46m([23C)[m[42;130H6[18;26H[?12l[?25h[?25l([23C)[42;130H9[18;29H[?12l[?25h[?25l[12C[46m([7C)[m[42;129H41[18;41H[?12l[?25h[?25l([7C)[42;130H2[18;42H[?12l[?25h[?25l[42;130H6[18;46H[?12l[?25h[?25l[42;130H8[18;48H[?12l[?25h[?25l[18;41H[46m([7C)[m[42;130H9[18;49H[?12l[?25h[?25l[18;41H([7C)[42;129H52[18;52H[?12l[?25h[?25l[42;130H4[18;54H[?12l[?25h[?25l[42;129H60[18;60H[?12l[?25h[?25l[42;1H[1m-- INSERT --[m[42;126H[K[42;126H37,60[9C38%[18;60H[?12l[?25h[?25l[42;130H1[18;61H[?12l[?25h[?25l[42;130H2]2;switch_example.c + (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c[18;62H[?12l[?25h[?25l[42;130H3[18;63H[?12l[?25h[?25l/[42;130H4[18;64H[?12l[?25h[?25l[96m//[m[42;130H5[18;65H[?12l[?25h[?25l[96mC[m[42;130H6[18;66H[?12l[?25h[?25l[96mh[m[42;130H7[18;67H[?12l[?25h[?25l[96ma[m[42;130H8[18;68H[?12l[?25h[?25l[96mn[m[42;130H9[18;69H[?12l[?25h[?25l[96mg[m[42;129H70[18;70H[?12l[?25h[?25l[96me[m[42;130H1[18;71H[?12l[?25h[?25l[96m [m[42;130H2[18;72H[?12l[?25h[?25l[96mt[m[42;130H3[18;73H[?12l[?25h[?25l[96mh[m[42;130H4[18;74H[?12l[?25h[?25l[96me[m[42;130H5[18;75H[?12l[?25h[?25l[96m [m[42;130H6[18;76H[?12l[?25h[?25l[96mb[m[42;130H7[18;77H[?12l[?25h[?25l[96mu[m[42;130H8[18;78H[?12l[?25h[?25l[96mt[m[42;130H9[18;79H[?12l[?25h[?25l[96mt[m[42;129H80[18;80H[?12l[?25h[?25l[96mo[m[42;130H1[18;81H[?12l[?25h[?25l[96mn[m[42;130H2[18;82H[?12l[?25h[?25l[96m [m[42;130H3[18;83H[?12l[?25h[?25l[96mh[m[42;130H4[18;84H[?12l[?25h[?25l[96me[m[42;130H5[18;85H[?12l[?25h[?25l[96mr[m[42;130H6[18;86H[?12l[?25h[?25l[96me[m[42;130H7[18;87H[?12l[?25h[?25l[96m`[m[42;130H8[18;88H[?12l[?25h[42;1H[K[18;87H[?25l[42;126H37,87[9C38%[18;87H[?12l[?25h[?25l[42;1H[1m-- INSERT --[m[42;126H[K[42;126H37,87[9C38%[18;87H[?12l[?25h[?25l[18;87H[K[18;87H[?12l[?25h[42;1H[K[18;86H[?25l[42;126H37,86[9C38%[18;86H[?12l[?25h[?25l[42;126H[K[42;1H:[?12l[?25hw[?25l[?12l[?25h[?25l"switch_example.c" 90L, 3030C written[88C37,86[9C38%]2;switch_example.c (/git/ECE473/InClass/SwitchDB) - VIM]1;switch_example.c[42;126H[K[42;126H37,86[9C38%[18;86H[?12l[?25h[?25l[19;24H[46m{[15C}[m[42;127H8,40[19;40H[?12l[?25h[?25l[19;24H{[15C}[42;127H9,6 [20;6H[?12l[?25h[?25l[42;126H40,54[21;54H[?12l[?25h[?25l[42;127H1,6[22;64H[?12l[?25h[?25l[23;23H[46m{[38;3H}[m[42;127H2,23[23;23H[?12l[?25h[?25l{[38;3H}[42;127H3,18[24;18H[?12l[?25h[?25l[42;127H4,32[25;32H[?12l[?25h[?25l[42;127H5,25[26;25H[?12l[?25h[?25l[42;127H6,14[27;14H[?12l[?25h[?25l[42;127H7,15[28;15H[?12l[?25h[?25l[42;127H8,22[29;22H[?12l[?25h[?25l[42;127H9,25[30;25H[?12l[?25h[?25l[42;126H50,12[31;12H[?12l[?25h[?25l[42;127H1,16[32;16H[?12l[?25h[?25l[42;127H2,30[33;30H[?12l[?25h[?25l[42;127H3,28[34;28H[?12l[?25h[?25l[42;127H4,8 [35;8H[?12l[?25h[?25l[42;127H3,28[34;28H[?12l[?25h[?25l[42;127H2,30[33;30H[?12l[?25h[?25l[42;127H1,16[32;16H[?12l[?25h[?25l[42;127H0,12[31;12H[?12l[?25h[?25l[42;126H49,25[30;25H[?12l[?25h[?25l[42;127H8,22[29;22H[?12l[?25h[?25l[42;127H7,15[28;15H[?12l[?25h[?25l[42;127H6,14[27;14H[?12l[?25h[?25l[42;127H5,25[26;25H[?12l[?25h[?25l[42;127H4,32[25;32H[?12l[?25h[?25l[42;127H3,18[24;18H[?12l[?25h[?25l[23;23H[46m{[38;3H}[m[42;127H2,23[23;23H[?12l[?25h[?25l{[38;3H}[42;127H1,64[22;64H[?12l[?25h[?25l[42;127H0,5[21;54H[?12l[?25h[?25l[42;126H39,6 [20;6H[?12l[?25h[?25l[19;24H[46m{[15C}[m[42;127H8,40[19;40H[?12l[?25h[?25l[19;24H{[15C}[42;127H7,86[18;86H[?12l[?25h[?25l[42;127H6,50[17;50H[?12l[?25h[?25l[42;127H5,16[16;16H[?12l[?25h[?25l[15;22H[46m{[40;1H}[m[42;127H4,22[15;22H[?12l[?25h[?25l{[40;1H}[42;127H3,0-1[14;1H[?12l[?25h[?25l[42;127H2,11 [13;11H[?12l[?25h[?25l[42;127H1,48[12;48H[?12l[?25h[?25l[42;127H0,82[11;82H[?12l[?25h[?25l[42;126H29[10;82H[?12l[?25h[?25l[42;127H8,44[9;44H[?12l[?25h[?25l[8;20H[46m{[13;1H}[m[42;127H7,20[8;20H[?12l[?25h[?25l{[13;1H}[42;127H6,8[7;80H[?12l[?25h[?25l[42;127H5,79[6;79H[?12l[?25h[?25l[42;127H4,6[5;69H[?12l[?25h[?25l[42;127H3,80[4;80H[?12l[?25h[?25l[42;127H2,0-1[3;1H[?12l[?25h[?25l[42;127H1,58 [2;58H[?12l[?25h[?25l[42;127H0,60[1;60H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;121mchar[m lcd_str[[95m16[m];[20C[96m//holds string to send to lcd[m[42;1H[K[42;126H19,66[9C36%[1;66H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H18,0-1[8C34%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//#define DEBOUNCE[m[42;126H[K[42;126H17,18[9C32%[1;18H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H16,0-1[8C30%[1;1H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m"lcd_functions.h"[m[42;126H[K[42;126H15,26[9C28%[1;26H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<stdlib.h>[m[42;126H[K[42;126H14,19[9C26%[1;19H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<string.h>[m[42;126H[K[42;126H13,19[9C24%[1;19H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<util/delay.h>[m[42;126H[K[42;126H12,23[9C22%[1;23H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/interrupt.h>[m[42;126H[K[42;126H11,26[9C20%[1;26H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[38;5;81m#include [m[95m<avr/io.h>[m[42;126H[K[42;126H10,19[9C18%[1;19H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[42;126H[K[42;126H9,28[10C16%[1;28H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;1H[96m//R. Traylor 12.16.2013[m[42;126H[K[42;126H8,23[10C14%[1;23H[?12l[?25h[?25l[42;126H9,28[2;28H[?12l[?25h[?25l[42;126H10,19[3;19H[?12l[?25h[?25l[42;127H1,26[4;26H[?12l[?25h[?25l[42;127H2,23[5;23H[?12l[?25h[?25l[42;127H3,19[6;19H[?12l[?25h[?25l[42;127H4[7;19H[?12l[?25h[?25l[42;127H5,26[8;26H[?12l[?25h[?25l[42;127H6,0-1[9;1H[?12l[?25h[?25l[42;127H7,18 [10;18H[?12l[?25h[?25l[42;127H8,0-1[11;1H[?12l[?25h[?25l[42;127H9,66 [12;66H[?12l[?25h[?25l[42;126H20,60[13;60H[?12l[?25h[?25l[42;127H1,58[14;58H[?12l[?25h[?25l[42;127H2,0-1[15;1H[?12l[?25h[?25l[42;127H3,80 [16;80H[?12l[?25h[?25l[42;127H4,69[17;69H[?12l[?25h[?25l[42;127H5,7[18;79H[?12l[?25h[?25l[42;127H6,80[19;80H[?12l[?25h[?25l[20;20H[46m{[25;1H}[m[42;127H7,2[20;20H[?12l[?25h[?25l{[25;1H}[42;127H8,44[21;44H[?12l[?25h[?25l[42;127H9,82[22;82H[?12l[?25h[?25l[42;126H30[23;82H[?12l[?25h[?25l[42;127H1,48[24;48H[?12l[?25h[?25l[42;127H2,11[25;11H[?12l[?25h[?25l[42;127H3,0-1[26;1H[?12l[?25h[?25l[42;127H4,22 [27;22H[?12l[?25h[?25l[42;127H5,16[28;16H[?12l[?25h[?25l[42;127H4,22[27;22H[?12l[?25h[?25l[42;127H3,0-1[26;1H[?12l[?25h[?25l[42;127H4,22 [27;22H[?12l[?25h[?25l[42;127H5,16[28;16H[?12l[?25h[?25l[42;127H6,50[29;50H[?12l[?25h[?25l[42;127H7,86[30;86H[?12l[?25h[?25l[31;24H[46m{[15C}[m[42;127H8,40[31;40H[?12l[?25h[?25l[31;24H{[15C}[42;127H9,6 [32;6H[?12l[?25h[?25l[42;126H40,54[33;54H[?12l[?25h[?25l[42;127H1,6[34;64H[?12l[?25h[?25l[42;127H2,23[35;23H[?12l[?25h[?25l[42;127H3,18[36;18H[?12l[?25h[?25l[42;127H4,32[37;32H[?12l[?25h[?25l[42;127H5,25[38;25H[?12l[?25h[?25l[42;127H4,32[37;32H[?12l[?25h[?25l[42;127H3,18[36;18H[?12l[?25h[?25l[42;127H2,23[35;23H[?12l[?25h[?25l[42;127H1,64[34;64H[?12l[?25h[?25l[42;127H0,5[33;54H[?12l[?25h[?25l[42;126H39,6 [32;6H[?12l[?25h[?25l[31;24H[46m{[15C}[m[42;127H8,40[31;40H[?12l[?25h[?25l[31;24H{[15C}[42;127H7,86[30;86H[?12l[?25h[?25l[42;127H6,50[29;50H[?12l[?25h[?25l[42;127H5,16[28;16H[?12l[?25h[?25l[42;127H4,22[27;22H[?12l[?25h[?25l[42;127H3,0-1[26;1H[?12l[?25h[?25l[42;127H2,11 [25;11H[?12l[?25h[?25l[42;127H3,0-1[26;1H[?12l[?25h[?25l[42;127H4,22 [27;22H[?12l[?25h[?25l[42;127H5,16[28;16H[?12l[?25h[?25l[42;127H6,50[29;50H[?12l[?25h[?25l[42;127H5,16[28;16H[?12l[?25h[?25l[42;127H6,50[29;50H[?12l[?25h[?25l[42;127H7,86[30;86H[?12l[?25h[?25l[31;24H[46m{[15C}[m[42;127H8,40[31;40H[?12l[?25h[?25l[31;24H{[15C}[42;127H9,6 [32;6H[?12l[?25h[?25l[42;126H40,54[33;54H[?12l[?25h[?25l[42;127H1,6[34;64H[?12l[?25h[?25l[42;127H2,23[35;23H[?12l[?25h[?25l[42;127H3,18[36;18H[?12l[?25h[?25l[42;127H4,32[37;32H[?12l[?25h[?25l[42;127H5,25[38;25H[?12l[?25h[?25l[42;127H6,14[39;14H[?12l[?25h[?25l[42;127H7,15[40;15H[?12l[?25h[?25l[42;127H8,22[41;22H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7Hbutton_state=WAIT;[42;126H[K[42;126H49,25[9C16%[41;25H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H50,12[9C18%[41;12H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mcase[m(WAIT):[42;126H[K[42;126H51,16[9C20%[41;16H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mif[m(bit_is_set(PIND,[95m1[m)){[42;126H[K[42;126H52,30[9C22%[41;30H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;9Hbutton_state=NOTSET;[42;126H[K[42;126H53,28[9C24%[41;28H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H}[42;126H[K[42;126H54,8[10C26%[41;8H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;7H[93mbreak[m;[42;126H[K[42;126H55,12[9C28%[41;12H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mdefault[m: [93mbreak[m;[42;126H[K[42;126H56,19[9C30%[41;19H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H} [96m//switch                  [m[42;126H[K[42;126H57,30[9C32%[41;30H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;81m#endif[m[42;126H[K[42;126H58,6[10C34%[41;6H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H} [96m//ISR[m[42;126H[K[42;126H59,7[10C36%[41;7H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H60,0-1[8C38%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[38;5;121mint[m main([38;5;121mvoid[m){[42;126H[K[42;126H61,15[9C40%[41;15H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hspi_init();      [96m//initalize SPI [m[42;126H[K[42;126H62,35[9C42%[41;35H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hlcd_init();      [96m//initalize LCD [m[42;126H[K[42;126H63,35[9C44%[41;35H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hclear_display(); [96m//manually clear LCD display [m[42;126H[K[42;126H64,48[9C46%[41;48H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hcursor_off();    [96m//keep LCD cursor off[m[42;126H[K[42;126H65,40[9C48%[41;40H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H66,1[10C51%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[96m//TCNT0 running in CTC mode[m[42;126H[K[42;126H67,29[9C53%[41;29H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTIMSK |= ([95m1[m<<OCIE0);  [96m//enable interrupts[m[42;126H[K[42;126H68,43[9C55%[41;43H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<WGM01);  [96m//CTC mode, no prescale[m[42;126H[K[42;126H69,47[9C57%[41;47H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//  OCR0  |= 0x01;        //sample really, really fast [m[42;126H[K[42;126H70,55[9C59%[41;55H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HOCR0  |= [95m0xFF[m;[8C[96m//compare register set at 256[m[42;126H[K[42;126H71,53[9C61%[41;53H[?12l[?25h[?25l[42;127H0,55[40;55H[?12l[?25h[?25l[42;126H69,47[39;47H[?12l[?25h[?25l[42;127H8,43[38;43H[?12l[?25h[?25l[42;127H7,29[37;29H[?12l[?25h[?25l[42;127H6,1 [36;1H[?12l[?25h[?25l[42;127H5,40[35;40H[?12l[?25h[?25l[42;127H4,48[34;48H[?12l[?25h[?25l[42;127H3,35[33;35H[?12l[?25h[?25l[42;127H2[32;35H[?12l[?25h[?25l[42;127H1,1[31;15H[?12l[?25h[?25l[42;127H0,0-1[30;1H[?12l[?25h[?25l[42;126H59,7  [29;7H[?12l[?25h[?25l[42;127H8,6[28;6H[?12l[?25h[?25l[42;127H7,30[27;30H[?12l[?25h[?25l[42;127H6,19[26;19H[?12l[?25h[?25l[42;127H5,12[25;12H[?12l[?25h[?25l[42;127H4,8 [24;8H[?12l[?25h[?25l[42;127H3,28[23;28H[?12l[?25h[?25l[42;127H2,30[22;30H[?12l[?25h[?25l[42;127H1,16[21;16H[?12l[?25h[?25l[42;127H0,12[20;12H[?12l[?25h[?25l[42;126H49,25[19;25H[?12l[?25h[?25l[42;127H8,22[18;22H[?12l[?25h[?25l[42;127H7,15[17;15H[?12l[?25h[?25l[42;127H6,14[16;14H[?12l[?25h[?25l[42;130H3[16;13H[?12l[?25h[?25l[17;9H[46m([mSET[46m)[m[42;127H7[17;13H[?12l[?25h[?25l(SET)[42;130H2[17;12H[?12l[?25h[?25l[42;130H1[17;11H[?12l[?25h[?25l[42;130H0[17;10H[?12l[?25h[?25l[46m([mSET[46m)[m[42;129H9 [17;9H[?12l[?25h[?25l(SET)[42;129H8[17;8H[?12l[?25h[?25l[42;129H7[17;7H[?12l[?25h[?25l[42;129H6[17;6H[?12l[?25h[?25l[42;129H5[17;5H[?12l[?25h[?25l[42;129H4[17;4H[?12l[?25h[?25l[42;129H3[17;3H[?12l[?25h[?25l[42;129H2[17;2H[?12l[?25h[?25l[42;129H1[17;1H[?12l[?25h[?25l[42;127H8[18;1H[?12l[?25h[?25l[42;127H9[19;1H[?12l[?25h[?25l[42;126H50[20;1H[?12l[?25h[?25l[42;127H1[21;1H[?12l[?25h[?25l[42;127H2[22;1H[?12l[?25h[?25l[42;127H3[23;1H[?12l[?25h[?25l[42;127H4[24;1H[?12l[?25h[?25l[42;127H5[25;1H[?12l[?25h[?25l[42;127H6[26;1H[?12l[?25h[?25l[42;127H7[27;1H[?12l[?25h[?25l[42;127H8[28;1H[?12l[?25h[?25l[4;22H[46m{[29;1H}[m[42;127H9[29;1H[?12l[?25h[?25l[4;22H{[29;1H}[42;127H8[28;1H[?12l[?25h[?25l[4;22H[46m{[29;1H}[m[42;127H9[29;1H[?12l[?25h[?25l[4;22H{[29;1H}[42;127H8[28;1H[?12l[?25h[?25l[42;129H2[28;2H[?12l[?25h[?25l[42;129H3[28;3H[?12l[?25h[?25l[42;129H4[28;4H[?12l[?25h[?25l[42;129H5[28;5H[?12l[?25h[?25l[42;129H6[28;6H[?12l[?25h[?25l[42;127H7[27;6H[?12l[?25h[?25l[42;129H5[27;5H[?12l[?25h[?25l[42;127H8[28;5H[?12l[?25h[?25l[42;129H4[28;4H[?12l[?25h[?25l[42;127H9[29;4H[?12l[?25h[?25l[42;129H3[29;3H[?12l[?25h[?25l[42;129H2[29;2H[?12l[?25h[?25l[42;127H8[28;2H[?12l[?25h[?25l[42;129H1[28;1H[?12l[?25h[?25l[4;22H[46m{[29;1H}[m[42;127H9[29;1H[?12l[?25h[?25l[4;22H{[29;1H}[42;127H8[28;1H[?12l[?25h[?25l[42;127H7[27;1H[?12l[?25h[?25l[42;129H2[27;2H[?12l[?25h[?25l[42;127H6[26;2H[?12l[?25h[?25l[42;129H3[26;3H[?12l[?25h[?25l[42;129H4[26;4H[?12l[?25h[?25l[42;129H3[26;3H[?12l[?25h[?25l[12;23H[46m{[27;3H}[m[42;127H7[27;3H[?12l[?25h[?25l[12;23H{[27;3H}[42;127H8[28;3H[?12l[?25h[?25l[12;23H[46m{[27;3H}[m[42;127H7[27;3H[?12l[?25h[?25l[12;23H{[27;3H}[42;127H6[26;3H[?12l[?25h[?25l[42;127H5[25;3H[?12l[?25h[?25l[42;127H4[24;3H[?12l[?25h[?25l[42;127H3[23;3H[?12l[?25h[?25l[42;127H2[22;3H[?12l[?25h[?25l[42;127H1[21;3H[?12l[?25h[?25l[42;127H0[20;3H[?12l[?25h[?25l[42;126H49[19;3H[?12l[?25h[?25l[42;127H8[18;3H[?12l[?25h[?25l[42;127H7[17;3H[?12l[?25h[?25l[42;127H6[16;3H[?12l[?25h[?25l[42;127H5[15;3H[?12l[?25h[?25l[42;127H4[14;3H[?12l[?25h[?25l[42;127H3[13;3H[?12l[?25h[?25l[42;127H2[12;3H[?12l[?25h[?25l[42;127H1[11;3H[?12l[?25h[?25l[42;127H0[10;3H[?12l[?25h[?25l[42;126H39[9;3H[?12l[?25h[?25l[42;127H8[8;3H[?12l[?25h[?25l[42;127H7[7;3H[?12l[?25h[?25l[42;127H6[6;3H[?12l[?25h[?25l[42;127H5[5;3H[?12l[?25h[?25l[42;127H4[4;3H[?12l[?25h[?25l[42;127H3,0-1[3;1H[?12l[?25h[?25l[42;127H2,3  [2;3H[?12l[?25h[?25l[42;127H1[1;3H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5HSPCR=([95m1[m<<SPE) | ([95m1[m<<MSTR); [96m//enable SPI, clk low initially, rising edge sample[m[42;126H[K[42;126H30,3[10C59%[1;3H[?12l[?25h[?25l[1;41r[1;1H[L[1;42r[1;5H[96m//mstr mode, sck=clk/2, cycle 1/2 phase, low polarity, MSB 1st, no interrupts [m[42;126H[K[42;126H29,3[10C57%[1;3H[?12l[?25h[?25l[42;126H30[2;3H[?12l[?25h[?25l[42;127H1[3;3H[?12l[?25h[?25l[42;127H2[4;3H[?12l[?25h[?25l[42;127H3,0-1[5;1H[?12l[?25h[?25l[42;127H4,3  [6;3H[?12l[?25h[?25l[42;127H5[7;3H[?12l[?25h[?25l[42;127H6[8;3H[?12l[?25h[?25l[42;127H7[9;3H[?12l[?25h[?25l[42;127H8[10;3H[?12l[?25h[?25l[42;127H9[11;3H[?12l[?25h[?25l[42;127H8[10;3H[?12l[?25h[?25l[42;127H9[11;3H[?12l[?25h[?25l[42;126H40[12;3H[?12l[?25h[?25l[42;127H1[13;3H[?12l[?25h[?25l[42;127H2[14;3H[?12l[?25h[?25l[42;127H3[15;3H[?12l[?25h[?25l[42;127H4[16;3H[?12l[?25h[?25l[42;127H5[17;3H[?12l[?25h[?25l[42;127H6[18;3H[?12l[?25h[?25l[42;127H7[19;3H[?12l[?25h[?25l[42;127H8[20;3H[?12l[?25h[?25l[42;127H9[21;3H[?12l[?25h[?25l[42;126H50[22;3H[?12l[?25h[?25l[42;127H1[23;3H[?12l[?25h[?25l[42;127H2[24;3H[?12l[?25h[?25l[42;127H3[25;3H[?12l[?25h[?25l[42;127H4[26;3H[?12l[?25h[?25l[42;127H5[27;3H[?12l[?25h[?25l[42;127H6[28;3H[?12l[?25h[?25l[14;23H[46m{[29;3H}[m[42;127H7[29;3H[?12l[?25h[?25l[14;23H{[29;3H}[42;127H8[30;3H[?12l[?25h[?25l[42;127H9[31;3H[?12l[?25h[?25l[42;126H60,0-1[32;1H[?12l[?25h[?25l[42;127H1,3  [33;3H[?12l[?25h[?25l[42;127H2[34;3H[?12l[?25h[?25l[42;127H3[35;3H[?12l[?25h[?25l[42;127H4[36;3H[?12l[?25h[?25l[42;127H5[37;3H[?12l[?25h[?25l[42;127H6,1[38;1H[?12l[?25h[?25l[42;127H7,3[39;3H[?12l[?25h[?25l[42;127H8[40;3H[?12l[?25h[?25l[42;127H9[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//  OCR0  |= 0x01;        //sample really, really fast [m[42;126H[K[42;126H70,3[10C59%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HOCR0  |= [95m0xFF[m;[8C[96m//compare register set at 256[m[42;126H[K[42;126H71,3[10C61%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H72,0-1[8C63%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS00);                     //no prescaling[m[42;126H[K[42;126H73,3[10C65%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32[m[42;126H[K[42;126H74,3[10C67%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m[42;126H[K[42;126H75,3[10C69%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [96m//prescale by 1024[m[42;126H[K[42;126H76,3[10C71%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H77,0-1[8C73%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//interrupt period = 62.5ns * (0CR0+1) * prescale[m[42;126H[K[42;126H78,3[10C75%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//0CR0=0xFF, prescale=1024   => period=32.7ms[m[42;126H[K[42;126H79,3[10C77%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m[42;126H[K[42;126H80,3[10C79%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H81,0-1[8C81%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hsei(); [96m//enable global interrupts[m[42;126H[K[42;126H82,3[10C83%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H83,0-1[8C85%[41;1H[?12l[?25h[?25l[42;127H2,3  [40;3H[?12l[?25h[?25l[42;127H1,0-1[39;1H[?12l[?25h[?25l[42;127H41;1H
[1;42r[41;3HOCR0  |= [95m0xFF[m;[8C[96m//compare register set at 256[m[42;126H[K[42;126H71,3[10C61%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H72,0-1[8C63%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS00);                     //no prescaling[m[42;126H[K[42;126H73,3[10C65%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS01)|(1<<CS00);           //prescale by 32[m[42;126H[K[42;126H74,3[10C67%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//TCCR0 |= (1<<CS02)|(1<<CS00);           //prescale by 128[m[42;126H[K[42;126H75,3[10C69%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3HTCCR0 |= ([95m1[m<<CS02)|([95m1[m<<CS01)|([95m1[m<<CS00); [96m//prescale by 1024[m[42;126H[K[42;126H76,3[10C71%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H77,0-1[8C73%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//interrupt period = 62.5ns * (0CR0+1) * prescale[m[42;126H[K[42;126H78,3[10C75%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//0CR0=0xFF, prescale=1024   => period=32.7ms[m[42;126H[K[42;126H79,3[10C77%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;1H[96m//OCR0=0x01, prescale=none,  => 8Mhz (125ns)[m[42;126H[K[42;126H80,3[10C79%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H81,0-1[8C81%[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3Hsei(); [96m//enable global interrupts[m[42;126H[K[42;126H82,3[10C83%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[42;126H[K[42;126H83,0-1[8C85%[41;1H[?12l[?25h[?25l[42;127H2,3  [40;3H[?12l[?25h[?25l[42;127H1,0-1[39;1H[?12l[?25h[?25l[42;127H0,3  [38;3H[?12l[?25h[?25l[42;126H79[37;3H[?12l[?25h[?25l[42;127H8[36;3H[?12l[?25h[?25l[42;127H7,0-1[35;1H[?12l[?25h[?25l[42;127H6,3  [34;3H[?12l[?25h[?25l[42;127H5[33;3H[?12l[?25h[?25l[42;127H4[32;3H[?12l[?25h[?25l[42;127H3[31;3H[?12l[?25h[?25l[42;127H4[32;3H[?12l[?25h[?25l[42;127H5[33;3H[?12l[?25h[?25l[42;127H6[34;3H[?12l[?25h[?25l[42;127H7,0-1[35;1H[?12l[?25h[?25l[42;127H8,3  [36;3H[?12l[?25h[?25l[42;127H9[37;3H[?12l[?25h[?25l[42;126H80[38;3H[?12l[?25h[?25l[42;127H1,0-1[39;1H[?12l[?25h[?25l[42;127H2,3  [40;3H[?12l[?25h[?25l[42;127H3,0-1[41;1H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;3H[93mwhile[m([95m1[m){   [96m//main while loop to make LCD visible[m[42;126H[K[42;126H84,3[10C87%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5H[93mfor[m(i=[95m0[m;i<[95m5[m;i++){_delay_ms([95m2[m);} [96m//0.01 second wait[m[42;126H[K[42;126H85,3[10C89%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hitoa(switch_count, lcd_str, [95m10[m);[42;126H[K[42;126H86,3[10C91%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hstring2lcd(lcd_str);[42;126H[K[42;126H87,3[10C93%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[41;5Hcursor_home();[42;126H[K[42;126H88,3[10C95%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[36;11H[46m{[41;3H}[m [96m//while[m[42;126H[K[42;126H89,3[10C97%[41;3H[?12l[?25h[?25l[1;41r[41;1H
[1;42r[35;11H{[40;3H}
} [96m//main[m[42;126H[K[42;126H90,3[10CBot[41;3H[?12l[?25h[?25l[35;11H[46m{[40;3H}[m[42;126H89[40;3H[?12l[?25h[?25l[35;11H{[40;3H}[42;127H8[39;3H[?12l[?25h[?25l[42;127H7[38;3H[?12l[?25h[?25l[42;127H6[37;3H[?12l[?25h[?25l[42;127H5[36;3H[?12l[?25h[?25l[42;127H4[35;3H[?12l[?25h[?25l[42;127H3,0-1[34;1H[?12l[?25h[?25l[42;127H2,3  [33;3H[?12l[?25h[?25l[42;127H1,0-1[32;1H[?12l[?25h[?25l[42;127H0,3  [31;3H[?12l[?25h[?25l[42;126H79[30;3H[?12l[?25h[?25l[42;127H8[29;3H[?12l[?25h[?25l[42;127H7,0-1[28;1H[?12l[?25h[?25l[42;127H6,3  [27;3H[?12l[?25h[?25l[42;127H5[26;3H[?12l[?25h[?25l[42;127H4[25;3H[?12l[?25h[?25l[42;127H3[24;3H[?12l[?25h[?25l[42;127H2,0-1[23;1H[?12l[?25h[?25l[42;127H1,3  [22;3H[?12l[?25h[?25l[42;127H0[21;3H[?12l